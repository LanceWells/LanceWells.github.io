{"version":3,"sources":["serviceWorker.ts","FirebaseAuth/Enums/AuthState.ts","FirebaseAuth/Classes/UserDataAuth.ts","LoginPage/Enums/LoginState.ts","Utilities/Classes/DndConstants.ts","FirebaseAuth/Types/PlayerCharacterData.ts","CharacterImage/Enums/PartType.ts","CharacterImage/Classes/CharImageLayout.ts","FirebaseAuth/Classes/PlayerInventoryService.ts","FirebaseAuth/Classes/CharacterStateManager.ts","ItemData/Enums/ItemType.ts","ItemData/Enums/SourceType.ts","ItemData/Classes/Item.tsx","Shops/Enums/CarpetBorder.ts","ItemData/Enums/WeaponProperties.ts","ItemData/Classes/CardIconMap.ts","ItemData/Classes/ItemWeapon.tsx","ItemData/Classes/ItemPotion.tsx","ItemData/Classes/ItemArmor.tsx","ItemData/Classes/ItemWondrous.tsx","ItemData/Enums/DamageType.ts","ItemData/Classes/ItemSource.ts","Shops/Types/ShopKeepers.ts","Chests/Enums/ChestTypes.ts","FirebaseAuth/Classes/GameRoomService.ts","LoginPage/React/LoginPage.tsx","Routing/React/ProtectedRoute.tsx","CharacterImage/React/PartButton.tsx","CharacterImage/Enums/BodyType.ts","CharacterImage/React/PartTypeSelector.tsx","CharacterImage/React/PartBodySelector.tsx","CharacterImage/Enums/BodyDescription.ts","CharacterImage/React/PartSelector.tsx","CharacterImage/Classes/CharacterImageMap.ts","CharacterImage/React/CharacterImageCanvas.tsx","CharacterImage/Enums/CharacterSize.ts","CharacterImage/React/CharacterDrawingArea.tsx","CharacterImage/React/CharacterImage.tsx","Utilities/React/LoadingPlaceholder.tsx","Utilities/React/StylizedModal.tsx","Inventory/Classes/MoneyConverter.ts","CharacterInfo/React/MoneyDisplay.tsx","ItemData/React/RemoveButton.tsx","ItemData/React/ItemDetailsModal.tsx","ItemData/React/AttackRollModal.tsx","ItemData/React/DTwenty.tsx","ItemData/React/CardButtons/PurchaseButton.tsx","ItemData/React/CardButtons/AttuneButton.tsx","ItemData/Enums/CardInteractions.ts","ItemData/React/CardIcon.tsx","ItemData/React/CardButtons/AttackButton.tsx","ItemData/React/CardButtons/StageButton.tsx","ItemData/React/CardButtons/UnstageButton.tsx","ItemData/React/CardButtons/BagButton.tsx","ItemData/React/ItemCard.tsx","Utilities/Enums/LoadingState.ts","Inventory/React/InventoryTab.tsx","Utilities/Hooks/useLoadingState.ts","Utilities/Hooks/useCharData.ts","Inventory/React/Inventory.tsx","CharacterManager/React/CurrentCharacterStatus.tsx","CharacterManager/React/CharacterSelectionButton.tsx","CharacterManager/React/NewCharacterButton.tsx","CharacterManager/React/CharacterSelector.tsx","CharacterManager/React/NewCharacterForm.tsx","CharacterManager/React/CharacterManager.tsx","CharacterInfo/React/MoneyAdjustModal.tsx","CharacterInfo/React/AttunementCount.tsx","CharacterInfo/React/CharacterInfoDisplay.tsx","Shops/React/BazaarCarpet.tsx","Shops/React/CarpetMap.tsx","Shops/React/ItemShop.tsx","ItemData/Classes/ItemUtilityFunctions.ts","Shops/React/ShopPage.tsx","Chests/Enums/ChestState.ts","Chests/React/ChestButton.tsx","Chests/React/AddCopperSlider.tsx","Chests/React/ChestContents.tsx","Chests/React/ChestDisplay.tsx","Chests/React/ChestPage.tsx","ItemContainerManagement/React/ItemFilter.tsx","ItemContainerManagement/React/StagedItemsDisplay.tsx","ItemContainerManagement/React/ItemContainerCreator.tsx","ItemContainerManagement/React/ShopCreator.tsx","ItemContainerManagement/React/ChestCreator.tsx","Routing/React/LandingSpace.tsx","index.tsx"],"names":["Boolean","window","location","hostname","match","AuthState","LoginState","UserDataAuth","_authState","salt","_username","this","Checking","BCrypt","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","analytics","auth","onAuthStateChanged","HandleAuthStateChanged","bind","uid","currentUser","undefined","Unauthorized","signOut","email","password","loginResponse","DidLogin","Errors","setPersistence","Auth","Persistence","LOCAL","catch","error","errorMessage","message","console","push","signInWithEmailAndPassword","then","passwordDupe","createResponse","DidCreate","passwordHash","length","createUserWithEmailAndPassword","fulfilledValue","log","rejectedValue","Promise","resolve","reject","timeoutWaiting","setTimeout","user","clearTimeout","Authorized","_instance","MaxPasswordLength","DnDConstants","items","filter","i","adjustments","isAttuned","remainingAttuned","TotalAttunementSlots","GetAttunedItems","Math","max","map","GetItemAsFreshItemKey","item","key","type","magicBonus","notes","PartType","PlayerCharacterData","name","copper","charLayout","borderColor","Name","Copper","Items","CharLayout","BorderColor","itemsAsFreshKeys","GetItemsAsFreshKeys","JSON","stringify","itemJson","GetItemsFromJson","value","retVal","parsedResponse","parse","CharImageLayout","partMap","bodyType","_imageSelection","Map","_bodyType","objString","obj","imageSelection","partType","image","set","images","PartOrder","forEach","part","EnlistImageIfExists","objectToStringify","Array","from","has","get","BackAccessory","Body","Bottoms","Shoes","LowerArmor","Tops","UpperArmor","MidAccessory","ArmArmor","HandWear","Hair","FacialWear","HeadWear","Pets","Weapons","Eyes","PlayerInventoryService","characterData","GetInstance","GetUid","firestore","collection","collection_userWritable","doc","document_playerInventory","withConverter","PlayerCharacterDataConverter","reason","charDataDocument","toFirestore","update","playerName","response","playerDataRef","docSnapshot","exists","data","charCallback","snapshotListener","onSnapshot","limit","empty","docs","allCharData","charData","newCharData","charName","localStorage","setItem","storage_currentCharacter","getItem","playerCharacterData","GetItemsAsStringArray","GetJsonString","fromFirestore","snapshot","options","snapshotData","playerCopper","playerItemData","playerCharData","playerBorder","GetLayoutFromString","playerItems","GetStringArrayAsItems","ItemType","SourceType","CharacterStateManager","_observers","_currentCharListener","_currentCharacter","observer","find","obs","existingObserver","findIndex","splice","CheckForAccess","GetCurrentCharacterName","FetchCharacterData","currentChar","GetDefaultCharacter","ChangeCharacter","ListenToCharacterUpdates","SetCharacter","UpdateCharacterData","NotifyObservers","CarpetBorder","WeaponProperties","Item","title","description","details","iconSource","source","Homebrew","itemCopperCost","requiresAttunement","Wondrous","paragraphMargins","titleMargins","style","className","padding","CardIconMap","CardIconWeaponsMap","Ammunition","tooltipText","fullDetails","Finesse","Heavy","Improvised","Light","Loading","Reach","Silver","Special","Thrown","TwoHanded","Versatile","ItemWeapon","Weapon","shortRange","longRange","properties","attacks","paddingTop","GetAttackDetails","GetProperties","Blue","color","attackDetails","Object","entries","element","damageRolls","rolls","roll","damageType","toLowerCase","diceCount","diceSize","modifier","fontWeight","propertyDetails","property","json","assign","IItemIsItemWeapon","isType","ItemPotion","Consumable","hasWithdrawalEffect","GetWithdrawalEffectClause","Green","IItemIsItemPotion","ItemArmor","Armor","armorBonus","addDex","stealthDisadvantage","Red","DamageType","ItemWondrous","Purple","ShopKeepers","ChestTypes","ItemSource","itemKey","listToSearch","constructedItem","ItemMap_Weapons","ItemMap_Armor","ItemMap_Potions","ItemMap_Wondrous","currentItem","ConvertJsonToItem","keywords","masterList","matchingItems","nonEmptyKeywords","k","IsMatch","trim","concat","every","keyword","ContainsKeyword","f","converted","fromJson","IItemIsItemArmor","IItemIsItemWondrous","upperKeyword","toLocaleUpperCase","doesMatch","includes","some","p","phrase","regex","isMatch","Official","Bludgeoning","Piercing","Slashing","Poison","Acid","GameRoomService","itemStr","convertedItem","parsedObj","emptyItemKey","createdItemKey","GetItem","shop","updatedShopTab","document_itemStorage","collection_shops","ShopDataConverter","add","id","ID","shopId","chest","updatedChestTab","collection_chests","ChestDataConverter","chestId","shopData","ShopKeeper","shopKeeper","translatedShopkeeper","Indigo","translatedItems","ConvertStoredItemToItem","chestData","ChestType","CopperInChest","typeOfChest","translatedChestType","Wooden","LoginPage","props","currentUsername","currentPassword","currentPassDupe","loginState","CheckingCredentials","CheckForLogin","state","pageState","errorMessages","sauceItemKey","sauceItem","CreateChest","toString","getErrorMessages","GetInternalRenderBits","Login","LoggedIn","onLogin","setState","Username","onClick","submitLogout","CreateAnAccount","action","method","onSubmit","submitCreateAccount","onChange","handleUsernameInput","handlePasswordInput","handlePassDupeInput","display","submitBackToLogin","submitLogin","submitGoToCreateAccount","e","event","preventDefault","loginPromise","loggedIn","Logout","CreateAccount","onResolve","onReject","input","target","React","Component","ProtectedRoute","routeStatus","GetComponentToRender","granted","path","children","to","PartButton","partSelectionCallback","imageSource","alt","src","width","BodyType","PartTypeSelector","Dropdown","Toggle","Menu","GetPartTypes","values","pt","SelectionCallback","BodyDescription","PartBodySelector","GetBodyTypes","bt","PartSelector","bodyTypeSelectionCallback","partTypeSelectionCallback","GetPartButtons","partOptions","po","CharacterImageMap","charSize","CharImageMap","c","CompareParamsToStructItem","flatMap","csi","Images","structItem","validBodyDescriptors","BodyTypeMap","Size","vbt","AverageSizedFeminineDefaults","AverageSizedMasculineDefaults","ReptilianFeminineDefaults","ReptilianMasculineDefaults","AverageSizedFeminine","HumanoidFemale","HumanoidAndrogynous","Female","Androgynous","AverageSizedMasculine","HumanoidMale","Male","ReptilianFeminine","ReptilianFemale","ReptilianAndrogynous","ReptilianMasculine","ReptilianMale","CharacterShadowSource","DefaultBodyParts","CharacterImageCanvas","showOnlySpinner","showLoadingSpinner","Spinner","animation","role","visibility","height","canvasHeight","charScaleFactor","canvasWidth","ref","refs","characterEffectsCanvas","toDataURL","charStagingCanvas","characterStagingCanvas","stagingCanvasContext","getContext","charCanvas","characterCanvas","charCanvasContext","effectsCanvasContext","imageSmoothingEnabled","DrawCharacterAndBorder","LoadCharacterImages","DrawCharacterBorder","DrawCharacterWithEffects","imagesToDraw","imagesToRender","loadedImagesPromises","img","index","imageElement","Image","onload","all","clearRect","itd","drawImage","charPartOffset","canvasContext","charImgSrc","char","charImg","borderCoordinates","thicknessScale","xCoord","yCoord","globalCompositeOperation","fillStyle","fillRect","borderCanvas","effectsCanvas","shadowImgSrc","shadow","shadowImg","charBorderImgSrc","border","charBorderImg","shadowOffset","CharacterSize","CharacterDrawingArea","downloadUrl","onChangeComplete","handleColorChange","colors","outlineColorOptions","downloadCallback","fetchDownloadUrl","borderCallback","hex","charImageCanvas","GetDownloadUrl","CharacterImage","Average","charImageLayout","checkingForCharacterImage","borderStyle","CheckForCharacterImage","imgSource","charImgLayout","SetPartImage","GetCharacter","UploadCharacterData","downloadSource","link","document","createElement","download","href","click","imagePaths","GetCharacterImagePaths","charImages","GetImages","handleCanvasDownload","handleBorderSelection","handlePartSelection","handleBodyTypeChange","handlePartTypeChange","LoadingPlaceholder","placeholderSpinner","showSpinner","StylizedModal","Modal","show","onHide","centered","onEntering","onEnterModal","Header","Title","isLoading","Footer","MoneyConverter","_platinum","_gold","_silver","_copper","floor","MoneyDisplay","GetMoneyColumns","elements","moneyCount","copperCount","Platinum","hideEmptyCurrencies","Gold","RemoveButton","useState","readyToDelete","setReadyToDelete","startedDelete","setStartedToDelete","progressTimeout","setProgressTimeout","buttonText","onMouseDown","interval","onMouseUp","callbackFunction","clearInterval","onMouseLeave","content","GetProgressBar","RollType","ItemDetailsModal","showAlert","removeButton","removeCallback","itemDetails","showNotes","handleUpdatedItemNotes","noteArea","placeholder","hideModal","getSourceText","GetItemTextStyle","RenderItemDescription","DTwenty","dieFace","version","xmlns","fill","dieColor","d","AttackRollModal","damageRoll","dieFaces","rollType","Regular","isRolling","finalDieValue","roll1Audio","volume","roll20Audio","rollDieAudio","rollResultAudio","rollStopAudio","attackName","GetDiceDisplay","GetTotalRollTextDisplay","GetDamageRollDisplay","disabled","HandleRollDie","Disadvantage","Advantage","randomLimit","ceil","random","randomIndex","dieIndex","finalValue","rollTimer","extraDieRolls","GetRandomRollSequence","rollArray","numbersToShow","framesPerNumber","randomNumberCount","randomD20Numbers","nextRandomNumber","frameIndex","dieCount","GetRandomNumber","randomNumberIndex","rollFrames","PopulateRollNumbers","longestDieArray","play","rollIndex","currentRolls","indexToGet","min","FinalizeDieRoll","dieFrameLength","attack","rolledNumbers","RollAttackDice","diceValues","finalDie","slice","sort","a","b","reverse","suspenseLength","RollDamageDice","finalDieText","rollStatement","critModifier","diceRollsMessage","join","rollModifierMessage","damageMessage","Audio","PurchaseButtonOption","AttuneButtonOption","CardInteractions","CardIcon","OverlayTrigger","placement","delay","hide","overlay","Tooltip","tooltipTitle","AttackButton","attackIndicators","indicators","cardIconSize","left","StageButton","UnstageButton","PurchaseButton","CanPurchase","buttonOption","setButtonOption","useEffect","availablePlayerCopper","NotEnoughMoney","Purchased","GetButtonStyle","purchaseOption","background","AttuneButton","itemIsAttuned","Unattune","Attune","availableAttunementSlots","SlotsFull","buttonDisabled","buttonColorClass","attuneCallback","unattuneCallback","HandleButtonPress","BagButton","LoadingState","ItemCard","cardWidth","cardHeight","cardDefaultMargin","cardRatio","itemAreaDefaultOffset","itemAreaDefaultSize","titleDefaultTopOffset","titleDefaultFontSize","titleWidth","titleDefaultLeftOffset","descAreaDefaultOffset","descAreaDefaultSize","attackIconDefaultSize","iconDefaultSize","iconDefaultLeftOffset","iconDefaultTopOffset","magBonusDefualtTopOffset","magBonusDefualtLeftOffset","coinDefaultSize","coinDefaultLeftOffset","coinDefaultTopOffset","titleFontSize","buttons","cardInteractions","interaction","onAttackButton","attackButtons","Purchase","onPurchaseButton","purchaseButton","Stage","onStageButton","addButton","Unstage","onUnstageButton","unstageButton","onAttuneButton","onUnattuneButton","attuneButton","onBagButton","bagButton","icons","iconDimensions","iconTooltip","LoadCard","imagesToLoad","iconImage","resolved","SetTitleTextSize","titleText","testDiv","innerText","cardDiv","card","insertAdjacentElement","textWidth","offsetWidth","removeChild","fontSize","fontRatio","newFontSize","showCardCost","cardBonus","itemMagicBonus","margin","Button","variant","onItemClick","top","maxWidth","GetCardIcons","maxHeight","minHeight","GetCardbackSource","GetCardCost","GetCardButtons","InventoryTab","itemCards","itemClick","attackClick","attuneClick","unattuneClick","Use","Remove","useLoadingState","loadingState","setLoadingState","CheckForUserLogin","loadState","Anonymous","staticCharData","NoCharacters","Loaded","useCharData","setCharData","characterStateManager_NotifyObservers","AddObserver","RemoveObserver","Inventory","setItems","showItemDetails","setShowItemDetails","focusedItem","setFocusedItem","showAttackWindow","setShowAttackWindow","setAttackName","setAttacks","activeTab","setActiveTab","updatedItemNotes","setUpdatedItemNotes","newItems","foundItem","itemAsFreshKey","charDataFreshItems","jsonStringToCompare","itemToRemove","Tabs","activeKey","onSelect","handleItemClick","handleAttackClick","handleAttuneClick","handleUnattuneClick","itemType","filteredItems","remainingAttunements","GetRemainingAttunementSlots","sortedItems","Tab","eventKey","GetInventoryTabs","attackRolls","itemAlreadyAttuned","CurrentCharacterStatus","currentCharacterData","CharacterSelectionButton","characterSelectedCallback","NewCharacterButton","CharacterSelector","showNoCharactersMessage","allCharacterData","characterButtons","newCharacterButtonCallback","NewCharacterForm","currentNewCharName","currentBodyType","isCreating","inputIsValid","validationErrors","validateInput","inputValid","existingCharacterNames","existingName","startingCharBits","charDefaults","CreateCharacterData","onFormSubmission","formBodyOptions","creatingMessage","onHideModal","errormessage","handleCreateCharacter","handleCharNameInput","CharacterManager","allCharactersData","showNewCharForm","allCharacterNames","acn","handleHideModal","handleSubmitNewCharForm","handleNewCharButtonClick","handleCharacterSelected","SetCurrentCharacter","FetchAllCharacters","currentCharacter","characterName","MoneyAdjustModal","copperAdjustment","adjustedCopper","moneyAdjustCallback","inputAsNumber","Number","isNaN","showAsProcessing","HandleCopperSubmit","HandleCopperInput","AttunementCount","itemTitlesDisplay","CharacterInfoDisplay","showMoneyAdjustModal","setShowMoneyAdjustModal","showMoneyAdjustModalProcessing","setShowMoneyAdjustModalProcessing","newCopperTotal","BazaarCarpet","carpetMap","onPurchaseClick","rugName","borderImageSource","rugBorderSource","getShopItems","CarpetMap","borderSource","ItemShop","showItemDialog","onItemPurchase","organizedItems","carpetMaps","GroupItemsByType","keys","carpetType","GetCarpetType","getBazaarCarpets","HandleItemPurchase","onItemDialogClose","Shop","shopInfo","setShopInfo","useLocation","shopMatch","exec","pathname","GetShopByShopId","GetShop","ChestState","ChestButton","chestImage","chestState","ChestFalling","ChestReadyToOpen","ChestOpening","GetChestImage","chestCanClick","AddCopperSlider","copperToTake","setCopperToTake","handleAddCopper","availableCopper","rangeElement","valueAsNumber","ChestContents","currentCopperCount","setCurrentCopperCount","incrementingCopper","setIncrementingCopper","enableSlider","setEnableSlider","secondsToAddCopper","msToAddCopper","numberOfIncrements","copperToIncrement","ChestItemStatics","ChestItemAppearAudio","ChestCoinAudio","timeToAddMoolah","timeToEnableSlider","newCopperCount","slider","handleBagClick","itemElements","animationDelay","GetItemCards","ChestDisplay","setChestState","showDetailsModal","setShowDetailsModal","availableItems","setAvailableItems","availableCoppper","setAvailableCopper","toastText","setToastText","showToast","setShowToast","ChestDisplayStatics","FallingChestAudio","LandedChestAudio","OpeningChestAudio","ChestBagItemAudio","contents","GetChestContents","cData","availableItemsAsFreshKeys","jsonOfItemToRemove","copperToAdd","newAvailableCopper","Toast","onClose","autohide","ChestPage","chestInfo","setChestInfo","chestMatch","GetChestByChestId","GetChest","ItemFilter","handleStageItem","searchKeywords","setSearchKeywords","onInput","split","onItemStaged","SearchItems","StagedItemsDisplay","stagedItems","handleUnstageItem","onItemUnstaged","ItemContainerCreator","setStagedItems","HandleShowDetails","copyOfStagedItems","handleStagedItemsUpdated","stagedFreshItems","ShopCreator","shopTitle","setShopTitle","shopkeeper","setShopkeeper","setErrorMessage","canCreateShop","setCanCreateShop","creatingShop","setCreatingShop","shopLink","setShopLink","CreateShop","shopResponse","hostName","host","shopUrl","test","o","ChestCreator","ChestTitle","setChestTitle","setChestType","copperInChest","setCopperInChest","canCreateChest","setCanCreateChest","creatingChest","setCreatingChest","ChestLink","setChestLink","ChestData","ChestResponse","ChestUrl","LandingSpace","Navbar","expand","Brand","aria-controls","Collapse","Nav","defaultActiveKey","Link","NavDropdown","exact","HandleLoginStateChange","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.71989a4a.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export enum AuthState\r\n{\r\n    Authorized = \"Authorized\",\r\n    Unauthorized = \"Unauthorized\",\r\n    Checking = \"Checking\"\r\n}\r\n","import * as BCrypt from 'bcryptjs';\r\nimport firebase from 'firebase';\r\nimport { CreateUserResponse } from '../Types/CreateUserResponse';\r\nimport { LoginResponse } from '../Types/LoginResponse';\r\nimport { AuthState } from '../Enums/AuthState';\r\n\r\n/**\r\n * @description A class used for authorizing user credentials and fetching user data.\r\n */\r\nexport class UserDataAuth {\r\n    /**\r\n     * @description Describes the singleton instance for this class.\r\n     */\r\n    private static _instance: UserDataAuth;\r\n\r\n    /**\r\n     * @description Describes the current authorization state for user authorization.\r\n     */\r\n    private _authState: AuthState;\r\n\r\n    /**\r\n     * @description A salt used for BCrypt encryption whenever evaluating user passwords.\r\n     */\r\n    private salt: string;\r\n\r\n    /**\r\n     * @description The user's username that is being stored after authorizing user credentials.\r\n     */\r\n    private _username: string = \"\";\r\n\r\n    /**\r\n     * @description The maximum length of allowed passwords.\r\n     */\r\n    public static readonly MaxPasswordLength = 60;\r\n\r\n    /**\r\n     * @description Gets the username for the current logged-in user. This is not the name of the character,\r\n     * but instead the e-mail address associated with this user's account.\r\n     */\r\n    public get Username(): string {\r\n        return this._username;\r\n    }\r\n\r\n    /**\r\n     * @description Gets the UID for the current user. This is the user's identification number. This is used\r\n     * to index a large amount of user storage.\r\n     */\r\n    public GetUid(): string | undefined {\r\n        let uid = firebase.auth().currentUser?.uid;\r\n        if (!uid) {\r\n            uid = undefined;\r\n        }\r\n        return uid;\r\n    }\r\n\r\n    /**\r\n     * @description Logs out from any current user instances.\r\n     */\r\n    public Logout(): void {\r\n        this._authState = AuthState.Unauthorized;\r\n        firebase.auth().signOut();\r\n    }\r\n\r\n    /**\r\n     * @description Logs into a user instance using an email-password combination.\r\n     * @param email The email of the user to login.\r\n     * @param password The password of the user to login.\r\n     */\r\n    public async Login(email: string, password: string): Promise<LoginResponse> {\r\n        let loginResponse: LoginResponse = {\r\n            DidLogin: false,\r\n            Errors: []\r\n        };\r\n\r\n        await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)\r\n            .catch(function (error) {\r\n                let errorMessage = error.message;\r\n                console.error(errorMessage);\r\n                loginResponse.Errors.push(errorMessage);\r\n            });\r\n\r\n        await firebase.auth().signInWithEmailAndPassword(email, password)\r\n            .then(() =>\r\n                loginResponse.DidLogin = true\r\n            )\r\n            .catch((error) => {\r\n                let errorMessage = error.message;\r\n                console.error(errorMessage);\r\n                loginResponse.Errors.push(errorMessage);\r\n            });\r\n\r\n        return loginResponse;\r\n    }\r\n\r\n    /**\r\n     * @description Creates a new user asynchronously.\r\n     * @param email The email of the new user to create.\r\n     * @param password The password for the new user.\r\n     * @param passwordDupe A duplicate of the password that the user has provided.\r\n     */\r\n    public async CreateAccount(email: string, password: string, passwordDupe: string): Promise<CreateUserResponse> {\r\n        let createResponse: CreateUserResponse = {\r\n            DidCreate: false,\r\n            Errors: []\r\n        };\r\n\r\n        // This may be a little overkill, but don't compare plaintext passwords, use something more robust\r\n        // like BCrypt to compare.\r\n        let passwordHash: string = BCrypt.hashSync(password, this.salt);\r\n        let passwordsMatch: boolean = BCrypt.compareSync(passwordDupe, passwordHash);\r\n\r\n        // Validate that the passwords match.\r\n        if (!passwordsMatch) {\r\n            createResponse.Errors.push(\"Your passwords did not match.\");\r\n        }\r\n\r\n        if (password.length < 6) {\r\n            createResponse.Errors.push(\"Passwords must be at least 6 characters long.\");\r\n        }\r\n\r\n        if (createResponse.Errors.length <= 0) {\r\n            await firebase.auth().createUserWithEmailAndPassword(email, password).then(\r\n                fulfilledValue => {\r\n                    createResponse.DidCreate = true;\r\n                    console.log(fulfilledValue);\r\n                }\r\n                , rejectedValue => {\r\n                    console.error(rejectedValue);\r\n                    createResponse.Errors.push(rejectedValue.message);\r\n                });\r\n        }\r\n\r\n        if (!createResponse.DidCreate) {\r\n            createResponse.Errors.push(\"There was a problem when creating this account. Please try again.\");\r\n        }\r\n\r\n        return createResponse;\r\n    }\r\n\r\n    /**\r\n     * @description Checks for access being granted to the user.\r\n     */\r\n    public async CheckForAccess(): Promise<boolean> {\r\n        if (this._authState === AuthState.Checking) {\r\n            await new Promise<void>((resolve, reject) => {\r\n                // Reject the promise if we wait > X seconds before getting a response.\r\n                let timeoutWaiting = setTimeout(() => reject(), 10000);\r\n\r\n                firebase.auth().onAuthStateChanged((user) => {\r\n                    // If we got an answer, don't reject.\r\n                    window.clearTimeout(timeoutWaiting);\r\n                    resolve();\r\n                });\r\n            });\r\n        }\r\n\r\n        return this._authState === AuthState.Authorized;\r\n    }\r\n\r\n    /**\r\n     * @description Gets the singleton instance of this object.\r\n     */\r\n    public static GetInstance(): UserDataAuth {\r\n        if (!UserDataAuth._instance) {\r\n            UserDataAuth._instance = new UserDataAuth();\r\n        }\r\n\r\n        return this._instance;\r\n    }\r\n\r\n    /**\r\n     * @description Creates a new instance of this object.\r\n     */\r\n    private constructor() {\r\n        this._authState = AuthState.Checking;\r\n        this.salt = BCrypt.genSaltSync();\r\n\r\n        // Your web app's Firebase configuration\r\n        let firebaseConfig = {\r\n            apiKey: \"AIzaSyD-s5zfMiZavJc8J0qsCVIpzSysbaRG7kU\",\r\n            authDomain: \"test-project-a4c30.firebaseapp.com\",\r\n            databaseURL: \"https://test-project-a4c30.firebaseio.com\",\r\n            projectId: \"test-project-a4c30\",\r\n            storageBucket: \"test-project-a4c30.appspot.com\",\r\n            messagingSenderId: \"553146248685\",\r\n            appId: \"1:553146248685:web:b24bdb19f4a400f3550be4\",\r\n            measurementId: \"G-Y6PMKS1PHP\"\r\n        };\r\n\r\n        // Initialize Firebase\r\n        firebase.initializeApp(firebaseConfig);\r\n        firebase.analytics()\r\n\r\n        // Add a listener for auth state changing.\r\n        firebase.auth().onAuthStateChanged(this.HandleAuthStateChanged.bind(this));\r\n    }\r\n\r\n\r\n    /**\r\n     * @description Handles the user's authorization state changing.\r\n     * @param user The user that was logged in, or null if the user was logged out.\r\n     */\r\n    private HandleAuthStateChanged(user: firebase.User | null): void {\r\n        if (user) {\r\n            this._authState = AuthState.Authorized;\r\n            console.log(\"User \" + user.uid + \" has logged in.\")\r\n\r\n            let email = firebase.auth().currentUser?.email;\r\n            if (email && email !== undefined) {\r\n                this._username = email;\r\n            }\r\n        }\r\n        else {\r\n            // This means that either the auth has initialized, or that someone has logged out.\r\n            this._authState = AuthState.Unauthorized;\r\n            console.log(\"User has logged out.\")\r\n        }\r\n    }\r\n}\r\n","export enum LoginState {\r\n    CheckingCredentials = \"Checking Credentials\",\r\n    Login = \"Login\",\r\n    LoggingIn = \"Logging In\",\r\n    LoggedIn = \"Logged In\",\r\n    CreateAnAccount = \"Create An Account\"\r\n}\r\n","import { IItemKey } from \"../../ItemData/Interfaces/IItemKey\";\r\n\r\nexport class DnDConstants {\r\n    public static readonly TotalAttunementSlots: number = 3;\r\n\r\n    public static GetAttunedItems(items: IItemKey[]): IItemKey[] {\r\n        return items.filter(i => i.adjustments.isAttuned);\r\n    }\r\n\r\n    public static GetRemainingAttunementSlots(items: IItemKey[]): number {\r\n        let maxAttune: number = this.TotalAttunementSlots;\r\n\r\n        let attunedItems: IItemKey[] = DnDConstants.GetAttunedItems(items);\r\n        let attunedCount: number = attunedItems.length;\r\n        let remainingAttuned: number = maxAttune - attunedCount;\r\n\r\n        return (Math.max(remainingAttuned, 0));\r\n    }\r\n\r\n    public static GetItemsAsFreshKeys(items: IItemKey[]): IItemKey[] {\r\n        return items.map(i => DnDConstants.GetItemAsFreshItemKey(i));\r\n    }\r\n\r\n    public static GetItemAsFreshItemKey(item: IItemKey): IItemKey {\r\n        let newItemKey: IItemKey = {\r\n            key: item.key,\r\n            type: item.type,\r\n            adjustments: {\r\n                magicBonus: item.adjustments.magicBonus,\r\n                isAttuned: item.adjustments.isAttuned,\r\n                notes: item.adjustments.notes\r\n            }\r\n        }\r\n\r\n        return newItemKey;\r\n    }\r\n}\r\n","import { IItemKey } from \"../../ItemData/Interfaces/IItemKey\";\r\nimport { CharImageLayout } from '../../CharacterImage/Classes/CharImageLayout';\r\nimport { DnDConstants } from \"../../Utilities/Classes/DndConstants\";\r\n\r\nexport class PlayerCharacterData {\r\n    public Name: string;\r\n    public Copper: number;\r\n    public Items: IItemKey[];\r\n    public CharLayout: CharImageLayout;\r\n    public BorderColor: string;\r\n\r\n    public constructor(name: string, copper: number, items: IItemKey[], charLayout: CharImageLayout, borderColor: string) {\r\n        let itemsAsFreshKeys: IItemKey[] = DnDConstants.GetItemsAsFreshKeys(items);\r\n\r\n        this.Name = name;\r\n        this.Copper = copper;\r\n        this.Items = itemsAsFreshKeys;\r\n        this.CharLayout = charLayout;\r\n        this.BorderColor = borderColor;\r\n    }\r\n\r\n    public GetItemsAsStringArray(): string[] {\r\n        let itemsAsFreshKeys: IItemKey[] = DnDConstants.GetItemsAsFreshKeys(this.Items);\r\n        return itemsAsFreshKeys.map(item => JSON.stringify(item));\r\n    }\r\n\r\n    public static GetStringArrayAsItems(itemJson: string[]): IItemKey[] {\r\n        let items: IItemKey[] = itemJson\r\n            .map(PlayerCharacterData.GetItemsFromJson)\r\n            .filter(item => item !== undefined) as IItemKey[];\r\n\r\n        return items;\r\n    }\r\n\r\n    private static GetItemsFromJson(value: string): IItemKey | undefined {\r\n        let retVal: IItemKey | undefined = undefined;\r\n\r\n        try {\r\n            let parsedResponse = JSON.parse(value);\r\n            if (parsedResponse as IItemKey) {\r\n                retVal = parsedResponse;\r\n            }\r\n        }\r\n        catch {\r\n            // Just ignore this for now. Return undefined.\r\n        }\r\n\r\n        return retVal;\r\n    }\r\n}\r\n","export enum PartType\r\n{\r\n    BackAccessory = 'Back Accessory',\r\n    Body = 'Body',\r\n    Bottoms = 'Bottoms',\r\n    Shoes = 'Shoes',\r\n    LowerArmor = 'Lower Armor',\r\n    Tops = 'Tops',\r\n    UpperArmor = 'Upper Armor',\r\n    MidAccessory = 'Mid Accessory',\r\n    ArmArmor = 'Arm Armor',\r\n    HandWear = 'Hand Wear',\r\n    Hair = 'Hair',\r\n    FacialWear = 'Facial Wear',\r\n    HeadWear = 'Head Wear',\r\n    Pets = 'Pets',\r\n    Weapons = 'Weapons',\r\n    Eyes = 'Eyes'\r\n}","import { PartType } from '../Enums/PartType';\r\nimport { BodyType } from '../Enums/BodyType';\r\n\r\ntype CharImageObject = {\r\n    imageSelection: [PartType, string][],\r\n    bodyType: BodyType\r\n}\r\n\r\n/**\r\n * A structure used to gather information about a character visually, then a means to fetch that character\r\n * data as an organized list of images.\r\n */\r\nexport class CharImageLayout {\r\n    public static GetLayoutFromString(objString: string) {\r\n        let obj: CharImageObject = JSON.parse(objString) as CharImageObject;\r\n        let partMap: Map<PartType, string> = new Map(obj.imageSelection);\r\n        let charLayout: CharImageLayout = new CharImageLayout(partMap, obj.bodyType);\r\n\r\n        return charLayout;\r\n    }\r\n\r\n    /**\r\n     * @description A list of all parts that are available as options for the user to select. This also \r\n     * determines the order in which parts will be rendered, from back-to-front, read top-to-bottom.\r\n     */\r\n    public static readonly PartOrder: PartType[] = [\r\n        PartType.BackAccessory,\r\n        PartType.Body,\r\n        PartType.Bottoms,\r\n        PartType.Shoes,\r\n        PartType.LowerArmor,\r\n        PartType.Tops,\r\n        PartType.UpperArmor,\r\n        PartType.MidAccessory,\r\n        PartType.ArmArmor,\r\n        PartType.HandWear,\r\n        PartType.Hair,\r\n        PartType.FacialWear,\r\n        PartType.HeadWear,\r\n        PartType.Pets,\r\n        PartType.Weapons,\r\n        PartType.Eyes\r\n    ];\r\n\r\n    private _imageSelection: Map<PartType, string> = new Map();\r\n    private _bodyType: BodyType;\r\n\r\n    public get ImageSelection(): Map<PartType, string> {\r\n        return this._imageSelection;\r\n    }\r\n\r\n    public get BodyType(): BodyType {\r\n        return this._bodyType;\r\n    }\r\n\r\n    /**\r\n     * @description Gets a new instance of this object.\r\n     * @param partMap A map of part types to their respective strings. This may be an empty list.\r\n     */\r\n    public constructor(partMap: Map<PartType, string>, bodyType: BodyType) {\r\n        this._bodyType = bodyType;\r\n        this._imageSelection = partMap;\r\n    }\r\n\r\n    /**\r\n     * @description Sets the part type to the provided image.\r\n     * @param partType The part type to set.\r\n     * @param image The image source to set.\r\n     */\r\n    public SetPartImage(partType: PartType, image: string): void {\r\n        this._imageSelection.set(partType, image);\r\n    }\r\n\r\n    /**\r\n     * @description Resets this image's parts to an empty list.\r\n     */\r\n    public ResetImage(): void {\r\n        this._imageSelection = new Map();\r\n    }\r\n\r\n    /**\r\n     * @description Get a list of image sources, in-order.\r\n     */\r\n    public GetImages(): string[] {\r\n        let images: string[] = [];\r\n        \r\n        CharImageLayout.PartOrder.forEach(part => {\r\n            this.EnlistImageIfExists(images, part);\r\n        });\r\n\r\n        return images;\r\n    }\r\n\r\n    public GetJsonString(): string {\r\n        let images: [PartType, string][] = Array.from(this._imageSelection);\r\n        let objectToStringify: CharImageObject = {\r\n            imageSelection: images,\r\n            bodyType: this._bodyType\r\n        }\r\n\r\n        let objString: string = JSON.stringify(objectToStringify);\r\n        return objString;\r\n    }\r\n\r\n    /**\r\n     * @description Adds the specified image by-part-type to the array if it exists in the @see ImageSelection\r\n     * map.\r\n     * @param images An output list of images, passed by-reference. This should be empty when first called.\r\n     * @param partType The type of part to check-for and add to the list if it does.\r\n     */\r\n    private EnlistImageIfExists(images: string[], partType: PartType) {\r\n        if (this._imageSelection.has(partType)) {\r\n            let image: string\r\n            image = this._imageSelection.get(partType) as string;\r\n            images.push(image);\r\n        }\r\n    }\r\n}\r\n","import { UserDataAuth } from './UserDataAuth';\r\nimport { firestore } from 'firebase';\r\nimport { PlayerCharacterData } from '../Types/PlayerCharacterData';\r\nimport { IItemKey } from '../../ItemData/Interfaces/IItemKey';\r\nimport { CharImageLayout } from '../../CharacterImage/Classes/CharImageLayout';\r\nimport { CharacterUpdateCallback } from '../Types/CharacterUpdateCallback';\r\nimport { SnapshotListener } from '../Types/SnapshotListener';\r\n\r\nexport class PlayerInventoryService {\r\n    private static readonly collection_userWritable: string = \"userWritable\";\r\n    private static readonly document_playerInventory: string = \"playerInventory\";\r\n    private static readonly storage_currentCharacter: string = \"currentCharacter\";\r\n\r\n    private static PlayerCharacterDataConverter: firestore.FirestoreDataConverter<PlayerCharacterData> = {\r\n        toFirestore: (playerCharacterData: PlayerCharacterData): firestore.DocumentData => {\r\n            // https://stackoverflow.com/questions/29085197/how-do-you-json-stringify-an-es6-map\r\n\r\n            // let images: [PartType, string][] = Array.from(playerCharacterData.Images.entries());\r\n            // let imagesStr: string = JSON.stringify(images);\r\n\r\n            return {\r\n                name: playerCharacterData.Name,\r\n                copper: playerCharacterData.Copper,\r\n                items: playerCharacterData.GetItemsAsStringArray(),\r\n                charData: playerCharacterData.CharLayout.GetJsonString(),\r\n                borderColor: playerCharacterData.BorderColor\r\n            }\r\n        },\r\n        fromFirestore: (snapshot, options): PlayerCharacterData => {\r\n            let snapshotData = snapshot.data(options);\r\n\r\n            let playerName: string = snapshotData.name;\r\n            let playerCopper: number = snapshotData.copper;\r\n            let playerItemData: string[] = snapshotData.items;\r\n            let playerCharData: string = snapshotData.charData;\r\n            let playerBorder: string = snapshotData.borderColor;\r\n\r\n            let charData: CharImageLayout = CharImageLayout.GetLayoutFromString(playerCharData);\r\n            let playerItems: IItemKey[] = PlayerCharacterData.GetStringArrayAsItems(playerItemData);\r\n\r\n            let playerData: PlayerCharacterData = new PlayerCharacterData(\r\n                playerName,\r\n                playerCopper,\r\n                playerItems,\r\n                charData,\r\n                playerBorder);\r\n\r\n            return playerData;\r\n        }\r\n    }\r\n\r\n    public static async CreateCharacterData(characterData: PlayerCharacterData): Promise<void> {\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n        console.log(\"FIREBASE: Creating character data.\");\r\n\r\n        if (uid !== undefined) {\r\n            await firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid)\r\n                .doc(characterData.Name)\r\n                .withConverter(PlayerInventoryService.PlayerCharacterDataConverter)\r\n                .set(characterData)\r\n                .catch(reason => {\r\n                    console.error(reason);\r\n                });\r\n        }\r\n    }\r\n\r\n    public static async UpdateCharacterData(characterData: PlayerCharacterData): Promise<void> {\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n        console.log(\"FIREBASE: Updating character data.\");\r\n\r\n        // I'm not certain why, but the 'withConverter' option doesn't appear to work the same for .update as\r\n        // it does for .set. Just use the converter in a brute-force method instead since this seems to work.\r\n        let charDataDocument = PlayerInventoryService.PlayerCharacterDataConverter.toFirestore(characterData);\r\n        \r\n        if (uid !== undefined) {\r\n            await firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid)\r\n                .doc(characterData.Name)\r\n                .update(charDataDocument)\r\n                .catch(reason => {\r\n                    console.error(reason);\r\n                });\r\n        }\r\n    }\r\n\r\n    public static async FetchCharacterData(playerName: string): Promise<PlayerCharacterData | undefined> {\r\n        let response: PlayerCharacterData | undefined = undefined;\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n        console.log(\"FIREBASE: Fetching character data.\");\r\n\r\n        if (uid !== undefined) {\r\n            let playerDataRef = firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid)\r\n                .doc(playerName);\r\n\r\n            await playerDataRef\r\n                .withConverter(PlayerInventoryService.PlayerCharacterDataConverter)\r\n                .get()\r\n                .then(docSnapshot => {\r\n                    if (docSnapshot.exists) {\r\n                        response = docSnapshot.data();\r\n                    }\r\n                    else {\r\n                        console.error(`Could not find character document for ${playerName}.`);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error(error);\r\n                });\r\n        }\r\n\r\n        return response;\r\n    }\r\n\r\n    public static ListenToCharacterUpdates(playerName: string, charCallback: CharacterUpdateCallback): SnapshotListener | undefined {\r\n        let snapshotListener: SnapshotListener | undefined = undefined;\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n\r\n        if (uid !== undefined) {\r\n            let playerDataRef = firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid)\r\n                .doc(playerName);\r\n\r\n            snapshotListener = playerDataRef\r\n                .withConverter(PlayerInventoryService.PlayerCharacterDataConverter)\r\n                .onSnapshot(docSnapshot => {\r\n                    if (docSnapshot.exists) {\r\n                        charCallback(docSnapshot.data());\r\n                        console.log(\"FIREBASE: Listened character data.\");\r\n                    }\r\n                    else {\r\n                        console.error(`Could not find character document for ${playerName}.`);\r\n                    }\r\n                });\r\n        }\r\n\r\n        return snapshotListener;\r\n    }\r\n\r\n    public static async GetDefaultCharacter(): Promise<PlayerCharacterData | undefined> {\r\n        let response: PlayerCharacterData | undefined = undefined;\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n        console.log(\"FIREBASE: Default character data.\");\r\n\r\n        if (uid !== undefined) {\r\n            let playerDataRef = firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid)\r\n                .limit(1);\r\n\r\n            await playerDataRef\r\n                .withConverter(PlayerInventoryService.PlayerCharacterDataConverter)\r\n                .get()\r\n                .then(docSnapshot => {\r\n                    if (!docSnapshot.empty) {\r\n                        response = docSnapshot.docs[0].data();\r\n                    }\r\n                    else {\r\n                        console.error(`Could not find a default character.`);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error(error);\r\n                });\r\n        }\r\n\r\n        return response;\r\n    }\r\n\r\n    public static async FetchAllCharacters(): Promise<PlayerCharacterData[]> {\r\n        let uid: string | undefined = UserDataAuth.GetInstance().GetUid();\r\n        let allCharData: PlayerCharacterData[] = [];\r\n        console.log(\"FIREBASE: Fetch all characters.\");\r\n\r\n        if (uid !== undefined) {\r\n            let playerDataRef = firestore()\r\n                .collection(this.collection_userWritable)\r\n                .doc(this.document_playerInventory)\r\n                .collection(uid);\r\n\r\n            await playerDataRef\r\n                .withConverter(PlayerInventoryService.PlayerCharacterDataConverter)\r\n                .get()\r\n                .then(docSnapshot => {\r\n                    // Calling .data() doesn't cost anything extra in terms of database reads, so go ahead and\r\n                    // get the list of characters as the full objects regardless.\r\n                    docSnapshot.forEach(charData => {\r\n                        let newCharData = charData.data();\r\n                        allCharData.push(newCharData);\r\n                    });\r\n                })\r\n                .catch(reason => {\r\n                    console.error(reason);\r\n                });\r\n        }\r\n\r\n        return allCharData;\r\n    }\r\n\r\n    public static SetCurrentCharacter(charName: string) {\r\n        localStorage.setItem(PlayerInventoryService.storage_currentCharacter, charName);\r\n    }\r\n\r\n    public static GetCurrentCharacterName(): string | null {\r\n        return localStorage.getItem(PlayerInventoryService.storage_currentCharacter);\r\n    }\r\n}\r\n","import { PlayerInventoryService } from './PlayerInventoryService';\r\nimport { PlayerCharacterData } from '../Types/PlayerCharacterData';\r\nimport { UserDataAuth } from './UserDataAuth';\r\nimport { SnapshotListener } from '../Types/SnapshotListener';\r\n\r\nexport type CharacterStateObserver = (charData: PlayerCharacterData | undefined) => void;\r\n\r\nexport class CharacterStateManager {\r\n    private _observers: CharacterStateObserver[] = [];\r\n    private _currentCharListener: SnapshotListener | undefined;\r\n    private static _instance: CharacterStateManager;\r\n    private _currentCharacter: PlayerCharacterData | undefined = undefined;\r\n\r\n    /**\r\n     * Gets the static instance of this class.\r\n     */\r\n    public static GetInstance() {\r\n        if (!this._instance) {\r\n            this._instance = new CharacterStateManager();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    /**\r\n     * Adds the provided observer. This observer will be notified every time that the current character data\r\n     * receives an update.\r\n     * @param observer The observer to add.\r\n     */\r\n    public AddObserver(observer: CharacterStateObserver) {\r\n        let existingObserver: CharacterStateObserver | undefined = this._observers.find(obs => obs === observer);\r\n\r\n        if (existingObserver === undefined) {\r\n            this._observers.push(observer);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the provided observer. This observier will no longer receive updates.\r\n     * @param observer The observer to remove.\r\n     */\r\n    public RemoveObserver(observer: CharacterStateObserver) {\r\n        let existingObserver: number | undefined = this._observers.findIndex(obs => obs === observer);\r\n        \r\n        if (existingObserver === undefined) {\r\n            this._observers.splice(existingObserver, 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the 'current' character. This will be any loaded characters or, in lieu of any loaded characters,\r\n     * the last-loaded character. The last loaded character is stored in local storage and fetched from the\r\n     * player inventory service. If there is no stored player, this attempts to grab the first character that\r\n     * the user created.\r\n     */\r\n    public async GetCharacter(): Promise<PlayerCharacterData | undefined> {\r\n        let accessGranted: boolean = await UserDataAuth.GetInstance().CheckForAccess();\r\n\r\n        if (accessGranted) {\r\n            // First, verify that the current character has been loaded. If it hasn't, load up the first\r\n            // applicable character.\r\n            if (this._currentCharacter === undefined) {\r\n                let playerName: string | null = PlayerInventoryService.GetCurrentCharacterName();\r\n                let currentChar: PlayerCharacterData | undefined;\r\n\r\n                // If we have a player name in local storage, try loading that first.\r\n                if (playerName) {\r\n                    currentChar = await PlayerInventoryService.FetchCharacterData(playerName);\r\n                }\r\n                else {\r\n                    currentChar = await PlayerInventoryService.GetDefaultCharacter();\r\n                }\r\n\r\n                this.ChangeCharacter(currentChar);\r\n            }\r\n        }\r\n\r\n        return this._currentCharacter;\r\n    }\r\n\r\n    /**\r\n     * Changes the loaded character data to the provided character data, and begins to listen for changes on\r\n     * this specific character. Note that this does not modify the stored character data, that should be\r\n     * done via UploadCharacterData.\r\n     * @param charData The character data to change to.\r\n     */\r\n    public async ChangeCharacter(charData: PlayerCharacterData | undefined) {\r\n        if (this._currentCharListener !== undefined) {\r\n            this._currentCharListener();\r\n        }\r\n\r\n        if (charData !== undefined) {\r\n            this._currentCharListener = PlayerInventoryService.ListenToCharacterUpdates(charData.Name, this.SetCharacter.bind(this));\r\n        }\r\n\r\n        this.SetCharacter(charData);\r\n    }\r\n\r\n    /**\r\n     * Called to modify the stored character data on the remote. Note that this does not change the active\r\n     * character, it only uploads character data. Changing the character must be performed via \r\n     * ChangeCharacter.\r\n     * @param charData The character data to upload to the server. note that the character that is changed is\r\n     * the character under the \"Name\" property of charData. Also note that this will not create a character,\r\n     * it will only update an existing one.\r\n     */\r\n    public async UploadCharacterData(charData: PlayerCharacterData) {\r\n        let accessGranted: boolean = await UserDataAuth.GetInstance().CheckForAccess();\r\n\r\n        if (accessGranted) {\r\n            await PlayerInventoryService.UpdateCharacterData(charData);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called in order to notify any listeners that the current character has changed. This can mean changes\r\n     * to the data for a character, or changes to the character's information.\r\n     */\r\n    private NotifyObservers(): void {\r\n        this._observers.forEach(obs => obs(this._currentCharacter))\r\n    }\r\n\r\n    /**\r\n     * Called in order to update the local static object that tracks the character's state. This\r\n     * should only be modified internally in this class, as it does not establish the necessary listeners for\r\n     * changes to this state.\r\n     * @param charData The character data to set for the local, static object.\r\n     */\r\n    private SetCharacter(charData: PlayerCharacterData | undefined) {\r\n        this._currentCharacter = charData;\r\n        this.NotifyObservers();\r\n    }\r\n\r\n    /**\r\n     * Creates a new instance of this object. Note that this is private to ensure a singleton schema.\r\n     */\r\n    private constructor() {\r\n        this._currentCharListener = undefined;\r\n    }\r\n}\r\n","export enum ItemType {\r\n    Weapon = \"Weapons\",\r\n    Armor = \"Armor\",\r\n    Consumable = \"Consumables\",\r\n    Wondrous = \"Wondrous Items\"\r\n}\r\n","export enum SourceType {\r\n    Official = \"Official\",\r\n    Homebrew = \"Homebrew\"\r\n}\r\n","import React from 'react';\r\nimport { IItem } from '../Interfaces/IItem';\r\nimport { IItemJson } from '../Interfaces/IItemJson';\r\nimport { SourceType } from '../Enums/SourceType';\r\nimport { ItemType } from '../Enums/ItemType';\r\nimport { CarpetBorder } from '../../Shops/Enums/CarpetBorder';\r\nimport { ItemAdjustments } from '../Types/ItemAdjustments';\r\n\r\nexport abstract class Item implements IItem {\r\n    public RenderItemDescription(): JSX.Element {\r\n        return (\r\n            <div>\r\n                <div\r\n                    style={{\r\n                    }}>\r\n                    <h5 className=\"item-description-title\">Details</h5>\r\n                    <p style={{\r\n                        padding: `${this.paragraphMargins}`\r\n                    }}>\r\n                        {this.description} {this.details}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public GetEqualityString(): string {\r\n        return (JSON.stringify(this as IItemJson));\r\n    }\r\n\r\n    public abstract GetCarpetType(): CarpetBorder;\r\n    public abstract GetItemTextStyle(): React.CSSProperties;\r\n\r\n    public GetCardbackSource(): string { return \"./images/Item_Shop/ItemCards/CardDungeon.png\"; };\r\n\r\n    \r\n    key: string = \"\";\r\n    title: string = \"\";\r\n    description: string = \"\";\r\n    details: string = \"\";\r\n    iconSource: string = \"\";\r\n    source: SourceType = SourceType.Homebrew;\r\n    itemCopperCost: number = 0;\r\n    requiresAttunement: boolean = false;\r\n    type: ItemType = ItemType.Wondrous;\r\n    adjustments: ItemAdjustments = { magicBonus: 0, isAttuned: false, notes: \"\" };\r\n\r\n\r\n    protected readonly paragraphMargins: string = \"0 15px 0 15px\";\r\n    protected readonly titleMargins: string = \"15px 0 0 0\";\r\n}\r\n","export enum CarpetBorder {\r\n    Purple = \"url(/images/Item_Shop/Items/Rugs/purplerug.png)\",\r\n    Green = \"url(/images/Item_Shop/Items/Rugs/greenrug.png)\",\r\n    Blue = \"url(/images/Item_Shop/Items/Rugs/bluerug.png)\",\r\n    Red = \"url(/images/Item_Shop/Items/Rugs/redrug.png)\"\r\n}\r\n","export enum WeaponProperties {\r\n    Ammunition = \"Ammunition\",\r\n    Finesse = \"Finesse\",\r\n    Heavy = \"Heavy\",\r\n    Improvised = \"Improvised\",\r\n    Light = \"Light\",\r\n    Loading = \"Loading\",\r\n    Reach = \"Reach\",\r\n    Silver = \"Silver\",\r\n    Special = \"Special\",\r\n    Thrown = \"Thrown\",\r\n    TwoHanded = \"Two-Handed\",\r\n    Versatile = \"Versatile\"\r\n}\r\n","import { IconTooltip } from \"../Types/IconTooltip\";\r\nimport { WeaponProperties } from \"../Enums/WeaponProperties\";\r\n\r\nexport class CardIconMap {\r\n    public static CardIconWeaponsMap: Map<WeaponProperties, IconTooltip> = new Map<WeaponProperties, IconTooltip>(\r\n        [\r\n            [\r\n                WeaponProperties.Ammunition,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Ammunition.png\",\r\n                    tooltipText: \"This item uses ammunition for ranged attacks.\",\r\n                    fullDetails: \"You can use a weapon that has the ammunition property to make a ranged attack only if you have ammunition to fire from the weapon. Each time you attack with the weapon, you expend one piece of ammunition. Drawing the ammunition from a quiver, case, or other container is part of the attack (you need a free hand to load a one-handed weapon). At the end of the battle, you can recover half your expended ammunition by taking a minute to search the battlefield. If you use a weapon that has the ammunition property to make a melee attack, you treat the weapon as an improvised weapon. A sling must be loaded to deal any damage when used in this way.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Finesse,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Finesse.png\",\r\n                    tooltipText: \"This item requires finesse. Attacks and damage with this item may use STR or DEX.\",\r\n                    fullDetails: \"When making an attack with a finesse weapon, you use your choice of your Strength or Dexterity modifier for the attack and damage rolls. You must use the same modifier for both rolls.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Heavy,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Heavy.png\",\r\n                    tooltipText: \"This item is abnormally heavy. Small creatures will have a difficult time using this item.\",\r\n                    fullDetails: \"Small creatures have disadvantage on attack rolls with heavy weapons. A heavy weapon's size and bulk make it too large for a Small creature to use effectively.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Improvised,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Improvised.png\",\r\n                    tooltipText: \"This is an improvised weapon.\",\r\n                    fullDetails: \"At the DM's option, a character proficient with a weapon can use a similar object as if it were that weapon and use his or her proficiency bonus. An object that bears no resemblance to a weapon deals 1d4 damage (the DM assigns a damage type appropriate for the object).\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Light,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Light.png\",\r\n                    tooltipText: \"This item is unusually light and may be used with another weapon.\",\r\n                    fullDetails: \"A light weapon is small and easy to handle, making it ideal for use when fighting with two weapons.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Loading,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Loading.png\",\r\n                    tooltipText: \"This item requires manually loading and is limited to one attack per action.\",\r\n                    fullDetails: \"Because of the time required to load this weapon, you can fire only one piece of ammunition from it when you use an action, bonus action, or reaction to fire it, regardless of the number of attacks you can normally make.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Reach,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Reach.png\",\r\n                    tooltipText: \"This item has extended reach.\",\r\n                    fullDetails: \"This weapon adds 5 feet to your reach when you attack with it, as well as when determining your reach for opportunity attacks with it.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Silver,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Silver.png\",\r\n                    tooltipText: \"This item has been plated in silver.\",\r\n                    fullDetails: \"Some monsters that have immunity or resistance to nonmagical weapons are susceptible to silver weapons.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Special,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Special.png\",\r\n                    tooltipText: \"This item has some special usage. Refer to the card details for more information.\",\r\n                    fullDetails: \"A weapon with the special property has unusual rules governing its use, explained in the weapon's description.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Thrown,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Thrown.png\",\r\n                    tooltipText: \"This item may be thrown without reducing its damage.\",\r\n                    fullDetails: \"If a weapon has the thrown property, you can throw the weapon to make a ranged attack. If the weapon is a melee weapon, you use the same ability modifier for that attack roll and damage roll that you would use for a melee attack with the weapon. For example, if you throw a handaxe, you use your Strength, but if you throw a dagger, you can either use your Strength or your Dexterity since the dagger has the finesse property.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.TwoHanded,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/TwoHanded.png\",\r\n                    tooltipText: \"This item is unwieldy and requires two hands to utilize.\",\r\n                    fullDetails: \"This weapon requires two hands when you attack with it.\"\r\n                }\r\n            ],\r\n            [\r\n                WeaponProperties.Versatile,\r\n                {\r\n                    iconSource: \"./images/Item_Shop/ItemCards/Icons/Versatile.png\",\r\n                    tooltipText: \"This item is versatile and may be used with one or two hands.\",\r\n                    fullDetails: \"This weapon can be used with one or two hands. A damage value in parentheses appears with the property-the damage when the weapon is used with two hands to make a melee attack.\"\r\n                }\r\n            ],\r\n        ]\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { IItemJson } from '../Interfaces/IItemJson';\r\nimport { SourceType } from \"../Enums/SourceType\";\r\nimport { ItemType } from \"../Enums/ItemType\";\r\nimport { WeaponProperties } from \"../Enums/WeaponProperties\";\r\nimport { Item } from './Item';\r\nimport { Attack } from './Attack';\r\nimport { CarpetBorder } from '../../Shops/Enums/CarpetBorder';\r\nimport { CardIconMap } from './CardIconMap';\r\nimport { ItemAdjustments } from '../Types/ItemAdjustments';\r\n\r\nexport interface IItemWeaponJson extends IItemJson {\r\n    shortRange: number;\r\n    longRange: number;\r\n    properties: WeaponProperties[];\r\n\r\n    /**\r\n     * @description The mapping here is 1 attack to a series of dice rolls that represent that attack.\r\n     * The idea is that multiple damage types necessitate different rolls or modifiers. Each attack is\r\n     * indexed by a unique name.\r\n     */\r\n    attacks: { [index: string]: Attack[] };\r\n}\r\n\r\nexport class ItemWeapon extends Item implements IItemWeaponJson {\r\n    public readonly key: string = \"\";\r\n    public title: string = \"\";\r\n    public description: string = \"\";\r\n    public details: string = \"\";\r\n    public iconSource: string = \"\";\r\n    public source: SourceType = SourceType.Homebrew;\r\n    public itemCopperCost: number = 0;\r\n    public requiresAttunement: boolean = false;\r\n    public readonly type: ItemType = ItemType.Weapon;\r\n    public adjustments: ItemAdjustments = { magicBonus: 0, isAttuned: false, notes: \"\" };\r\n    \r\n    public shortRange: number = 20;\r\n    public longRange: number = 60;\r\n    public properties: WeaponProperties[] = [];\r\n    \r\n    /**\r\n     * @description The mapping here is 1 attack to a series of dice rolls that represent that attack.\r\n     * The idea is that multiple damage types necessitate different rolls or modifiers. Each attack is\r\n     * indexed by a unique name.\r\n     */\r\n    public attacks: { [index: string]: Attack[] } = {};\r\n\r\n    public constructor() {\r\n        super();\r\n    }\r\n\r\n    // http://choly.ca/post/typescript-json/\r\n    static fromJson(json: IItemWeaponJson): ItemWeapon {\r\n        let item = new ItemWeapon();\r\n        return Object.assign(item, json, {\r\n        });\r\n    }\r\n\r\n    RenderItemDescription(): JSX.Element {\r\n        return (\r\n            <div>\r\n                <div\r\n                    style={{\r\n                    }}>\r\n                    <h5 className=\"item-description-title\">Details</h5>\r\n                    <p style ={{\r\n                        padding: `${this.paragraphMargins}`\r\n                    }}>\r\n                        {this.description} {this.details}\r\n                    </p>\r\n                </div>\r\n                <div\r\n                    style={{\r\n                        paddingTop: `${this.titleMargins}`\r\n                    }}>\r\n                    <h5 className=\"item-description-title\">Attacks</h5>\r\n                    <p style={{\r\n                        padding: this.paragraphMargins\r\n                    }}>\r\n                        {this.GetAttackDetails()}\r\n                    </p>\r\n                </div>\r\n                <div\r\n                    style={{\r\n                        paddingTop: `${this.titleMargins}`\r\n                    }}>\r\n                    <h5 className=\"item-description-title\">Properties</h5>\r\n                    <p style={{\r\n                        padding: this.paragraphMargins\r\n                    }}>\r\n                        {this.GetProperties()}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    public GetCarpetType(): CarpetBorder { return CarpetBorder.Blue }\r\n    public GetItemTextStyle(): React.CSSProperties { return { color: 'rgb(199, 207, 221)' } };\r\n    public GetCardbackSource(): string { return \"./images/Item_Shop/ItemCards/CardForge.png\"; };\r\n\r\n    private GetAttackDetails(): JSX.Element {\r\n        let attackDetails: JSX.Element[] = Object.entries(this.attacks).map(element => {\r\n            let name: string = element[0];\r\n            let damageRolls: Attack[] = element[1];\r\n            let rolls: JSX.Element[] = [];\r\n            \r\n            damageRolls.forEach(roll => {\r\n                if (rolls.length > 0) {\r\n                    rolls.push(\r\n                        <span> and </span>\r\n                    );\r\n                }\r\n                rolls.push (\r\n                    <span className={`text-color-${roll.damageType.toLowerCase()}`}>\r\n                        <span>{`${roll.diceCount}d${roll.diceSize}${roll.modifier > 0 ? `+${roll.modifier}` : ''}`}</span>\r\n                        <span> {roll.damageType} damage</span>\r\n                    </span>\r\n                );\r\n            });\r\n\r\n            return (\r\n                <p>\r\n                    <span style={{ fontWeight: \"bolder\" }}>{name}: </span>{rolls}\r\n                </p>\r\n            );\r\n        })\r\n\r\n        return (\r\n            <div>\r\n                {attackDetails}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private GetProperties(): JSX.Element {\r\n        let propertyDetails: JSX.Element[] = this.properties.map(property => {\r\n            return (\r\n                <p>\r\n                    <h6>{property}</h6>\r\n                    {CardIconMap.CardIconWeaponsMap.get(property)?.fullDetails ?? \"\"}\r\n                </p>\r\n            );\r\n        });\r\n\r\n        return (\r\n            <div>\r\n                {propertyDetails}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport function IItemIsItemWeapon(item: IItemJson): item is ItemWeapon {\r\n    let isType: boolean = true;\r\n\r\n    isType = isType && (item as ItemWeapon).type === ItemType.Weapon;\r\n    isType = isType && (item as ItemWeapon).attacks !== undefined;\r\n\r\n    return isType;\r\n}\r\n","import React from 'react';\r\nimport { IItemJson } from '../Interfaces/IItemJson';\r\nimport { Item } from './Item';\r\nimport { SourceType } from \"../Enums/SourceType\";\r\nimport { ItemType } from \"../Enums/ItemType\";\r\nimport { CarpetBorder } from '../../Shops/Enums/CarpetBorder';\r\nimport { ItemAdjustments } from '../Types/ItemAdjustments';\r\n\r\nexport interface IItemPotionJson extends IItemJson {\r\n    hasWithdrawalEffect: boolean;\r\n}\r\n\r\nexport class ItemPotion extends Item implements IItemPotionJson {\r\n    public readonly key: string = \"\";\r\n    public title: string = \"\";\r\n    public description: string = \"\";\r\n    public details: string = \"\";\r\n    public iconSource: string = \"\";\r\n    public source: SourceType = SourceType.Homebrew;\r\n    public itemCopperCost: number = 0;\r\n    public requiresAttunement: boolean = false;\r\n    public readonly type: ItemType = ItemType.Consumable;\r\n    public adjustments: ItemAdjustments = { magicBonus: 0, isAttuned: false, notes: \"\" };\r\n\r\n    public hasWithdrawalEffect: boolean = false;\r\n    \r\n    static fromJson(json: IItemPotionJson): ItemPotion {\r\n        let item = new ItemPotion();\r\n        return Object.assign(item, json, {\r\n        });\r\n    }\r\n\r\n    RenderItemDescription(): JSX.Element {\r\n        return (\r\n            <div>\r\n                <div\r\n                    style={{\r\n                    }}>\r\n                    <h5 className=\"item-description-title\">Details</h5>\r\n                    <p style={{\r\n                        padding: `${this.paragraphMargins}`\r\n                    }}>\r\n                        {this.description} {this.details} {this.GetWithdrawalEffectClause()}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    GetWithdrawalEffectClause(): JSX.Element {\r\n        let clause: JSX.Element;\r\n        if (this.hasWithdrawalEffect) {\r\n            clause = (\r\n                <span>\r\n                    <span>Using this potion will result in a </span>\r\n                    <span className=\"text-color-withdrawal\">withdrawal effect</span>\r\n                    <span>.</span>\r\n                </span>\r\n            )\r\n        }\r\n        else {\r\n            clause = (\r\n                <span></span>\r\n            )\r\n        }\r\n\r\n        return clause;\r\n    }\r\n\r\n    public GetCarpetType(): CarpetBorder { return CarpetBorder.Green }\r\n    public GetItemTextStyle(): React.CSSProperties { return { color: 'rgb(253, 210, 237)' } };\r\n    public GetCardbackSource(): string { return \"./images/Item_Shop/ItemCards/CardAlchemist.png\"; };\r\n}\r\n\r\nexport function IItemIsItemPotion(item: IItemJson): item is ItemPotion {\r\n    let isType: boolean = true;\r\n\r\n    isType = isType && (item as ItemPotion).type === ItemType.Consumable;\r\n\r\n    return isType;\r\n}\r\n","import { IItemJson } from '../Interfaces/IItemJson';\r\nimport { Item } from './Item';\r\nimport { SourceType } from \"../Enums/SourceType\";\r\nimport { ItemType } from \"../Enums/ItemType\";\r\nimport { CarpetBorder } from '../../Shops/Enums/CarpetBorder';\r\nimport { ItemAdjustments } from '../Types/ItemAdjustments';\r\n\r\nexport interface IItemArmorJson extends IItemJson {\r\n    armorBonus: number;\r\n    addDex: boolean;\r\n    stealthDisadvantage: boolean;\r\n}\r\n\r\nexport class ItemArmor extends Item implements IItemArmorJson {\r\n    public readonly key: string = \"\";\r\n    public title: string = \"\";\r\n    public description: string = \"\";\r\n    public details: string = \"\";\r\n    public iconSource: string = \"\";\r\n    public source: SourceType = SourceType.Homebrew;\r\n    public itemCopperCost: number = 0;\r\n    public requiresAttunement: boolean = false;\r\n    public readonly type: ItemType = ItemType.Armor;\r\n    public adjustments: ItemAdjustments = { magicBonus: 0, isAttuned: false, notes: \"\" };\r\n\r\n    public armorBonus: number = 0;\r\n    public addDex: boolean = true;\r\n    public stealthDisadvantage: boolean = false;\r\n\r\n    static fromJson(json: IItemArmorJson): ItemArmor {\r\n        let item = new ItemArmor();\r\n        return Object.assign(item, json, {\r\n        });\r\n    }\r\n\r\n    public GetCarpetType(): CarpetBorder { return CarpetBorder.Red }\r\n    public GetItemTextStyle(): React.CSSProperties { return { color: 'rgb(148, 253, 255)' } };\r\n}\r\n\r\nexport function IItemIsItemArmor(item: IItemJson) : item is ItemArmor {\r\n    let isType: boolean = true;\r\n\r\n    isType = isType && (item as ItemArmor).type === ItemType.Armor;\r\n    isType = isType && (item as ItemArmor).addDex !== undefined;\r\n    isType = isType && (item as ItemArmor).stealthDisadvantage !== undefined;\r\n\r\n    return isType;\r\n}\r\n","import { IItemJson } from '../Interfaces/IItemJson';\r\nimport { Item } from './Item';\r\nimport { SourceType } from \"../Enums/SourceType\";\r\nimport { ItemType } from \"../Enums/ItemType\";\r\nimport { CarpetBorder } from '../../Shops/Enums/CarpetBorder';\r\nimport { ItemAdjustments } from '../Types/ItemAdjustments';\r\n\r\nexport interface IItemWondrousJson extends IItemJson {\r\n}\r\n\r\nexport class ItemWondrous extends Item implements IItemWondrousJson {\r\n    public readonly key: string = \"\";\r\n    public title: string = \"\";\r\n    public description: string = \"\";\r\n    public details: string = \"\";\r\n    public iconSource: string = \"\";\r\n    public source: SourceType = SourceType.Homebrew;\r\n    public itemCopperCost: number = 0;\r\n    public requiresAttunement: boolean = false;\r\n    public readonly type: ItemType = ItemType.Wondrous;\r\n    public adjustments: ItemAdjustments = { magicBonus: 0, isAttuned: false, notes: \"\" };\r\n\r\n    static fromJson(json: IItemWondrousJson): ItemWondrous {\r\n        let item = new ItemWondrous();\r\n        return Object.assign(item, json, {\r\n        });\r\n    }\r\n\r\n    public GetCarpetType(): CarpetBorder { return CarpetBorder.Purple }\r\n    public GetItemTextStyle(): React.CSSProperties { return { color: 'rgb(255, 235, 87)' } };\r\n}\r\n\r\nexport function IItemIsItemWondrous(item: IItemJson): item is ItemWondrous {\r\n    let isType: boolean = true;\r\n\r\n    isType = isType && (item as ItemWondrous).type === ItemType.Wondrous;\r\n\r\n    return isType;\r\n}\r\n","export enum DamageType {\r\n  Acid = \"Acid\",\r\n  Bludgeoning = \"Bludgeoning\",\r\n  Cold = \"Cold\",\r\n  Fire = \"Fire\",\r\n  Force = \"Force\",\r\n  Lightning = \"Lightning\",\r\n  Necrotic = \"Necrotic\",\r\n  Piercing = \"Piercing\",\r\n  Poison = \"Poison\",\r\n  Psychic = \"Psychic\",\r\n  Radiant = \"Radiant\",\r\n  Slashing = \"Slashing\",\r\n  Thunder = \"Thunder\"\r\n}\r\n","import { ItemWeapon, IItemWeaponJson, IItemIsItemWeapon } from \"./ItemWeapon\";\r\nimport { ItemPotion, IItemPotionJson, IItemIsItemPotion } from './ItemPotion';\r\nimport { ItemArmor, IItemArmorJson, IItemIsItemArmor } from './ItemArmor';\r\nimport { ItemWondrous, IItemWondrousJson, IItemIsItemWondrous } from './ItemWondrous';\r\nimport { ItemType } from \"../Enums/ItemType\";\r\nimport { IItem } from \"../Interfaces/IItem\";\r\nimport { IItemJson } from \"../Interfaces/IItemJson\";\r\nimport { SourceType } from \"../Enums/SourceType\";\r\nimport { WeaponProperties } from \"../Enums/WeaponProperties\";\r\nimport { DamageType } from \"../Enums/DamageType\";\r\nimport { IItemKey } from \"../Interfaces/IItemKey\";\r\n\r\n/**\r\n * @description A class used to fetch items based on a specific index and call.\r\n * \r\n * In future, recall that this link explains how to self-initialize:\r\n * https://basarat.gitbooks.io/typescript/docs/tips/staticConstructor.html\r\n */\r\nexport class ItemSource {\r\n    /**\r\n     * @description Finds the item under the specified index, and returns that item. If the item cannot be\r\n     * found, returns undefined instead. This function returns undefined such that a caller can determine how\r\n     * to handle the missing element, rather than throw an exception.\r\n     * @param index The index to search for the item.\r\n     * @param type The type of item to search for.\r\n     */\r\n    public static GetItem(itemKey: IItemKey): IItem | undefined {\r\n        let item: IItemJson | undefined = undefined;\r\n        let listToSearch: IItemJson[] | undefined = undefined;\r\n        let constructedItem: IItem | undefined = undefined;\r\n\r\n        switch (itemKey.type) {\r\n            case ItemType.Weapon:\r\n                listToSearch = ItemMap_Weapons;\r\n                break;\r\n            case ItemType.Armor:\r\n                listToSearch = ItemMap_Armor;\r\n                break;\r\n            case ItemType.Consumable:\r\n                listToSearch = ItemMap_Potions;\r\n                break;\r\n            case ItemType.Wondrous:\r\n                listToSearch = ItemMap_Wondrous;\r\n                break;\r\n            default:\r\n                listToSearch = undefined;\r\n                break;\r\n        }\r\n        \r\n        if (listToSearch !== undefined) {\r\n            for (let i = 0; i < listToSearch.length; i++) {\r\n                let currentItem = listToSearch[i];\r\n                if (currentItem.key === itemKey.key) {\r\n                    item = currentItem;\r\n\r\n                    if (itemKey.adjustments) {\r\n                        item.adjustments = itemKey.adjustments\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (item !== undefined) {\r\n            constructedItem = this.ConvertJsonToItem(item);\r\n        }\r\n\r\n        return constructedItem;\r\n    }\r\n\r\n    /**\r\n     * Searches the list of all available items for those that match a set of specific keywords. Enables\r\n     * search functionality through all known items.\r\n     * @param keywords The list of keywords to compare against all items.\r\n     */\r\n    public static SearchItems(keywords: string[]): IItem[] {\r\n        let masterList: IItemJson[] = [];\r\n        let matchingItems: IItem[] = [];\r\n\r\n        // Filter out all empty keywords.\r\n        let nonEmptyKeywords: string[] = keywords.filter(k => !this.IsMatch(k, /\\s+/) && k.length > 0);\r\n\r\n        // Trim off the whitespace for any keyword.\r\n        nonEmptyKeywords = nonEmptyKeywords.map(k => k.trim());\r\n\r\n        masterList = masterList.concat(ItemMap_Armor);\r\n        masterList = masterList.concat(ItemMap_Potions);\r\n        masterList = masterList.concat(ItemMap_Weapons);\r\n        masterList = masterList.concat(ItemMap_Wondrous);\r\n\r\n        let filteredItems = masterList.filter(item => nonEmptyKeywords.every(keyword => this.ContainsKeyword(keyword, item)))\r\n\r\n        // Verify that the item isn't already in the matching items list.\r\n        filteredItems.forEach(f => {\r\n            // Convert the item first. We need this to access the equality string.\r\n            let converted = this.ConvertJsonToItem(f);\r\n\r\n            // If the item can be converted, and the list of existing items does not already include this\r\n            // item, then add it.\r\n            if (converted) {\r\n                matchingItems.push(converted);\r\n            }\r\n        });\r\n\r\n        // // If the list of keywords that was provided was empty, just return everything.\r\n        // if (nonEmptyKeywords.length <= 0) {\r\n        //     masterList.forEach(m => {\r\n        //         let converted = this.ConvertJsonToItem(m);\r\n        //         if (converted !== undefined) {\r\n        //             matchingItems.push(converted);\r\n        //         }\r\n        //     })\r\n        // }\r\n\r\n        return matchingItems;\r\n    }\r\n\r\n    /**\r\n     * Converts a json-able item into an item.\r\n     * @param item The json item to be converted to an item.\r\n     */\r\n    private static ConvertJsonToItem(item: IItemJson): IItem | undefined {\r\n        let constructedItem: IItem | undefined = undefined;\r\n\r\n        if (IItemIsItemWeapon(item)) {\r\n            constructedItem = ItemWeapon.fromJson(item)\r\n        }\r\n        else if (IItemIsItemArmor(item)) {\r\n            constructedItem = ItemArmor.fromJson(item);\r\n        }\r\n        else if (IItemIsItemPotion(item)) {\r\n            constructedItem = ItemPotion.fromJson(item);\r\n        }\r\n        else if (IItemIsItemWondrous(item)) {\r\n            constructedItem = ItemWondrous.fromJson(item);\r\n        }\r\n\r\n        return constructedItem;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the keyword is contained in the specified item.\r\n     * @param keyword The keyword to evaluate. \r\n     * @param item The item to evaluate.\r\n     */\r\n    private static ContainsKeyword(keyword: string, item: IItemJson): boolean {\r\n        let upperKeyword = keyword.toLocaleUpperCase();\r\n        let doesMatch: boolean = false;\r\n        \r\n        doesMatch = doesMatch || item.key.toLocaleUpperCase().includes(upperKeyword);\r\n        doesMatch = doesMatch || item.type.toLocaleUpperCase().includes(upperKeyword);\r\n        doesMatch = doesMatch || item.title.toLocaleUpperCase().includes(upperKeyword);\r\n        doesMatch = doesMatch || item.description.toLocaleUpperCase().includes(upperKeyword);\r\n        doesMatch = doesMatch || item.details.toLocaleUpperCase().includes(upperKeyword);\r\n        \r\n        doesMatch = doesMatch || (upperKeyword.includes(\"ATTUNEMENT\".toLocaleUpperCase()) && item.requiresAttunement);\r\n\r\n        if (IItemIsItemWeapon(item)) {\r\n            doesMatch = doesMatch || item.properties.some(p => p.toLocaleUpperCase().includes(upperKeyword))\r\n        }\r\n\r\n        return doesMatch;\r\n    }\r\n\r\n    /**\r\n     * Returns true if the provided regex matches the provided keyword.\r\n     * @param phrase The keyword to match against.\r\n     * @param regex The regular expression to compare against.\r\n     */\r\n    private static IsMatch(phrase: string, regex: RegExp): boolean {\r\n        let isMatch: boolean = false;\r\n\r\n        let match: RegExpMatchArray | null = phrase.match(regex);\r\n        isMatch = isMatch || (match != null && match.length > 0);\r\n\r\n        return isMatch;\r\n    }\r\n}\r\n\r\n/**\r\n * The purpose of the following classes and constants is to act as a proxy for a server. This will likely all\r\n * go away if/when this software switches to use AWS or something similar.\r\n */\r\nconst ItemMap_Weapons: IItemWeaponJson[] =\r\n[\r\n    {\r\n        key: 'Club',\r\n        title: 'Club',\r\n        description: 'A stout bludgeoning weapon made of oak.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/club.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Light\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Whack\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        },\r\n    },\r\n    {\r\n        key: 'Dagger',\r\n        title: 'Dagger',\r\n        description: 'A small piercing weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/dagger.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Light,\r\n            WeaponProperties.Finesse,\r\n            WeaponProperties.Thrown\r\n        ],\r\n        itemCopperCost: 200,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Stab\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Greatclub',\r\n        title: 'Greatclub',\r\n        description: 'A massive bludgeoning weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/greatclub.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.TwoHanded\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Smash\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Handaxe',\r\n        title: 'Handaxe',\r\n        description: 'A small throwing axe.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/handaxe.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Light,\r\n            WeaponProperties.Thrown\r\n        ],\r\n        itemCopperCost: 500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Hack\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Javelin',\r\n        title: 'Javelin',\r\n        description: 'A long, pointed, throwing weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/javelin.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 30,\r\n        longRange: 120,\r\n        properties: [\r\n            WeaponProperties.Thrown\r\n        ],\r\n        itemCopperCost: 500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Poke\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'LightHammer',\r\n        title: 'Light Hammer',\r\n        description: 'A small bludgeoning weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/light_hammer.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Light,\r\n            WeaponProperties.Thrown\r\n        ],\r\n        itemCopperCost: 200,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Smack\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Mace',\r\n        title: 'Mace',\r\n        description: 'A bludgeoning weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/mace.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n        ],\r\n        itemCopperCost: 500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Smash\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Quarterstaff',\r\n        title: 'Quarterstaff',\r\n        description: 'A long, bludgeoning weapon made of oak.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/quarterstaff.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Versatile\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Whap (1h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ],\r\n            \"Whap (2h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Sickle',\r\n        title: 'Sickle',\r\n        description: 'A curved weapon made of steel.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/sickle.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Light\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Slash\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Spear',\r\n        title: 'Spear',\r\n        description: 'A long, pointed weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/spear.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Thrown,\r\n            WeaponProperties.Versatile\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Stab (1h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ],\r\n            \"Stab (2h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Shortsword',\r\n        title: 'Shortsword',\r\n        description: 'A short, pointed weapon.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/shortsword.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Finesse,\r\n            WeaponProperties.Light\r\n        ],\r\n        itemCopperCost: 1000,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Stab\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'SnakeStaff',\r\n        title: 'Snake Staff',\r\n        description: 'The staff is wrapped by the likeness of a clay snake.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/Cleric Staff Snake Green.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.TwoHanded\r\n        ],\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Curse\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    },\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Poison\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Darts',\r\n        title: 'Darts',\r\n        description: 'A small thrown weapon. 20 darts line a leather pouch.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/dart.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Finesse,\r\n            WeaponProperties.Thrown\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Throw\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'LightCrossbow',\r\n        title: 'Light Crossbow',\r\n        description: 'A light, mechanical device used for firing arrows across large distances.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/light_crossbow.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 80,\r\n        longRange: 230,\r\n        properties: [\r\n            WeaponProperties.Ammunition,\r\n            WeaponProperties.Loading,\r\n            WeaponProperties.TwoHanded\r\n        ],\r\n        itemCopperCost: 2500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Fire\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Shortbow',\r\n        title: 'Shortbow',\r\n        description: 'A long, curved piece of wood held taut by a length of wire.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/shortbow.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 80,\r\n        longRange: 230,\r\n        properties: [\r\n            WeaponProperties.Ammunition,\r\n            WeaponProperties.TwoHanded\r\n        ],\r\n        itemCopperCost: 2500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Fire\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 6,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Piercing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Sling',\r\n        title: 'Sling',\r\n        description: 'A small pocket held by two lengths of rope. When spun quickly, it can hurl projectiles at lethal speed.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/sling.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 30,\r\n        longRange: 120,\r\n        properties: [\r\n            WeaponProperties.Ammunition\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Throw\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Bludgeoning\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Battleaxe',\r\n        title: 'Battleaxe',\r\n        description: 'A large, double-bladed axe.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/battleaxe.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Versatile\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Slash (1h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ],\r\n            \"Slash (2h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 10,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Glaive',\r\n        title: 'Glaive',\r\n        description: 'A long polearm with a menacing length of steel at one end.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/glaive.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Heavy,\r\n            WeaponProperties.Reach,\r\n            WeaponProperties.TwoHanded\r\n        ],\r\n        itemCopperCost: 100,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Slash\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 10,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        }\r\n    },\r\n    {\r\n        key: 'Longsword',\r\n        title: 'Longsword',\r\n        description: 'A long . . . sword.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/longsword.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Versatile\r\n        ],\r\n        itemCopperCost: 1500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Slash (1h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ],\r\n            \"Slash (2h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 10,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        },\r\n    },\r\n    {\r\n        key: 'BrutalLongsword',\r\n        title: 'Brutal Longsword',\r\n        description: 'A viciously long . . . sword.',\r\n        details: '',\r\n        iconSource: './images/Item_Shop/Items/Weapons/longsword.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Versatile\r\n        ],\r\n        itemCopperCost: 1500,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Slash (1h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 8,\r\n                        modifier: 1,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ],\r\n            \"Slash (2h)\":\r\n                [\r\n                    {\r\n                        diceCount: 1,\r\n                        diceSize: 10,\r\n                        modifier: 1,\r\n                        damageType: DamageType.Slashing\r\n                    }\r\n                ]\r\n        },\r\n    },\r\n    {\r\n        key: 'EdwardSteakSauce',\r\n        title: \"Edward's Steak Sauce\",\r\n        description: 'A magic-infused all-in-one steak sauce.',\r\n        details: \"The Edwards Steak Sauce company boasts a successful yet mysterious history. The brain child of one Edward Felm, the all-in-one steak sauce proved itself a massive hit on adventurer shelves across the continent. Its lethally acidic mixture simultaneously cooks, purifies, and tenderizes meat in efficient fashion. When applied to any object (or creature), the sauce deals 2d4 acid damage. Any impacted objects (or creatures) are instantly flavoured with Edward's 11 exotic herb & spice mixture. Impacted objects (or creatures) may be safely consumed after application, for up to 12 hours. If attuned to this bottle, the vial refills magically after a long rest.\",\r\n        iconSource: './images/Item_Shop/Items/Potions/SteakSauce.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        shortRange: 20,\r\n        longRange: 60,\r\n        properties: [\r\n            WeaponProperties.Finesse\r\n        ],\r\n        itemCopperCost: 1000,\r\n        type: ItemType.Weapon,\r\n        attacks: {\r\n            \"Bonk\": [\r\n                {\r\n                    diceCount: 1,\r\n                    diceSize: 4,\r\n                    modifier: 0,\r\n                    damageType: DamageType.Bludgeoning\r\n                }\r\n            ],\r\n            \"Marinate\":\r\n                [\r\n                    {\r\n                        diceCount: 2,\r\n                        diceSize: 4,\r\n                        modifier: 0,\r\n                        damageType: DamageType.Acid\r\n                    }\r\n                ],\r\n        },\r\n    },\r\n]\r\n\r\nconst ItemMap_Potions: IItemPotionJson[] =\r\n[\r\n    {\r\n        key: 'SmallHealing',\r\n        title: 'Small Healing Potion',\r\n        description: 'A small healing potion.',\r\n        details: 'Heals 2d4+2 when consumed.',\r\n        iconSource: './images/Item_Shop/Items/Potions/LowHealthPotion.png',\r\n        source: SourceType.Official,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: false,\r\n        itemCopperCost: 5000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'SmallMana',\r\n        title: 'Small Mana Potion',\r\n        description: 'A small mana potion.',\r\n        details: 'Restores 1 level 1 spell slot when consumed.',\r\n        iconSource: './images/Item_Shop/Items/Potions/LowManaPotion.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: true,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'DarkContract',\r\n        title: 'Potion of the Dark Contract',\r\n        description: 'A dark, bubbling brew.',\r\n        details: 'Light that enters the bottle does not return. On consuming this potion, take 2d4 necrotic damage. Your next attack gains bonus damage equal to twice the necrotic damage that you have taken.',\r\n        iconSource: './images/Item_Shop/Items/Potions/DarkContractPotion.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: false,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'TiamatBrew',\r\n        title: \"Tiamat's Brew\",\r\n        description: 'A rainbow of shifting colors lives in this bottle.',\r\n        details: \"On consumption, cast the Dragon's Breath spell on self.\",\r\n        iconSource: './images/Item_Shop/Items/Potions/potion_tiamat.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: true,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'PoisonousMiasma',\r\n        title: 'Poisonous Miasma',\r\n        description: 'A swirling, toxic potion. The likeness of a long, green, clay snake is enveloped around the bottle.',\r\n        details: 'When used, causes a weapon to deal an additional 2 poison damage to attacks that deal slashing or piercing damage. The effect lasts 1 hour. Application takes 1 minute, and this item is consumed on use.',\r\n        iconSource: './images/Item_Shop/Items/Potions/poison.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: false,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'BurningMiasma',\r\n        title: 'Burning Miasma',\r\n        description: 'A swirling, heated potion. The likeness of a long, red, clay snake is enveloped around the bottle.',\r\n        details: 'When used, causes a weapon to deal an additional 2 fire damage to attacks that deal slashing or piercing damage. The effect lasts 1 hour. Application takes 1 minute, and this item is consumed on use.',\r\n        iconSource: './images/Item_Shop/Items/Potions/poison_burning.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: false,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'ElectricMiasma',\r\n        title: 'Electric Miasma',\r\n        description: 'A swirling, shocking potion. The likeness of a long, yellow, clay snake is enveloped around the bottle.',\r\n        details: 'When used, causes a weapon to deal an additional 2 lightning damage to attacks that deal slashing or piercing damage. The effect lasts 24 hours. Application takes 1 minute, and this item is consumed on use.',\r\n        iconSource: './images/Item_Shop/Items/Potions/poison_lightning.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: false,\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Consumable,\r\n    },\r\n    {\r\n        key: 'AngelicPotion',\r\n        title: 'Angelic Potion',\r\n        description: 'A large, winged potion. The bottle is miraculously light.',\r\n        details: 'Bubbles rise endlessly from the bottom of the glass. When consumed, heals 2d4+2 hitpoints and grants the user the ability to fly for the next 18 seconds (3 rounds of combat).',\r\n        iconSource: './images/Item_Shop/Items/Potions/AngelicPotion.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: false,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        hasWithdrawalEffect: true,\r\n        itemCopperCost: 25000,\r\n        type: ItemType.Consumable,\r\n    },\r\n]\r\n\r\nconst ItemMap_Armor: IItemArmorJson[] = [];\r\n\r\nconst ItemMap_Wondrous: IItemWondrousJson[] =\r\n[\r\n    {\r\n        key: 'FireyRing',\r\n        title: 'Firey Ring',\r\n        description: 'A golden ring with a ruby fastened to its exterior. The ring is warm to the touch.',\r\n        details: 'Grants the bearer access to the Fire Bolt cantrip. If the user has no spellcasting modifier, they may use their Wisdom modifier.',\r\n        iconSource: './images/Item_Shop/Items/Rings/Ring Jewel Red.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Wondrous,\r\n    },\r\n    {\r\n        key: 'FrigidRing',\r\n        title: 'Frigid Ring',\r\n        description: 'A silver ring with a sapphire fastened to its exterior. The ring is cold to the touch.',\r\n        details: 'Grants the bearer access to the Ray of Frost cantrip. If the user has no spellcasting modifier, they may use their Wisdom modifier.',\r\n        iconSource: './images/Item_Shop/Items/Rings/Ring Silver Jewel Green.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        itemCopperCost: 10000,\r\n        type: ItemType.Wondrous,\r\n    },\r\n    {\r\n        key: 'FloralRing',\r\n        title: 'Ring of Floral Accomodation',\r\n        description: 'A silver ring with the likeness of a pink rose fastened to its exterior.',\r\n        details: 'When touched to any surface, that surface will sprout flowers at a rapid pace for the next 6 seconds.',\r\n        iconSource: './images/Item_Shop/Items/Rings/Ring Floral.png',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        itemCopperCost: 5000,\r\n        type: ItemType.Wondrous,\r\n    },\r\n    {\r\n        key: 'BahamutScale',\r\n        title: \"Platinum Scale\",\r\n        description: 'A shimmering scale from a platinum god.',\r\n        details: \"The radiance of this scale permeates even the darkest of caverns. Light reflected off the surface of the scale is visible in all locations save for total darkness. This scale is believed to have fallen from the wings of Bahamut, The Platinum Dragon. On casting the Darkness spell, the darkness aura takes the following properties: * Rather than magical darkness, the aura is magical lightness. This lightness sheds bright light for 15 ft. and dim light for another 15 ft. * Creatures that enter the aura or are within the radius of the aura on cast take 1d4 lightning damage. This damage does not apply to the caster.\",\r\n        iconSource: './images/Item_Shop/Items/Wondrous/Scale.gif',\r\n        source: SourceType.Homebrew,\r\n        requiresAttunement: true,\r\n        adjustments: {\r\n            magicBonus: 0,\r\n            isAttuned: false,\r\n            notes: \"\"\r\n        },\r\n        itemCopperCost: 50000,\r\n        type: ItemType.Wondrous,\r\n    },\r\n]\r\n","export enum ShopKeepers\r\n{\r\n    Indigo = \"Indigo\"\r\n}\r\n","export enum ChestTypes {\r\n    Wooden = \"Wooden\"\r\n}\r\n","// import firebase from 'firebase';\r\nimport { firestore } from 'firebase';\r\nimport { IItemKey } from '../../ItemData/Interfaces/IItemKey';\r\nimport { ItemShopData } from '../../Shops/Types/ItemShopData';\r\nimport { ChestData } from '../../Chests/Types/ChestData';\r\nimport { ShopKeepers } from '../../Shops/Types/ShopKeepers';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemSource } from '../../ItemData/Classes/ItemSource';\r\nimport { ItemType } from '../../ItemData/Enums/ItemType';\r\nimport { DnDConstants } from '../../Utilities/Classes/DndConstants';\r\nimport { ChestTypes } from '../../Chests/Enums/ChestTypes';\r\n\r\n/**\r\n * A class used to handle game room creation and handling with the firebase realtime database. Note that\r\n * use of this class makes an assumption that the database has been connnected to already, and that the\r\n * user has already been authorized.\r\n */\r\nexport class GameRoomService {\r\n    private static readonly collection_userWritable: string = \"userWritable\";\r\n    private static readonly document_itemStorage: string = \"itemStorage\";\r\n    private static readonly collection_shops: string = \"shops\";\r\n    private static readonly collection_chests: string = \"chests\";\r\n\r\n    private static ShopDataConverter: firestore.FirestoreDataConverter<ItemShopData> = {\r\n        toFirestore: (shopData: ItemShopData): firestore.DocumentData => {\r\n            let itemKeys: IItemKey[] = DnDConstants.GetItemsAsFreshKeys(shopData.Items);\r\n            let itemStrings: string[] = itemKeys.map(i => JSON.stringify(i as IItemKey));\r\n\r\n            return {\r\n                Items: itemStrings,\r\n                Name: shopData.Name,\r\n                ShopKeeper: shopData.ShopKeeper,\r\n            }\r\n        },\r\n        fromFirestore: (snapshot, options): ItemShopData => {\r\n            let snapshotData = snapshot.data(options);\r\n\r\n            let items: string[] = snapshotData.Items;\r\n            let name: string = snapshotData.Name;\r\n            let shopKeeper: string = snapshotData.ShopKeeper;\r\n\r\n            // Default to a standard shopkeeper in the event we don't understand what's stored in the DB.\r\n            let translatedShopkeeper: ShopKeepers = ShopKeepers.Indigo\r\n            if (shopKeeper as ShopKeepers) {\r\n                translatedShopkeeper = shopKeeper as ShopKeepers;\r\n            }\r\n\r\n            let translatedItems: IItem[] = items\r\n                .map(i => GameRoomService.ConvertStoredItemToItem(i))\r\n                .filter(i => i !== undefined) as IItem[];\r\n\r\n            let playerData: ItemShopData = {\r\n                ID: snapshot.id,\r\n                Name: name,\r\n                ShopKeeper: translatedShopkeeper,\r\n                Items: translatedItems\r\n            };\r\n\r\n            return playerData;\r\n        }\r\n    }\r\n\r\n    private static ChestDataConverter: firestore.FirestoreDataConverter<ChestData> = {\r\n        toFirestore: (chestData: ChestData): firestore.DocumentData => {\r\n            let itemKeys: IItemKey[] = DnDConstants.GetItemsAsFreshKeys(chestData.Items);\r\n            let itemStrings: string[] = itemKeys.map(i => JSON.stringify(i as IItemKey));\r\n\r\n            return {\r\n                Items: itemStrings,\r\n                Name: chestData.Name,\r\n                ChestType: chestData.ChestType,\r\n                CopperInChest: chestData.CopperInChest\r\n            }\r\n        },\r\n        fromFirestore: (snapshot, options): ChestData => {\r\n            let snapshotData = snapshot.data(options);\r\n\r\n            let items: string[] = snapshotData.Items;\r\n            let name: string = snapshotData.Name;\r\n            let copper: number = snapshotData.CopperInChest;\r\n            let typeOfChest: string = snapshotData.ChestType;\r\n\r\n            // Default to a standard shopkeeper in the event we don't understand what's stored in the DB.\r\n            let translatedChestType: ChestTypes = ChestTypes.Wooden;\r\n            if (typeOfChest as ChestTypes) {\r\n                translatedChestType = typeOfChest as ChestTypes;\r\n            }\r\n\r\n            let translatedItems: IItem[] = items\r\n                .map(i => GameRoomService.ConvertStoredItemToItem(i))\r\n                .filter(i => i !== undefined) as IItem[];\r\n\r\n            let playerData: ChestData = {\r\n                ID: snapshot.id,\r\n                Name: name,\r\n                ChestType: translatedChestType,\r\n                Items: translatedItems,\r\n                CopperInChest: copper\r\n            };\r\n\r\n            return playerData;\r\n        }\r\n    }\r\n\r\n    private static ConvertStoredItemToItem(itemStr: string): IItem | undefined {\r\n        let convertedItem: IItem | undefined = undefined;\r\n\r\n        try {\r\n            let parsedObj: any = JSON.parse(itemStr);\r\n            let emptyItemKey: IItemKey =\r\n            {\r\n                key: \"\",\r\n                type: ItemType.Wondrous,\r\n                adjustments:\r\n                {\r\n                    magicBonus: 0,\r\n                    isAttuned: false,\r\n                    notes: \"\"\r\n                }\r\n            };\r\n\r\n            let createdItemKey: IItemKey = Object.assign(emptyItemKey, parsedObj) as IItemKey;\r\n            convertedItem = ItemSource.GetItem(createdItemKey);\r\n        }\r\n        catch {\r\n            console.error(\"Invalid item data stored in shop!\");\r\n        }\r\n\r\n        return convertedItem;\r\n    }\r\n\r\n    /**\r\n     * Adds a new shop to the current game room.\r\n     * @param shop The shop details that will be added. The ID for this will be modified and returned.\r\n     */\r\n    public static async CreateShop(shop: ItemShopData): Promise<ItemShopData> {\r\n        let updatedShopTab: ItemShopData = shop;\r\n        console.log(\"FIREBASE: Create shop.\");\r\n\r\n        await firestore()\r\n            .collection(this.collection_userWritable)\r\n            .doc(this.document_itemStorage)\r\n            .collection(this.collection_shops)\r\n            .withConverter(GameRoomService.ShopDataConverter)\r\n            .add(shop)\r\n            .then(response => {\r\n                if (response && response.id) {\r\n                    updatedShopTab.ID = response.id;\r\n                }\r\n            })\r\n            .catch(reason => {\r\n                console.error(reason);\r\n            });\r\n\r\n        return updatedShopTab;\r\n    }\r\n\r\n    public static async GetShopByShopId(shopId: string): Promise<ItemShopData | undefined> {\r\n        let response: ItemShopData | undefined = undefined;\r\n        console.log(\"FIREBASE: Get shop.\");\r\n\r\n        await firestore()\r\n            .collection(this.collection_userWritable)\r\n            .doc(this.document_itemStorage)\r\n            .collection(this.collection_shops)\r\n            .doc(shopId)\r\n            .withConverter(GameRoomService.ShopDataConverter)\r\n            .get()\r\n            .then(docSnapshot => {\r\n                if (docSnapshot.exists) {\r\n                    response = docSnapshot.data();\r\n                }\r\n                else {\r\n                    console.error(`Could not find shop data for id ${shopId}`);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.error(error);\r\n            });\r\n\r\n        return response;\r\n    }\r\n\r\n    /**\r\n    * Adds a new chest.\r\n    * @param chest The chest details that will be added. The ID for this will be modified and returned.\r\n    */\r\n    public static async CreateChest(chest: ChestData): Promise<ChestData> {\r\n        let updatedChestTab: ChestData = chest;\r\n        console.log(\"FIREBASE: Create shop.\");\r\n\r\n        await firestore()\r\n            .collection(this.collection_userWritable)\r\n            .doc(this.document_itemStorage)\r\n            .collection(this.collection_chests)\r\n            .withConverter(GameRoomService.ChestDataConverter)\r\n            .add(chest)\r\n            .then(response => {\r\n                if (response && response.id) {\r\n                    updatedChestTab.ID = response.id;\r\n                }\r\n            })\r\n            .catch(reason => {\r\n                console.error(reason);\r\n            });\r\n\r\n        return updatedChestTab;\r\n    }\r\n\r\n    public static async GetChestByChestId(chestId: string): Promise<ChestData | undefined> {\r\n        let response: ChestData | undefined = undefined;\r\n        console.log(\"FIREBASE: Get shop.\");\r\n\r\n        await firestore()\r\n            .collection(this.collection_userWritable)\r\n            .doc(this.document_itemStorage)\r\n            .collection(this.collection_chests)\r\n            .doc(chestId)\r\n            .withConverter(GameRoomService.ChestDataConverter)\r\n            .get()\r\n            .then(docSnapshot => {\r\n                if (docSnapshot.exists) {\r\n                    response = docSnapshot.data();\r\n                }\r\n                else {\r\n                    console.error(`Could not find shop data for id ${chestId}`);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.error(error);\r\n            });\r\n\r\n        return response;\r\n    }\r\n}\r\n","import React, { FormEvent, ChangeEvent } from 'react';\r\nimport '../LoginPage.css'\r\nimport { UserDataAuth } from '../../FirebaseAuth/Classes/UserDataAuth';\r\nimport { CreateUserResponse } from '../../FirebaseAuth/Types/CreateUserResponse';\r\nimport { LoginResponse } from '../../FirebaseAuth/Types/LoginResponse';\r\nimport { LoginState } from '../Enums/LoginState';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { IItemKey } from '../../ItemData/Interfaces/IItemKey';\r\nimport { ItemType } from '../../ItemData/Enums/ItemType';\r\nimport { ItemSource } from '../../ItemData/Classes/ItemSource';\r\nimport { ItemShopData } from '../../Shops/Types/ItemShopData';\r\nimport { ShopKeepers } from '../../Shops/Types/ShopKeepers';\r\nimport { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\nimport { ChestData } from '../../Chests/Types/ChestData';\r\nimport { ChestTypes } from '../../Chests/Enums/ChestTypes';\r\n// import { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\n// import { ItemShopData } from '../../Shops/Types/ItemShopData';\r\n// import { ShopKeepers } from '../../Shops/Types/ShopKeepers';\r\n// import { ItemSource } from '../../ItemData/Classes/ItemSource';\r\n// import { ItemType } from '../../ItemData/Enums/ItemType';\r\n// import { IItem } from '../../ItemData/Interfaces/IItem';\r\n// import { IItemKey } from '../../ItemData/Interfaces/IItemKey';\r\n\r\n/**\r\n * @description A series of properties to use to render this component.\r\n */\r\ninterface ILoginPageProps {\r\n    onLogin: (loginState: LoginState) => void;\r\n};\r\n\r\n/**\r\n * @description An object used to maintain the internal state of this object.\r\n * @param pageState A stateful viariable used to keep track of what to display/provide as options.\r\n * @param errorMessages A set of error messages to display to the user.\r\n */\r\ninterface ILoginPageState {\r\n    pageState: LoginState;\r\n    errorMessages: string[];\r\n}\r\n\r\n/**\r\n * @description The login and account-creation form for this site.\r\n */\r\nexport class LoginPage extends React.Component<ILoginPageProps, ILoginPageState> {\r\n    private currentUsername: string;\r\n    private currentPassword: string;\r\n    private currentPassDupe: string;\r\n\r\n    /**\r\n     * Creates a new instance of this object.\r\n     * @param props The series of properties passed in as input for this component.\r\n     */\r\n    public constructor(props: ILoginPageProps) {\r\n        super(props);\r\n\r\n        this.currentUsername = \"\";\r\n        this.currentPassword = \"\";\r\n        this.currentPassDupe = \"\";\r\n\r\n        let loginState: LoginState = LoginState.CheckingCredentials;\r\n        this.CheckForLogin();\r\n\r\n        this.state = {\r\n            pageState: loginState,\r\n            errorMessages: []\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description Fired immediately after this component has mounted. This is used to update the component\r\n     * to reflect whether the user has logged in using stored credentials.\r\n     */\r\n    public componentDidMount() {\r\n        this.CheckForLogin();\r\n    }\r\n\r\n    private HandleTestButton(): void {\r\n        let firstItemKey: IItemKey = \r\n        {\r\n            key: \"PoisonousMiasma\",\r\n            type: ItemType.Consumable,\r\n            adjustments:\r\n            {\r\n                magicBonus: 0,\r\n                isAttuned: false,\r\n                notes: \"\"\r\n            }\r\n        };\r\n\r\n        let secondItemKey: IItemKey = \r\n        {\r\n            key: \"BrutalLongsword\",\r\n            type: ItemType.Weapon,\r\n            adjustments:\r\n            {\r\n                magicBonus: 0,\r\n                isAttuned: false,\r\n                notes: \"\"\r\n            }\r\n        };\r\n\r\n        let sauceItemKey: IItemKey = \r\n        {\r\n            key: \"EdwardSteakSauce\",\r\n            type: ItemType.Weapon,\r\n            adjustments:\r\n            {\r\n                magicBonus: 0,\r\n                isAttuned: false,\r\n                notes: \"\"\r\n            }\r\n        }\r\n\r\n        // let firstItem: IItem = ItemSource.GetItem(firstItemKey) as IItem;\r\n        // let secondItem: IItem = ItemSource.GetItem(secondItemKey) as IItem;\r\n        let sauceItem: IItem = ItemSource.GetItem(sauceItemKey) as IItem;\r\n        \r\n        let chest: ChestData = {\r\n            ID: \"\",\r\n            Name: \"Edward's Chest\",\r\n            CopperInChest: 420,\r\n            ChestType: ChestTypes.Wooden,\r\n            Items: [\r\n                sauceItem\r\n            ]\r\n        }\r\n        \r\n        let createdShop = GameRoomService.CreateChest(chest);\r\n        // let receivedShop = GameRoomService.GetShopByShopId(\"NfyJ92g0JmXl5Ffru0oo\");\r\n    }\r\n\r\n    /**\r\n     * @description Renders thi object.\r\n     */\r\n    public render() {\r\n        return (\r\n            <div className=\"login-container\">\r\n                <div className=\"login-dialog\">\r\n                    <h2 className=\"login-header\">\r\n                        {this.state.pageState.toString()}\r\n                    </h2> \r\n                    <div className=\"login-error-messages\">\r\n                        {this.getErrorMessages()}\r\n                    </div>\r\n                    {this.GetInternalRenderBits()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n                    // <button onClick={this.HandleTestButton}>Test Button</button>\r\n\r\n\r\n    private async CheckForLogin() {\r\n        let loginState: LoginState = LoginState.Login;\r\n\r\n        try {\r\n            let accessGranted: boolean = await UserDataAuth.GetInstance().CheckForAccess();\r\n            if (accessGranted) {\r\n                loginState = LoginState.LoggedIn;\r\n            }\r\n        }\r\n        catch(error) {\r\n            console.error(\"Rejected login: \" + error);\r\n        }\r\n\r\n        this.props.onLogin(loginState);\r\n        this.setState({\r\n            pageState: loginState\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @description Renders the internal bits that change depending on the state of this component.\r\n     */\r\n    private GetInternalRenderBits(): JSX.Element {\r\n        switch (this.state.pageState) {\r\n            case LoginState.LoggedIn: {\r\n                return (\r\n                    <div>\r\n                        <h3>You are logged in as {UserDataAuth.GetInstance().Username}</h3>\r\n                        <br /><br />\r\n                        <div className=\"login-button-container\">\r\n                            <button className=\"login-button\" onClick={this.submitLogout.bind(this)}>\r\n                                Log Out\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            case LoginState.CreateAnAccount: {\r\n                return (\r\n                    <div>\r\n                        <form className=\"login-form\" action=\"/\" method=\"POST\" onSubmit={this.submitCreateAccount.bind(this)}>\r\n                            <br /> <br />\r\n                            <span>Email:</span>\r\n                            <br />\r\n                            <input type=\"text\" name=\"email\" onChange={this.handleUsernameInput.bind(this)} />\r\n                            <br /> <br />\r\n                            <span>Password:</span>\r\n                            <br />\r\n                            <input type=\"password\" name=\"password\" onChange={this.handlePasswordInput.bind(this)} />\r\n                            <br /> <br />\r\n                            <span>Password (Again!):</span>\r\n                            <br />\r\n                            <input type=\"password\" name=\"passwordDupe\" onChange={this.handlePassDupeInput.bind(this)} />\r\n                            <br /> <br />\r\n                            <input\r\n                                className=\"login-button\"\r\n                                type=\"submit\"\r\n                                style={{ display: \"initial\" }}\r\n                                value=\"Create Account\" />\r\n                        </form>\r\n                        <div className=\"login-button-container\">\r\n                            <button\r\n                                className=\"login-button\"\r\n                                onClick={this.submitBackToLogin.bind(this)}>\r\n                                Back To Login\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            case LoginState.CheckingCredentials: {\r\n                return (\r\n                    <div>\r\n                        <h2>Checking login credentials . . . </h2>\r\n                    </div>\r\n                )\r\n            }\r\n            case LoginState.Login:\r\n            default: {\r\n                return (\r\n                    <div>\r\n                        <form className=\"login-form\" action=\"/\" method=\"POST\" onSubmit={this.submitLogin.bind(this)}>\r\n                            <br /> <br />\r\n                            <span>Email:</span>\r\n                            <br />\r\n                            <input type=\"text\" name=\"email\" onChange={this.handleUsernameInput.bind(this)} />\r\n                            <br /> <br />\r\n                            <span>Password:</span>\r\n                            <br />\r\n                            <input type=\"password\" name=\"password\" onChange={this.handlePasswordInput.bind(this)} />\r\n                            <br /> <br />\r\n                            <input\r\n                                className=\"login-button\"\r\n                                style={{ display: \"initial\" }}\r\n                                type=\"submit\"\r\n                                value=\"Log In\" />\r\n                        </form>\r\n                        <div className=\"login-button-container\">\r\n                            <button\r\n                                className=\"login-button\"\r\n                                onClick={this.submitGoToCreateAccount.bind(this)}>\r\n                                Create An Account\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description Gets a series of error messages to render from the current state.\r\n     */\r\n    private getErrorMessages(): JSX.Element[] {\r\n        return (\r\n            this.state.errorMessages.map(e => {\r\n                return (\r\n                    <p>{e}</p>\r\n                )\r\n            })\r\n        )\r\n    }\r\n\r\n    /**\r\n     * @description Handles the click event for the 'submit' button when the user is logging in.\r\n     * @param event The event to handle when the user presses, \"Login\".\r\n     */\r\n    private submitLogin(event: FormEvent<HTMLFormElement>) {\r\n        // By default, this causes the page to refresh which we DO NOT WANT. This happens because the provided\r\n        // form looks to browsers like a standard login form.\r\n        event.preventDefault();\r\n\r\n        // Attempt to log in using UserDataAuth.\r\n        let loginPromise: Promise<LoginResponse> = UserDataAuth.GetInstance().Login(this.currentUsername, this.currentPassword);\r\n\r\n        this.setState({\r\n            pageState: LoginState.CheckingCredentials\r\n        });\r\n\r\n        loginPromise.then(\r\n            loggedIn => {\r\n                if (loggedIn.DidLogin) {\r\n                    this.props.onLogin(LoginState.LoggedIn);\r\n                    this.setState({\r\n                        pageState: LoginState.LoggedIn\r\n                    });\r\n                }\r\n                else {\r\n                    this.setState({\r\n                        errorMessages: [\"That username and password was not valid. Please try again.\"]\r\n                    });\r\n                }\r\n            }\r\n        )\r\n    }\r\n\r\n    /**\r\n     * @description Handles when the user selects the \"Logout\" button.\r\n     */\r\n    private submitLogout() {\r\n        // Logout from the user data auth.\r\n        UserDataAuth.GetInstance().Logout();\r\n        this.props.onLogin(LoginState.Login);\r\n\r\n        // Set page state to LoggingOut, which should redirect to the home page.\r\n        this.setState({\r\n            pageState: LoginState.Login\r\n        });\r\n\r\n        CharacterStateManager.GetInstance().ChangeCharacter(undefined);\r\n    }\r\n\r\n    /**\r\n     * @description Handles when the user selects the \"Create an account\" button.\r\n     * @param event The event arguments provided when a user creates an account.\r\n     */\r\n    private submitCreateAccount(event: FormEvent<HTMLFormElement>) {\r\n        event.preventDefault();\r\n\r\n        let response: Promise<CreateUserResponse> = UserDataAuth.GetInstance().CreateAccount(\r\n            this.currentUsername,\r\n            this.currentPassword,\r\n            this.currentPassDupe);\r\n\r\n        response.then(\r\n            onResolve => {\r\n                // Always set the error list to whatever we got. This way it clears when we have no errors.\r\n                this.setState({\r\n                    errorMessages: onResolve.Errors\r\n                });\r\n\r\n                if (onResolve.DidCreate) {\r\n                    this.props.onLogin(LoginState.Login);\r\n                    this.setState({\r\n                        pageState: LoginState.LoggedIn\r\n                    });\r\n                }\r\n            }, onReject => {\r\n                console.error(\"Failed to create a user account.\" + onReject);\r\n            }\r\n        )\r\n    }\r\n\r\n    /**\r\n     * @description Handles the click event when a user goes to the 'Create An Account' button.\r\n     */\r\n    private submitGoToCreateAccount() {\r\n        this.setState({\r\n            pageState: LoginState.CreateAnAccount\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @description Handles when a user selects the \"Back To Login\" button.\r\n     */\r\n    private submitBackToLogin() {\r\n        this.setState({\r\n            pageState: LoginState.Login\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @description Handles when the user types/provides input into the username field.\r\n     * @param event The event arguments provided when the user is changing the username field.\r\n     */\r\n    private handleUsernameInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event.target?.value;\r\n        if (input !== null) {\r\n            this.currentUsername = input;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description Handles when the user types/provides input into the password field.\r\n     * @param event The event arguments provided when the user is changing the field.\r\n     */\r\n    private handlePasswordInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event.target?.value;\r\n        if (input !== null) {\r\n            this.currentPassword = input;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description Handles when the user types/provides input into the password verification field.\r\n     * @param event The event arguments provided when the user is changing the field.\r\n     */\r\n    private handlePassDupeInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event.target?.value;\r\n        if (input !== null) {\r\n            this.currentPassDupe = input;\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Route, Redirect } from 'react-router-dom';\r\nimport { UserDataAuth } from '../../FirebaseAuth/Classes/UserDataAuth';\r\n\r\nexport interface IProtectedRouteState {\r\n    routeStatus: TRouteCheckStatus;\r\n}\r\n\r\nexport interface IProtectedRouteProps {\r\n    children: JSX.Element,\r\n    path: string\r\n}\r\n\r\ntype TRouteCheckStatus = \"Granted\" | \"Redirect\" | \"Checking\"\r\n\r\n// https://reacttraining.com/react-router/web/example/auth-workflow\r\n// https://tylermcginnis.com/react-router-protected-routes-authentication/\r\nexport class ProtectedRoute extends React.Component<IProtectedRouteProps, IProtectedRouteState> {\r\n    public constructor(props: IProtectedRouteProps) {\r\n        super(props);\r\n        this.state = {\r\n            routeStatus: \"Checking\"\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.GetComponentToRender();\r\n    }\r\n\r\n    private GetComponentToRender(): void {\r\n        UserDataAuth.GetInstance().CheckForAccess().then(granted => {\r\n            if (granted) {\r\n                this.setState({\r\n                    routeStatus: \"Granted\"\r\n                });\r\n            }\r\n            else {\r\n                this.setState({\r\n                    routeStatus: \"Redirect\"\r\n                });\r\n            }\r\n        })\r\n    }\r\n\r\n    public render() {\r\n        switch(this.state.routeStatus) {\r\n            case \"Granted\": {\r\n                return (\r\n                    <Route path={this.props.path} children={this.props.children} />\r\n                );\r\n            }\r\n            case \"Redirect\": {\r\n                return (\r\n                    <Redirect to='/login' />\r\n                );\r\n            }\r\n            case \"Checking\":\r\n            default: {\r\n                return (\r\n                    <div>\r\n                        <h2>Checking user authorization . . .</h2>\r\n                    </div>\r\n                );\r\n            }\r\n        }\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { PartSelectionCallback } from '../Types/PartSelectionCallback';\r\nimport { PartType } from '../Enums/PartType';\r\n\r\n/**\r\n * @description The properties for this component.\r\n * @param partType The type of part that is represented by this button.\r\n * @param imageSource The source for the iamge that is represented by this button.\r\n * @param partSelectionCallback The callback when this button is clicked.\r\n */\r\nexport interface IPartButtonProps {\r\n    partType: PartType;\r\n    imageSource: string;\r\n    partSelectionCallback: PartSelectionCallback;\r\n};\r\n\r\n/**\r\n * A constant that represents the size of the button/image that is represented here.\r\n */\r\nconst imgSize: string = \"128px\";\r\n\r\n/**\r\n * A component used to represent an individual option for a character part.\r\n * @param props \r\n */\r\nexport function PartButton(props: IPartButtonProps) {\r\n    return (\r\n        <button\r\n            className=\"part-button\"\r\n            onClick={() => props.partSelectionCallback(props.partType, props.imageSource)}>\r\n            <img\r\n                alt=\"\"\r\n                className=\"part-button-image\"\r\n                src={props.imageSource}\r\n                width={imgSize}\r\n            />\r\n        </button>\r\n    )\r\n}\r\n","export enum BodyType {\r\n    AverageSizedFeminine = \"Average-Sized Feminine\",\r\n    AverageSizedMasculine = \"Average-Sized Masculine\",\r\n    ReptilianFeminine = \"Reptilian Feminine\",\r\n    ReptilianMasculine = \"Reptilian Masculine\",\r\n}","import React from 'react';\r\nimport { PartType } from '../Enums/PartType';\r\nimport { PartTypeSelectionCallback } from '../Types/PartTypeSelectionCallback';\r\nimport { Dropdown } from 'react-bootstrap';\r\n\r\n/**\r\n * @description The properties provided to this component.\r\n * @param SelectionCallback The function to be called when a part type is selected from the dropdown.\r\n */\r\nexport interface IPartTypeSelectorProps {\r\n    SelectionCallback: PartTypeSelectionCallback;\r\n};\r\n\r\n/**\r\n * @description The state maintained by this component.\r\n */\r\nexport interface IPartTypeSelectorState {\r\n};\r\n\r\n/**\r\n * @description The part-type selector. This lets the character creator switch between part types.\r\n */\r\nexport class PartTypeSelector extends React.Component<IPartTypeSelectorProps, IPartTypeSelectorState> {\r\n    /**\r\n     * @description Creates a new isntance of this component.\r\n     * @param props The provided properties for this class.\r\n     */\r\n    constructor(props: IPartTypeSelectorProps) {\r\n        super(props);\r\n        this.state = {\r\n        };\r\n    }\r\n    /**\r\n     * @description Renders this component.\r\n     */\r\n    public render() {\r\n        return (\r\n            <Dropdown\r\n                className=\"part-type-selector\">\r\n                <Dropdown.Toggle id=\"part-dropdown\">\r\n                    Part Type Selection\r\n                </Dropdown.Toggle>\r\n\r\n                <Dropdown.Menu>\r\n                    {this.GetPartTypes()}\r\n                </Dropdown.Menu>\r\n            </Dropdown>\r\n        );\r\n    }\r\n\r\n    private GetPartTypes(): JSX.Element[] {\r\n        return Object.values(PartType).map(pt => {\r\n            let itemClickCallback = () => {this.props.SelectionCallback(pt)};\r\n\r\n            return (\r\n                <Dropdown.Item\r\n                    key={pt.toString()}\r\n                    onClick={itemClickCallback.bind(this)}>\r\n                    {pt.toString()}\r\n                </Dropdown.Item>\r\n            )\r\n        });\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Dropdown } from 'react-bootstrap';\r\nimport { BodyType } from '../Enums/BodyType';\r\nimport { BodyTypeSelectionCallback } from '../Types/BodyTypeSelectionCallback';\r\n\r\n/**\r\n * @description The properties provided to this component.\r\n * @param SelectionCallback The function to be called when a body type is selected from the dropdown.\r\n */\r\nexport interface IPartBodySelectorProps {\r\n    SelectionCallback: BodyTypeSelectionCallback;\r\n}\r\n\r\n/**\r\n * @description The state maintained by this component.\r\n */\r\nexport interface IPartBodySelectorState {\r\n}\r\n\r\n/**\r\n * @description The body-type selector. This lets the character creator switch between body types.\r\n */\r\nexport class PartBodySelector extends React.Component<IPartBodySelectorProps, IPartBodySelectorState> {\r\n    /**\r\n     * @description Creates a new isntance of this component.\r\n     * @param props The provided properties for this class.\r\n     */\r\n    constructor(props: IPartBodySelectorProps) {\r\n        super(props);\r\n        this.state = {\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description Renders this component.\r\n     */\r\n    public render() {\r\n        return (\r\n            <Dropdown>\r\n                <Dropdown.Toggle id=\"body-dropdown\">\r\n                    Body Type Selection\r\n                </Dropdown.Toggle>\r\n\r\n                <Dropdown.Menu>\r\n                    {this.GetBodyTypes()}\r\n                </Dropdown.Menu>\r\n            </Dropdown>\r\n        );\r\n    }\r\n\r\n    private GetBodyTypes(): JSX.Element[] {\r\n        return Object.values(BodyType).map(bt => {\r\n            let itemClickCallback = () => {this.props.SelectionCallback(bt)};\r\n\r\n            return (\r\n                <Dropdown.Item\r\n                    key={bt.toString()}\r\n                    onClick={itemClickCallback.bind(this)}>\r\n                    {bt.toString()}\r\n                </Dropdown.Item>\r\n            )\r\n        })\r\n    }\r\n}\r\n","export enum BodyDescription\r\n{\r\n    Androgynous = 'Androgynous',\r\n    Female = 'Female',\r\n    Male = 'Male',\r\n\r\n    HumanoidAndrogynous = 'Humanoid_Androgynous',\r\n    HumanoidFemale = 'Humanoid_Female',\r\n    HumanoidMale = 'Humanoid_Male',\r\n\r\n    ReptilianAndrogynous = 'Reptilian_Androgynous',\r\n    ReptilianFemale = 'Reptilian_Female',\r\n    ReptilianMale = 'Reptilian_Male',\r\n}","import React from 'react';\r\n\r\nimport { PartButton } from './PartButton';\r\nimport { PartTypeSelector } from './PartTypeSelector';\r\nimport { PartBodySelector } from './PartBodySelector';\r\n\r\nimport { PartType } from '../Enums/PartType';\r\nimport { PartTypeSelectionCallback } from '../Types/PartTypeSelectionCallback';\r\nimport { BodyTypeSelectionCallback } from '../Types/BodyTypeSelectionCallback';\r\nimport { PartSelectionCallback } from '../Types/PartSelectionCallback';\r\n\r\n/**\r\n * @description The properties provided to this component.\r\n * @param partType The part type whose buttons are displayed in in this component at present.\r\n * @param partOptions The list of image sources that are displayed as options.\r\n * @param partTypeSelectionCallback A callback when a part type has been selected.\r\n * @param bodyTypeSelectionCallback A callback when a body type has been selected.\r\n * @param partSelectionCallback A callback when the type of part represented as an option changes.\r\n */\r\nexport interface IPartSelectorProps {\r\n    partType: PartType;\r\n    partOptions: string[];\r\n    partTypeSelectionCallback: PartTypeSelectionCallback;\r\n    bodyTypeSelectionCallback: BodyTypeSelectionCallback;\r\n    partSelectionCallback: PartSelectionCallback;\r\n};\r\n\r\n/**\r\n * @description The state maintained by this component.\r\n */\r\nexport interface IPartSelectorState {\r\n};\r\n\r\n/**\r\n * @description The part selector for the character creator. This provides compnonents to switch body types,\r\n * part types, and parts.\r\n */\r\nexport class PartSelector extends React.Component<IPartSelectorProps, IPartSelectorState> {\r\n    /**\r\n     * @description Creates a new isntance of this component.\r\n     * @param props The provided properties for this class.\r\n     */\r\n    constructor(props: IPartSelectorProps) {\r\n        super(props);\r\n        this.state = {\r\n        };\r\n    }\r\n    /**\r\n     * @description Renders this component.\r\n     */\r\n    public render() {\r\n        return (\r\n            <div className=\"part-selector\">\r\n                <div className=\"part-character-selectors\">\r\n                    <PartBodySelector\r\n                        SelectionCallback={this.props.bodyTypeSelectionCallback}\r\n                    />\r\n                    <PartTypeSelector\r\n                        SelectionCallback={this.props.partTypeSelectionCallback}\r\n                    />\r\n                </div>\r\n                <div className=\"part-selector-buttons\">\r\n                    {this.GetPartButtons()}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    private GetPartButtons(): JSX.Element[] {\r\n        return this.props.partOptions.map(po => \r\n            <PartButton\r\n                key={po}\r\n                partType={this.props.partType}\r\n                imageSource={po}\r\n                partSelectionCallback={this.props.partSelectionCallback}\r\n            />\r\n        );\r\n    }\r\n}\r\n","import CharImageMap from './CharImageStruct.json';\r\nimport { CharacterSize } from '../Enums/CharacterSize';\r\nimport { BodyType } from '../Enums/BodyType';\r\nimport { PartType } from '../Enums/PartType';\r\nimport { CharImageStructItem } from '../Types/CharImageStructItem';\r\nimport { BodyDescription } from '../Enums/BodyDescription';\r\nimport { CharImageLayout } from './CharImageLayout';\r\n\r\n/**\r\n * @description A singleton-like class used to reference constants in the character parts, body types, etc.\r\n */\r\nexport class CharacterImageMap\r\n{\r\n    /**\r\n     * @description The default images to display when a user selects the \"Average-Sized Feminine\" body type.\r\n     */\r\n    private static AverageSizedFeminineDefaults: Map<PartType, string> = new Map<PartType, string>([\r\n        [\r\n            PartType.Eyes,\r\n            \"./images/Character_Image_Defaults/Average-Sized Feminine/Eyes.png\"\r\n        ],\r\n        [\r\n            PartType.Body,\r\n            \"./images/Character_Image_Defaults/Average-Sized Feminine/Body.png\"\r\n        ]\r\n    ]);\r\n\r\n    /**\r\n     * @description The default images to display when a user selects the \"Average-Sized Masculine\" body type.\r\n     */\r\n    private static AverageSizedMasculineDefaults: Map<PartType, string> = new Map<PartType, string>([\r\n        [\r\n            PartType.Eyes,\r\n            \"./images/Character_Image_Defaults/Average-Sized Masculine/Eyes.png\"\r\n        ],\r\n        [\r\n            PartType.Body,\r\n            \"./images/Character_Image_Defaults/Average-Sized Masculine/Body.png\"\r\n        ]\r\n    ]);\r\n    \r\n    /**\r\n     * @description The default images to display when a user selects the \"Reptilian Feminine\" body type.\r\n     */\r\n    private static ReptilianFeminineDefaults: Map<PartType, string> = new Map<PartType, string>([\r\n        [\r\n            PartType.Eyes,\r\n            \"./images/Character_Image_Defaults/Reptilian Feminine/Eyes.png\"\r\n        ],\r\n        [\r\n            PartType.Body,\r\n            \"./images/Character_Image_Defaults/Reptilian Feminine/Body.png\"\r\n        ]\r\n    ]);\r\n\r\n    /**\r\n     * @description The default images to display when a user selects the \"Reptilian Masculine\" body type.\r\n     */\r\n    private static ReptilianMasculineDefaults: Map<PartType, string> = new Map<PartType, string>([\r\n        [\r\n            PartType.Eyes,\r\n            \"./images/Character_Image_Defaults/Reptilian Masculine/Eyes.png\"\r\n        ],\r\n        [\r\n            PartType.Body,\r\n            \"./images/Character_Image_Defaults/Reptilian Masculine/Body.png\"\r\n        ]\r\n    ]);\r\n\r\n    /**\r\n     * @description A map of body types to their respective valid part-type categories. For example, the\r\n     * \"average-sized feminine\" body type can use parts from the, \"humanoid female\", \"humanoid androgynous\",\r\n     * \"female\", and \"androgynous\" categories.\r\n     */\r\n    private static BodyTypeMap: Map<BodyType, BodyDescription[]> = new Map<BodyType, BodyDescription[]>(\r\n        [\r\n            [\r\n                BodyType.AverageSizedFeminine,\r\n                [\r\n                    BodyDescription.HumanoidFemale,\r\n                    BodyDescription.HumanoidAndrogynous,\r\n                    BodyDescription.Female,\r\n                    BodyDescription.Androgynous,\r\n                ]\r\n            ],\r\n            [\r\n                BodyType.AverageSizedMasculine,\r\n                [\r\n                    BodyDescription.HumanoidMale,\r\n                    BodyDescription.HumanoidAndrogynous,\r\n                    BodyDescription.Male,\r\n                    BodyDescription.Androgynous,\r\n                ]\r\n            ],\r\n            [\r\n                BodyType.ReptilianFeminine,\r\n                [\r\n                    BodyDescription.ReptilianFemale,\r\n                    BodyDescription.ReptilianAndrogynous,\r\n                    BodyDescription.Female,\r\n                    BodyDescription.Androgynous,\r\n                ]\r\n            ],\r\n            [\r\n                BodyType.ReptilianMasculine,\r\n                [\r\n                    BodyDescription.ReptilianMale,\r\n                    BodyDescription.ReptilianAndrogynous,\r\n                    BodyDescription.Male,\r\n                    BodyDescription.Androgynous,\r\n                ]\r\n            ],\r\n        ]\r\n    );\r\n\r\n    /**\r\n     * @description The image source for the shadow for the character.\r\n     */\r\n    public static CharacterShadowSource: string = \"./images/Character_Image_Details/CharacterShadow.png\"\r\n\r\n    /**\r\n     * @description Gets the list of valid character images for a given series of body type categories.\r\n     * @param charSize The size of the character to get images for.\r\n     * @param bodyType The type of body to get the images for.\r\n     * @param partType The part type to get images for.\r\n     */\r\n    public static GetCharacterImagePaths(charSize: CharacterSize, bodyType: BodyType, partType: PartType): string[]\r\n    {\r\n        let charStructItems: CharImageStructItem[] =  CharImageMap.filter(c =>\r\n            CharacterImageMap.CompareParamsToStructItem(c, charSize, bodyType, partType));\r\n\r\n        let charImages: string[] = charStructItems.flatMap(csi => csi.Images);\r\n\r\n        return charImages;\r\n    }\r\n\r\n    /**\r\n     * @description A map of body types to their respective default images. Note that this is merely a wrapper\r\n     * to an internal list, this is just to reduce visual noise.\r\n     */\r\n    public static DefaultBodyParts: Map<BodyType, CharImageLayout> = new Map<BodyType, CharImageLayout>(\r\n        [\r\n            [\r\n                BodyType.AverageSizedFeminine,\r\n                new CharImageLayout(CharacterImageMap.AverageSizedFeminineDefaults, BodyType.AverageSizedFeminine)\r\n            ],\r\n            [\r\n                BodyType.AverageSizedMasculine,\r\n                new CharImageLayout(CharacterImageMap.AverageSizedMasculineDefaults, BodyType.AverageSizedMasculine)\r\n            ],\r\n            [\r\n                BodyType.ReptilianFeminine,\r\n                new CharImageLayout(CharacterImageMap.ReptilianFeminineDefaults, BodyType.ReptilianFeminine)\r\n            ],\r\n            [\r\n                BodyType.ReptilianMasculine,\r\n                new CharImageLayout(CharacterImageMap.ReptilianMasculineDefaults, BodyType.ReptilianMasculine)\r\n            ],\r\n        ]\r\n    );\r\n\r\n    /**\r\n     * @description Compares the body-type selection options to the character map struct, picking out items\r\n     * that have a valid match.\r\n     * @param structItem The struct item part to evaluate.\r\n     * @param charSize The size of the character to get images for.\r\n     * @param bodyType The type of body to get the images for.\r\n     * @param partType The part type to get images for.\r\n     */\r\n    private static CompareParamsToStructItem(structItem: CharImageStructItem, charSize: CharacterSize, bodyType: BodyType, partType: PartType): boolean {\r\n        let doesMatch: boolean = true;\r\n        let validBodyDescriptors: BodyDescription[] = [];\r\n\r\n        if (this.BodyTypeMap.has(bodyType)) {\r\n            validBodyDescriptors = this.BodyTypeMap.get(bodyType) as BodyDescription[];\r\n        }\r\n        else {\r\n            console.error(`Invalid body type: ${bodyType} attempted to be retrieved in character image map.`);\r\n        }\r\n        \r\n        doesMatch = doesMatch && structItem.PartType === partType.toString();\r\n        doesMatch = doesMatch && structItem.Size === charSize.toString();\r\n        doesMatch = doesMatch && validBodyDescriptors.some(vbt => vbt.toString() === structItem.BodyType)\r\n\r\n        return doesMatch;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { CharacterImageMap } from '../Classes/CharacterImageMap';\r\nimport { Spinner } from 'react-bootstrap';\r\n\r\n/**\r\n * @description The properties for this class.\r\n * @param imagesToRender A list of images that will be rendered in-order, in the drawing area. Note that the\r\n * order of this array determines how images will be drawn.\r\n * @param borderColor A css-tyle-string to be used to color the border for this character.\r\n */\r\nexport interface ICharacterImageCanvasProps {\r\n    showLoadingSpinner: boolean;\r\n    imagesToRender: string[];\r\n    borderColor: string;\r\n    charScaleFactor: number;\r\n};\r\n\r\n/**\r\n * @description The state maintained by this component.\r\n */\r\nexport interface ICharacterImageCanvasState {\r\n};\r\n\r\n/**\r\n * @description Used to display a character image and its associated border, specified by the properties.\r\n */\r\nexport class CharacterImageCanvas extends React.Component<ICharacterImageCanvasProps, ICharacterImageCanvasState> {\r\n    // private static canvasHeight: number = 512;\r\n    // private static canvasWidth:  number = 256;\r\n    private static canvasHeight: number = 128;\r\n    private static canvasWidth: number = 64;\r\n\r\n    // private static charScaleFactor: number = 4;\r\n    private static charPartOffset: number = 32;\r\n    private static shadowOffset: number = 90;\r\n\r\n    /**\r\n     * Note that the numbers stored here are effectively pairs of coordinates to offset the\r\n     * image stamping by, scaled by the desired thickness of the border.\r\n     * https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Compositing\r\n     */\r\n    private static borderCoordinates: number[] =\r\n    [\r\n        -1, -1,\r\n         0, -1,\r\n         1, -1,\r\n        -1,  0,\r\n         1,  0,\r\n        -1,  1,\r\n         0,  1,\r\n         1,  1\r\n    ];\r\n\r\n    /**\r\n     * @description Creates a new isntance of this object.\r\n     * @param props The properties for this object.\r\n     */\r\n    public constructor(props: ICharacterImageCanvasProps) {\r\n        super(props);\r\n        this.state = {\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description Renders this object.\r\n     */\r\n    public render() {\r\n        let showOnlySpinner: boolean = this.props.showLoadingSpinner;\r\n\r\n        return (\r\n            <div className='character-canvas-container'>\r\n                <Spinner\r\n                    className=\"character-canvas-spinner\"\r\n                    animation=\"border\"\r\n                    role=\"character image status\"\r\n                    style={{ visibility: showOnlySpinner ? 'visible' : 'hidden'}}\r\n                />\r\n                <canvas\r\n                    height={CharacterImageCanvas.canvasHeight * this.props.charScaleFactor}\r\n                    width={CharacterImageCanvas.canvasWidth * this.props.charScaleFactor}\r\n                    id='character-staging-canvas'\r\n                    ref='characterStagingCanvas'\r\n                />\r\n                <canvas\r\n                    height={CharacterImageCanvas.canvasHeight * this.props.charScaleFactor}\r\n                    width={CharacterImageCanvas.canvasWidth * this.props.charScaleFactor}\r\n                    id='character-canvas'\r\n                    ref='characterCanvas'\r\n                />\r\n                <canvas\r\n                    height={CharacterImageCanvas.canvasHeight * this.props.charScaleFactor}\r\n                    width={CharacterImageCanvas.canvasWidth * this.props.charScaleFactor}\r\n                    id='character-effects-canvas'\r\n                    ref='characterEffectsCanvas'\r\n                    style={{ visibility: showOnlySpinner ? 'hidden' : 'visible' }}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @description Gets the download url for this image. This can be used to get the image via a data url.\r\n     */\r\n    public GetDownloadUrl(): string {\r\n        let effectsCanvas: HTMLCanvasElement = this.refs.characterEffectsCanvas as HTMLCanvasElement;\r\n        let downloadUrl: string = effectsCanvas.toDataURL('image/png');\r\n\r\n        return downloadUrl;\r\n    }\r\n\r\n    /**\r\n     * @description Handles events when the component has mounted.\r\n     */\r\n    public componentDidMount() {\r\n        let charStagingCanvas: HTMLCanvasElement = this.refs.characterStagingCanvas as HTMLCanvasElement;\r\n        let stagingCanvasContext: CanvasRenderingContext2D = charStagingCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        let charCanvas: HTMLCanvasElement = this.refs.characterCanvas as HTMLCanvasElement;\r\n        let charCanvasContext: CanvasRenderingContext2D = charCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        let effectsCanvas: HTMLCanvasElement = this.refs.characterEffectsCanvas as HTMLCanvasElement;\r\n        let effectsCanvasContext: CanvasRenderingContext2D = effectsCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        // This is going around the css, but ideally we don't ever want this disply context to change. The\r\n        // sole point of this canvas element is to get a stapled-together version of our final character\r\n        // drawing.\r\n        charStagingCanvas.style.display = 'none';\r\n        charCanvas.style.display = 'none';\r\n\r\n        // This is all done with upsacled pixels, so absolutely no anti-aliasing.\r\n        stagingCanvasContext.imageSmoothingEnabled = false;\r\n        charCanvasContext.imageSmoothingEnabled = false;\r\n        effectsCanvasContext.imageSmoothingEnabled = false;\r\n\r\n        // Draw the character and the border after the component has mounted. This is so that we have at least\r\n        // some default character when we load the page.\r\n        this.DrawCharacterAndBorder();\r\n    }\r\n\r\n    /**\r\n     * @description Handles events when the component has updated.\r\n     */\r\n    public componentDidUpdate() {\r\n        this.DrawCharacterAndBorder();\r\n    }\r\n\r\n    /**\r\n     * @description Draws the character image along with a border for the character. Will clean the canvas on\r\n     * when called.\r\n     */\r\n    private async DrawCharacterAndBorder(): Promise<void> {\r\n        await this.LoadCharacterImages();\r\n        await this.DrawCharacterBorder();\r\n        await this.DrawCharacterWithEffects();\r\n    }\r\n\r\n    /**\r\n     * @description Loads all of the images used to draw a character.\r\n     */\r\n    private async LoadCharacterImages(): Promise<void> {\r\n        // Create an array of html image elements. This will be populated as images are loaded.\r\n        let imagesToDraw: HTMLImageElement[] = new Array(this.props.imagesToRender.length);\r\n\r\n        let loadedImagesPromises: Promise<void>[] = this.props.imagesToRender.map((img, index) => {\r\n            return new Promise<void>(resolve => {\r\n                let imageElement: HTMLImageElement = new Image();\r\n                imageElement.onload = () => resolve();\r\n                imageElement.src = img;\r\n                imagesToDraw[index] = imageElement;\r\n            });\r\n        });\r\n\r\n        await Promise.all(loadedImagesPromises);\r\n\r\n        let charStagingCanvas: HTMLCanvasElement = this.refs.characterStagingCanvas as HTMLCanvasElement;\r\n        let stagingCanvasContext: CanvasRenderingContext2D = charStagingCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        // First, wipe the canvas. This needs to be cleared every time we re-render and re-draw.\r\n        stagingCanvasContext.clearRect(0, 0, charStagingCanvas.width, charStagingCanvas.height);\r\n\r\n        // Now draw all of the individual character components layer-by-layer, from front to back.\r\n        imagesToDraw.forEach(itd => {\r\n            stagingCanvasContext.drawImage(\r\n                itd,\r\n                0,\r\n                CharacterImageCanvas.charPartOffset * this.props.charScaleFactor,\r\n                itd.width * this.props.charScaleFactor,\r\n                itd.height * this.props.charScaleFactor);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @description Draws the character image, along with a 1px border using the specified color.\r\n     * @remarks https://stackoverflow.com/questions/28207232/draw-border-around-nontransparent-part-of-image-on-canvas\r\n     * Something to note about this algorith; it can only draw borders of a thickness equal to the smallest\r\n     * outlying pixel. So, our resolution for pixels on this canvas is '4', which means that the thickness\r\n     * must be 4, or else we end up with weird stamping artifacts.\r\n     */\r\n    private async DrawCharacterBorder() {\r\n        let charStagingCanvas: HTMLCanvasElement = this.refs.characterStagingCanvas as HTMLCanvasElement;\r\n        let charCanvas: HTMLCanvasElement = this.refs.characterCanvas as HTMLCanvasElement;\r\n        let canvasContext: CanvasRenderingContext2D = charCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        // Get the character staging image. This is our character image that is drawn layer-by-layer. We\r\n        // 'stamp' this image 8 times in a circle to populate each pixel that we plan to use as a border.\r\n        let charImg: HTMLImageElement = await new Promise<HTMLImageElement>(resolve => {\r\n            let charImgSrc: string = charStagingCanvas.toDataURL('image/png');\r\n            let char: HTMLImageElement = new Image();\r\n            char.onload = () => resolve(char)\r\n            char.src = charImgSrc;\r\n        });\r\n\r\n        // First, wipe the canvas. This needs to be cleared every time we re-render and re-draw.\r\n        canvasContext.clearRect(0, 0, charCanvas.width, charCanvas.height);\r\n\r\n        for (let i: number = 0; i < CharacterImageCanvas.borderCoordinates.length; i += 2) {\r\n            let thicknessScale: number =  this.props.charScaleFactor;\r\n            let xCoord: number = CharacterImageCanvas.borderCoordinates[i];\r\n            let yCoord: number = CharacterImageCanvas.borderCoordinates[i + 1];\r\n\r\n            canvasContext.drawImage(charImg, xCoord * thicknessScale, yCoord * thicknessScale);\r\n        }\r\n\r\n        canvasContext.globalCompositeOperation = \"source-in\";\r\n        canvasContext.fillStyle = this.props.borderColor;\r\n        canvasContext.fillRect(0, 0, charCanvas.width, charCanvas.height);\r\n        canvasContext.globalCompositeOperation = \"source-over\";\r\n    }\r\n\r\n    /**\r\n     * @description Draws the character image, along with a 1px border using the specified color.\r\n     * @remarks https://stackoverflow.com/questions/28207232/draw-border-around-nontransparent-part-of-image-on-canvas\r\n     * Something to note about this algorith; it can only draw borders of a thickness equal to the smallest\r\n     * outlying pixel. So, our resolution for pixels on this canvas is '4', which means that the thickness\r\n     * must be 4, or else we end up with weird stamping artifacts.\r\n     */\r\n    private async DrawCharacterWithEffects() {\r\n        let charStagingCanvas: HTMLCanvasElement = this.refs.characterStagingCanvas as HTMLCanvasElement;\r\n        let borderCanvas: HTMLCanvasElement = this.refs.characterCanvas as HTMLCanvasElement;\r\n        let effectsCanvas: HTMLCanvasElement = this.refs.characterEffectsCanvas as HTMLCanvasElement;\r\n        let effectsCanvasContext: CanvasRenderingContext2D = effectsCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n\r\n        let shadowImg: HTMLImageElement = await new Promise<HTMLImageElement>(resolve => {\r\n            let shadowImgSrc: string = CharacterImageMap.CharacterShadowSource;\r\n            let shadow: HTMLImageElement = new Image();\r\n            shadow.onload = () => resolve(shadow);\r\n            shadow.src = shadowImgSrc;\r\n        });\r\n\r\n        let charBorderImg: HTMLImageElement = await new Promise<HTMLImageElement>(resolve => {\r\n            let charBorderImgSrc: string = borderCanvas.toDataURL('image/png');\r\n            let border: HTMLImageElement = new Image();\r\n            border.onload = () => resolve(border);\r\n            border.src = charBorderImgSrc;\r\n        });\r\n\r\n        let charImg: HTMLImageElement = await new Promise<HTMLImageElement>(resolve => {\r\n            let charImgSrc: string = charStagingCanvas.toDataURL('image/png');\r\n            let char: HTMLImageElement = new Image();\r\n            char.onload = () => resolve(char);\r\n            char.src = charImgSrc;\r\n        });\r\n\r\n        // First, wipe the canvas. This needs to be cleared every time we re-render and re-draw.\r\n        effectsCanvasContext.clearRect(0, 0, effectsCanvas.width, effectsCanvas.height);\r\n\r\n        // Draw the shadow underneath a character's feet first. This puts it as far in the background as\r\n        // possible.\r\n        effectsCanvasContext.drawImage(\r\n            shadowImg,\r\n            0,\r\n            CharacterImageCanvas.shadowOffset * this.props.charScaleFactor,\r\n            shadowImg.width * this.props.charScaleFactor,\r\n            shadowImg.height * this.props.charScaleFactor\r\n            );\r\n\r\n        effectsCanvasContext.drawImage(charBorderImg, 0, 0);\r\n        effectsCanvasContext.drawImage(charImg, 0, 0);\r\n    }\r\n}\r\n","export enum CharacterSize\r\n{\r\n    Average = 'Size_Average'\r\n}","import React from 'react';\r\nimport { CharImageDownloadCallback } from '../Types/CharImageDownloadCallback';\r\nimport { BorderSelectionCallback } from '../Types/BorderSelectionCallback';\r\nimport { CharacterImageCanvas } from './CharacterImageCanvas';\r\nimport { ColorResult, CirclePicker } from 'react-color';\r\n\r\n/**\r\n * @description The properties for this class.\r\n * @param imagesToRender A list of images that will be rendered in-order, in the drawing area. Note that the\r\n * order of this array determines how images will be drawn.\r\n * @param downloadCallback A callback when the download button is clicked in this component.\r\n */\r\nexport interface ICharacterDrawingAreaProps {\r\n    showLoadingSpinner: boolean;\r\n    imagesToRender: string[];\r\n    downloadCallback: CharImageDownloadCallback;\r\n    borderCallback: BorderSelectionCallback;\r\n    borderColor: string;\r\n}\r\n\r\n/**\r\n * @description The state for this class.\r\n * @param borderColor A css-style-string used to color the border for the character. This will come from the\r\n * circle color picker.\r\n * @param downloadUrl A data url that will be used when providing the callback for the download button.\r\n */\r\nexport interface ICharacterDrawingAreaState {\r\n    downloadUrl: string;\r\n}\r\n\r\n/**\r\n * A high-level container for the character drawing area. Contains the border color controls, the download\r\n * button and the character canvas.\r\n */\r\nexport class CharacterDrawingArea extends React.Component<ICharacterDrawingAreaProps, ICharacterDrawingAreaState> {\r\n    private static outlineColorOptions =\r\n    [\r\n        '#131313',\r\n        '#ffffff',\r\n        '#c42430',\r\n        '#ffeb57',\r\n        '#5ac54f',\r\n        '#0cf1ff'\r\n    ];\r\n\r\n    /**\r\n     * @description Creates a new instance of this class.\r\n     * @param props The provided properties for this class.\r\n     */\r\n    public constructor(props: ICharacterDrawingAreaProps) {\r\n        super(props);\r\n        this.state = {\r\n            downloadUrl: \"\"\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description Renders this component.\r\n     */\r\n    public render() {\r\n        return (\r\n            <div className=\"character-drawing-area\">\r\n                <CharacterImageCanvas\r\n                    charScaleFactor={4}\r\n                    showLoadingSpinner={this.props.showLoadingSpinner}\r\n                    ref=\"charImageCanvas\"\r\n                    imagesToRender={this.props.imagesToRender}\r\n                    borderColor={this.props.borderColor}\r\n                />\r\n                <span className=\"character-drawing-label\">\r\n                    Border Color\r\n                </span>\r\n                <CirclePicker\r\n                    onChangeComplete={this.handleColorChange.bind(this)}\r\n                    color={this.props.borderColor}\r\n                    colors={CharacterDrawingArea.outlineColorOptions}\r\n                />\r\n                <button className=\"character-image-download\"\r\n                    onClick={() => this.props.downloadCallback(this.fetchDownloadUrl())}>\r\n                    &gt;&gt;Download&lt;&lt;\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n\r\n    private handleColorChange(color: ColorResult): void {\r\n        this.props.borderCallback(color.hex);\r\n    }\r\n\r\n    private fetchDownloadUrl(): string {\r\n        let charImgCanvas: CharacterImageCanvas = this.refs.charImageCanvas as CharacterImageCanvas;\r\n        let downloadUrl = charImgCanvas.GetDownloadUrl();\r\n\r\n        return downloadUrl;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport '../CharacterImage.css';\r\n\r\nimport { PartSelector } from './PartSelector';\r\nimport { CharacterDrawingArea } from './CharacterDrawingArea';\r\n\r\nimport { CharacterImageMap } from '../Classes/CharacterImageMap';\r\nimport { CharImageLayout } from '../Classes/CharImageLayout';\r\n\r\nimport { CharacterSize } from '../Enums/CharacterSize';\r\nimport { PartType } from '../Enums/PartType';\r\nimport { BodyType } from '../Enums/BodyType';\r\n\r\nimport { BodyTypeSelectionCallback } from '../Types/BodyTypeSelectionCallback';\r\nimport { PartTypeSelectionCallback } from '../Types/PartTypeSelectionCallback';\r\nimport { PartSelectionCallback } from '../Types/PartSelectionCallback';\r\nimport { CharImageDownloadCallback } from '../Types/CharImageDownloadCallback';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { UserDataAuth } from '../../FirebaseAuth/Classes/UserDataAuth';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\n\r\n/**\r\n * @description\r\n * The interface for props passed to this object. This class in particular takes no props; it is effectively\r\n * the app itself.\r\n */\r\nexport interface ICharacterImageProps {\r\n};\r\n\r\n/**\r\n * @description\r\n * The interface for the internal state maintained by this object.\r\n * @param canvasImages The list of image sources, represented as strings, that will be rendered using the\r\n * Canvas class.\r\n * @param partLayers A list of image layers. This contains information about all of the possible layers that\r\n * can be drawn to the currently-selected body type. This contains information about what each layer is, how\r\n * that layer is drawn, and what the possible images are in that layer.\r\n */\r\nexport interface ICharacterImageState {\r\n    charSize: CharacterSize;\r\n    partType: PartType;\r\n    charImageLayout: CharImageLayout;\r\n    checkingForCharacterImage: boolean;\r\n    borderStyle: string;\r\n};\r\n\r\n/**\r\n * @description The main entry point for the character drawing application. Provides all of the buttons and\r\n * fun stuff needed to create a character image on a canvas element.\r\n */\r\nexport class CharacterImage extends React.Component<ICharacterImageProps, ICharacterImageState> {\r\n    private handlePartTypeChange(partType: PartType) {\r\n        this.setState({\r\n            partType: partType\r\n        });\r\n    }\r\n\r\n    private handleBodyTypeChange(bodyType: BodyType) {\r\n        let charImageLayout: CharImageLayout = new CharImageLayout(new Map<PartType, string>(), bodyType);\r\n\r\n        if (CharacterImageMap.DefaultBodyParts.has(bodyType)) {\r\n            charImageLayout = CharacterImageMap.DefaultBodyParts.get(bodyType) as CharImageLayout;\r\n        }\r\n\r\n        this.setState({\r\n            charImageLayout: charImageLayout\r\n        });\r\n    }\r\n\r\n    private handlePartSelection(partType: PartType, imgSource: string): void {\r\n        let charImgLayout = this.state.charImageLayout;\r\n        charImgLayout.SetPartImage(partType, imgSource);\r\n\r\n        this.setState({\r\n            charImageLayout: charImgLayout\r\n        });\r\n        \r\n        CharacterStateManager.GetInstance().GetCharacter()\r\n            .then(charData => {\r\n                if (charData !== undefined) {\r\n                    charData.CharLayout = this.state.charImageLayout;\r\n                    \r\n                    CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n                }\r\n            });\r\n    }\r\n\r\n    private handleBorderSelection(borderStyle: string): void {\r\n        this.setState({\r\n            borderStyle: borderStyle\r\n        });\r\n\r\n        CharacterStateManager.GetInstance().GetCharacter()\r\n            .then(charData => {\r\n                if (charData !== undefined) {\r\n                    charData.BorderColor = borderStyle;\r\n\r\n                    CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n                }\r\n            });\r\n    }\r\n\r\n    private handleCanvasDownload(downloadSource: string): void {\r\n        if (downloadSource === undefined || downloadSource === \"\") {\r\n            console.error(\"Character image was attempted to be downloaded with an empty, unset string.\");\r\n        }\r\n        else {\r\n            let link = document.createElement('a');\r\n\r\n            link.download = 'characterImage.png';\r\n            link.href = downloadSource;\r\n            link.click();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description Creates a new instance of this component.\r\n     * @param props Higher-order properties passed in to this component.\r\n     */\r\n    public constructor(props: ICharacterImageProps) {\r\n        super(props);\r\n        this.state = {\r\n            charSize: CharacterSize.Average,\r\n            partType: PartType.Body,\r\n            charImageLayout: new CharImageLayout(new Map(), BodyType.AverageSizedFeminine),\r\n            checkingForCharacterImage: true,\r\n            borderStyle: \"#131313\"\r\n        }\r\n        this.CheckForCharacterImage();\r\n\r\n    }\r\n\r\n    private async CheckForCharacterImage() {\r\n        let charData: PlayerCharacterData | undefined = undefined;\r\n\r\n        // Check to see if we have some character data we can load for this person. If so, update the current\r\n        // layers so someone can modify their character!\r\n        let userHasAccount: boolean = await UserDataAuth.GetInstance().CheckForAccess();\r\n        if (userHasAccount) {\r\n            charData = await CharacterStateManager.GetInstance().GetCharacter();\r\n        }\r\n\r\n        if (charData !== undefined) {\r\n            console.log(charData);\r\n            this.setState({\r\n                charImageLayout: charData.CharLayout,\r\n                checkingForCharacterImage: false,\r\n                borderStyle: charData.BorderColor\r\n            });\r\n        }\r\n        else {\r\n            console.log(\"Could not load char data\");\r\n            this.setState({\r\n                charImageLayout: CharacterImageMap.DefaultBodyParts.get(BodyType.AverageSizedFeminine) as CharImageLayout,\r\n                checkingForCharacterImage: false\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description\r\n     * Renders a series of body selectors for the user to pick from. These body selectors will modify the list\r\n     * of available accessories (since a tiny hat looks silly on a giant person . . . or does it?). Needs to\r\n     * look at the BodyMap.tsx file to understand what will be populated.\r\n     */\r\n    public renderBodySelection() {\r\n        return (<div></div>);\r\n    }\r\n\r\n    /**\r\n     * @description Renders this component.\r\n     */\r\n    public render() {\r\n        let imagePaths = CharacterImageMap.GetCharacterImagePaths(\r\n            this.state.charSize,\r\n            this.state.charImageLayout.BodyType,\r\n            this.state.partType);\r\n        \r\n        let partTypeTabSelection: PartTypeSelectionCallback = (partType: PartType) => {\r\n            this.handlePartTypeChange(partType);\r\n        };\r\n\r\n        let bodyTypeTabSelection: BodyTypeSelectionCallback = (bodyType: BodyType) => {\r\n            this.handleBodyTypeChange(bodyType);\r\n        };\r\n\r\n        let partSelection: PartSelectionCallback = (partType: PartType, imgSource: string) => {\r\n            this.handlePartSelection(partType, imgSource);\r\n        };\r\n\r\n        let canvasDownload: CharImageDownloadCallback = (downloadSource: string) => {\r\n            this.handleCanvasDownload(downloadSource);\r\n        };\r\n\r\n        let charImages: string[] = this.state.charImageLayout.GetImages();\r\n        console.log(`Render called with images: ${charImages}`);\r\n\r\n        return (\r\n            <div className=\"character-image\">\r\n                <CharacterDrawingArea\r\n                    borderColor={this.state.borderStyle}\r\n                    showLoadingSpinner={this.state.checkingForCharacterImage}\r\n                    imagesToRender={charImages}\r\n                    downloadCallback={canvasDownload.bind(this)}\r\n                    borderCallback={this.handleBorderSelection.bind(this)}\r\n                />\r\n                <PartSelector\r\n                    partSelectionCallback={partSelection.bind(this)}\r\n                    bodyTypeSelectionCallback={bodyTypeTabSelection.bind(this)}\r\n                    partTypeSelectionCallback={partTypeTabSelection.bind(this)}\r\n                    partType={this.state.partType}\r\n                    partOptions={imagePaths}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Spinner } from 'react-bootstrap';\r\n\r\ninterface ILoadingPlaceholderProps {\r\n    showSpinner: boolean;\r\n    role: string;\r\n}\r\n\r\ninterface ILoadingPlaceholderState {\r\n}\r\n\r\nexport class LoadingPlaceholder extends React.Component<ILoadingPlaceholderProps, ILoadingPlaceholderState> {\r\n    public constructor(props: ILoadingPlaceholderProps) {\r\n        super(props);\r\n        this.state = {\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let placeholderSpinner: JSX.Element = (\r\n            <Spinner\r\n                className=\"placeholder-spinner\"\r\n                animation=\"border\"\r\n                role={this.props.role}\r\n            />\r\n        );\r\n\r\n        if (this.props.showSpinner) {\r\n            return placeholderSpinner;\r\n        }\r\n        else {\r\n            return(\r\n                this.props.children\r\n            )\r\n        }\r\n    }\r\n}\r\n","import '../css/StylizedModal.css';\r\n\r\nimport React from 'react';\r\nimport { Modal } from 'react-bootstrap';\r\n\r\nimport { LoadingPlaceholder } from './LoadingPlaceholder';\r\n\r\ninterface IStylizedModalProps {\r\n    show: boolean;\r\n    onHide: () => void;\r\n    onEnterModal: (() => void) | undefined;\r\n    title: string;\r\n    isLoading: boolean;\r\n}\r\n\r\ninterface IStylizedModalState {\r\n}\r\n\r\nexport class StylizedModal extends React.Component<IStylizedModalProps, IStylizedModalState> {\r\n    public constructor(props: IStylizedModalProps) {\r\n        super(props);\r\n        this.state = {\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <Modal\r\n                show={this.props.show}\r\n                onHide={this.props.onHide}\r\n                centered={true}\r\n                onEntering={this.props.onEnterModal}>\r\n                <Modal.Header>\r\n                    <Modal.Title>\r\n                        {this.props.title}\r\n                    </Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <LoadingPlaceholder\r\n                        showSpinner={this.props.isLoading}\r\n                        role={`${this.props.title} Loading Status`}>\r\n                        {this.props.children}\r\n                    </LoadingPlaceholder>\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <button\r\n                        className=\"negative-button\"\r\n                        onClick={this.props.onHide}>\r\n                        Close\r\n                    </button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\n","export class MoneyConverter {\r\n    private _platinum: number = 0;\r\n    private _gold: number = 0;\r\n    private _silver: number = 0;\r\n    private _copper: number = 0;\r\n\r\n    public get Platinum() {\r\n        return this._platinum;\r\n    }\r\n\r\n    public get Gold() {\r\n        return this._gold;\r\n    }\r\n\r\n    public get Silver() {\r\n        return this._silver;\r\n    }\r\n\r\n    public get Copper() {\r\n        return this._copper;\r\n    }\r\n\r\n    public constructor(playerCopper: number) {\r\n        this._platinum  = Math.floor(playerCopper / 1000);\r\n        this._gold      = Math.floor((playerCopper % 1000) / 100);\r\n        this._silver    = Math.floor((playerCopper % 100) / 10);\r\n        this._copper    = playerCopper % 10;\r\n    }\r\n}\r\n","import \"../MoneyDisplay.css\";\r\n\r\nimport React from 'react';\r\nimport { MoneyConverter } from '../../Inventory/Classes/MoneyConverter';\r\n\r\ninterface IMoneyDisplayProps {\r\n    copperCount: number;\r\n    hideEmptyCurrencies: boolean;\r\n}\r\n\r\ninterface IMoneyDisplayState {\r\n}\r\n\r\nexport class MoneyDisplay extends React.Component<IMoneyDisplayProps, IMoneyDisplayState> {\r\n    public constructor(props: IMoneyDisplayProps) {\r\n        super(props);\r\n        this.state = {\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"character-money-display\">\r\n                {this.GetMoneyColumns()}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private GetMoneyColumns(): JSX.Element[] {\r\n        let elements: JSX.Element[] = [];\r\n        let moneyCount: MoneyConverter = new MoneyConverter(this.props.copperCount);\r\n\r\n        if (moneyCount.Platinum > 0 || !this.props.hideEmptyCurrencies) {\r\n            elements.push(\r\n                <div key=\"platinum\" className=\"money-column\">\r\n                    <img\r\n                        alt=\"money icon\"\r\n                        className='money-icon'\r\n                        src='./images/Inventory/Coin_Platinum.png' />\r\n                    {moneyCount.Platinum}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (moneyCount.Gold > 0 || !this.props.hideEmptyCurrencies) {\r\n            elements.push(\r\n                <div key=\"gold\" className=\"money-column\">\r\n                    <img\r\n                        alt=\"money icon\"\r\n                        className='money-icon'\r\n                        src='./images/Inventory/Coin_Gold.png' />\r\n                    {moneyCount.Gold}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (moneyCount.Silver > 0 || !this.props.hideEmptyCurrencies) {\r\n            elements.push(\r\n                <div key=\"silver\" className=\"money-column\">\r\n                    <img\r\n                        alt=\"money icon\"\r\n                        className='money-icon'\r\n                        src='./images/Inventory/Coin_Silver.png' />\r\n                    {moneyCount.Silver}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (moneyCount.Copper > 0 || !this.props.hideEmptyCurrencies) {\r\n            elements.push(\r\n                <div key=\"copper\" className=\"money-column\">\r\n                    <img\r\n                        alt=\"money icon\"\r\n                        className='money-icon'\r\n                        src='./images/Inventory/Coin_Copper.png' />\r\n                    {moneyCount.Copper}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return elements;\r\n    }\r\n}\r\n","import '../css/ItemDetailsModal.css';\r\n\r\nimport React, { useState } from 'react';\r\nimport { RemoveClick } from '../Types/CardButtonCallbackTypes/RemoveClick';\r\nimport { IItem } from '../Interfaces/IItem';\r\n\r\ninterface IRemoveButtonProps {\r\n    item: IItem;\r\n    // cardIconSize: number;\r\n    callbackFunction: RemoveClick;\r\n}\r\n\r\nexport function RemoveButton(props: IRemoveButtonProps) {\r\n    const [readyToDelete, setReadyToDelete] = useState(false);\r\n    const [startedDelete, setStartedToDelete] = useState(false);\r\n    const [progressTimeout, setProgressTimeout] = useState<NodeJS.Timeout>();\r\n\r\n    function HandleMouseDown(event: React.MouseEvent) {\r\n        let interval: NodeJS.Timeout = setTimeout(() => {\r\n            setReadyToDelete(true);\r\n        }, 2000);\r\n        \r\n        setStartedToDelete(true);\r\n        setProgressTimeout(interval);\r\n    }\r\n\r\n    function HandleMouseUp(event: React.MouseEvent) {\r\n        setStartedToDelete(false);\r\n\r\n        if (readyToDelete) {\r\n            props.callbackFunction(props.item);\r\n            setReadyToDelete(false);\r\n        }\r\n        if (progressTimeout) {\r\n            clearInterval(progressTimeout);\r\n        }\r\n    }\r\n\r\n    function HandleMouseLeave(event: React.MouseEvent) {\r\n        setReadyToDelete(false);\r\n        setStartedToDelete(false);\r\n\r\n        if (progressTimeout) {\r\n            clearInterval(progressTimeout);\r\n        }\r\n    }\r\n\r\n    function GetProgressBar(): JSX.Element {\r\n        let content: JSX.Element = (<div/>);\r\n\r\n        if (startedDelete) {\r\n            content = (<div className=\"card-button-progress-bar-red\" />);\r\n        }\r\n\r\n        return content;\r\n    }\r\n\r\n    let buttonText = readyToDelete ? \"Release to delete\" : \"Drop Item (Press & Hold)\";\r\n\r\n    return (\r\n        <button\r\n            className=\"card-button-remove negative-button\"\r\n            onMouseDown={HandleMouseDown}\r\n            onMouseUp={HandleMouseUp}\r\n            onMouseLeave={HandleMouseLeave}\r\n            >\r\n\r\n            {GetProgressBar()}\r\n            <div className={startedDelete ? \"card-button-progress-bar-red\" : \"\"}/>\r\n            <div className={`card-button-remove-name ${startedDelete ? \"card-button-name-warn\" : \"\"}`}>\r\n                {buttonText}\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n","import '../css/ItemDetailsModal.css';\r\nimport '../css/DamageType.css'\r\n\r\nimport React, { ChangeEvent } from 'react';\r\nimport { IItem } from '../Interfaces/IItem';\r\nimport { SourceType } from '../Enums/SourceType';\r\nimport { StylizedModal } from '../../Utilities/React/StylizedModal';\r\nimport { MoneyDisplay } from '../../CharacterInfo/React/MoneyDisplay';\r\nimport { RemoveClick } from '../Types/CardButtonCallbackTypes/RemoveClick';\r\nimport { RemoveButton } from './RemoveButton';\r\n\r\ninterface IItemDetailsModalState {\r\n    showAlert: boolean;\r\n}\r\n\r\ninterface IItemDetailsModalProps {\r\n    show: boolean;\r\n    hideModal: () => void;\r\n    itemDetails: IItem;\r\n    removeCallback: RemoveClick | undefined;\r\n    handleUpdatedItemNotes: ((event: ChangeEvent<HTMLTextAreaElement>) => void) | undefined;\r\n}\r\n\r\nexport class ItemDetailsModal extends React.Component<IItemDetailsModalProps, IItemDetailsModalState> {\r\n    /**\r\n     * @description Performs an enum-<p> lookup to get something nice and pixelated to represent the source\r\n     * of the item that is being displayed.\r\n     * @param source The source to lookup and return a <p> element that represents it.\r\n     */\r\n    private getSourceText(source: SourceType) {\r\n        switch (source) {\r\n            case \"Official\":\r\n                {\r\n                    return (<p style={{ color: 'rgb(255, 200, 37)' }}>Official</p>);\r\n                }\r\n            case \"Homebrew\":\r\n                {\r\n                    return (<p style={{ color: 'rgb(147, 56, 143)' }}>Homebrew</p>);\r\n                }\r\n        };\r\n    }\r\n\r\n\r\n    public constructor(props: IItemDetailsModalProps) {\r\n        super(props);\r\n        this.state = {\r\n            showAlert: false\r\n        };\r\n    }\r\n\r\n    render() {\r\n        let removeButton = (<div/>);\r\n        if (this.props.removeCallback) {\r\n            removeButton = (\r\n                <RemoveButton\r\n                    item={this.props.itemDetails}\r\n                    callbackFunction={this.props.removeCallback}\r\n                />\r\n            )\r\n        }\r\n\r\n        let showNotes = this.props.handleUpdatedItemNotes !== undefined;\r\n        let noteArea = (<div />);\r\n\r\n        if (showNotes) {\r\n            noteArea = (\r\n                <textarea\r\n                    className=\"item-description-notes\"\r\n                    placeholder=\"It's a note! Shhh, it's a secret note.\"\r\n                    onChange={this.props.handleUpdatedItemNotes}>\r\n                    {this.props.itemDetails.adjustments.notes}\r\n                </textarea>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <StylizedModal\r\n                show={this.props.show}\r\n                onHide={this.props.hideModal}\r\n                title={this.props.itemDetails.title}\r\n                isLoading={false}\r\n                onEnterModal={undefined}>\r\n                <div className='item-preview'>\r\n                    <img src={this.props.itemDetails.iconSource} width={128} height={128} alt=\"item preview\" />\r\n                </div>\r\n                <hr className='white-hr' />\r\n                <div className='item-details pixel-font'>\r\n                    <div className='item-tag'>\r\n                        {this.getSourceText(this.props.itemDetails.source)}\r\n                    </div>\r\n                    <MoneyDisplay\r\n                        copperCount={this.props.itemDetails.itemCopperCost}\r\n                        hideEmptyCurrencies={true}\r\n                    />\r\n                    <div className='item-tag' style={this.props.itemDetails.GetItemTextStyle()}>\r\n                        {this.props.itemDetails.type}\r\n                    </div>\r\n                </div>\r\n                <hr className='white-hr' />\r\n                {this.props.itemDetails.RenderItemDescription()}\r\n                <hr className='white-hr' />\r\n                {noteArea}\r\n                {removeButton}\r\n            </StylizedModal>\r\n        );\r\n    }\r\n}\r\n","import '../css/AttackRollModal.css'\r\n\r\nimport React from 'react';\r\nimport { Attack } from '../Classes/Attack';\r\nimport { DamageType } from '../Enums/DamageType';\r\nimport { StylizedModal } from '../../Utilities/React/StylizedModal';\r\nimport { DTwenty } from './DTwenty';\r\n\r\ntype DamageRoll = {\r\n    damageType: DamageType;\r\n    rolledNumbers: number[];\r\n    modifier: number;\r\n}\r\n\r\nenum RollType {\r\n    Advantage,\r\n    Disadvantage,\r\n    Regular\r\n}\r\n\r\ninterface IAttackRollModalState {\r\n    /**\r\n     * The damage values that have been rolled from using this modal.\r\n     */\r\n    damageRoll: DamageRoll[];\r\n\r\n    /**\r\n     * The current die faces that are shown to the user. This will change rapidly while rolling.\r\n     */\r\n    dieFaces: number[];\r\n\r\n    /**\r\n     * The type of roll that is performed. This will be adv/disadv/etc.\r\n     */\r\n    rollType: RollType;\r\n\r\n    /**\r\n     * If true, the modal is currently rolling die. Prevents some components from rendering.\r\n     */\r\n    isRolling: boolean;\r\n\r\n    /**\r\n     * The final die value. This will be a single number, if one exists.\r\n     */\r\n    finalDieValue: number | undefined;\r\n}\r\n\r\ninterface IAttackRollModalProps {\r\n    /**\r\n     * If true, show this modal.\r\n     */\r\n    show: boolean;\r\n\r\n    /**\r\n     * The name of the attack to display in the title bar.\r\n     */\r\n    attackName: string;\r\n\r\n    /**\r\n     * A series of attack values to compute damage for.\r\n     */\r\n    attacks: Attack[];\r\n\r\n    /**\r\n     * A callback for when the user requests that this modal be closed.\r\n     */\r\n    onHide: () => void;\r\n}\r\n\r\n/**\r\n * A modal containing a dice rolling module. Computes random numbers for the attack as well as for the damage\r\n * of the provided item.\r\n */\r\nexport class AttackRollModal extends React.Component<IAttackRollModalProps, IAttackRollModalState> {\r\n    /**\r\n     * Generating a bunch of random numbers on the fly, in quick succession, is somewhat expensive, so \r\n     * intead use some pre-generated lists of numbers to flash at someone as the dice is being rolled.\r\n     */\r\n    private static readonly randomD20Numbers: number[] = [\r\n        8, 17, 4, 7, 2, 6, 11, 16, 1, 12, 15, 10, 18, 19, 5, 3, 14, 9, 13, 20,\r\n        17, 4, 3, 10, 2, 14, 11, 19, 18, 5, 13, 20, 7, 16, 9, 6, 1, 15, 12, 8,\r\n        12, 4, 6, 18, 15, 17, 19, 13, 14, 8, 7, 3, 9, 2, 16, 10, 1, 5, 20, 11,\r\n        9, 8, 16, 13, 6, 15, 3, 2, 10, 4, 18, 7, 5, 1, 17, 12, 20, 19, 14, 11,\r\n        4, 7, 2, 19, 10, 1, 6, 5, 13, 18, 8, 17, 14, 15, 11, 3, 20, 12, 16, 9,\r\n        20, 5, 19, 9, 12, 16, 4, 10, 2, 17, 8, 15, 6, 7, 11, 1, 13, 3, 18, 14,\r\n        17, 15, 14, 1, 16, 4, 20, 18, 19, 6, 8, 10, 9, 3, 13, 12, 2, 11, 7, 5,\r\n        4, 2, 18, 9, 13, 20, 7, 1, 10, 8, 14, 16, 19, 15, 5, 11, 6, 17, 12, 3,\r\n        6, 8, 14, 18, 7, 17, 20, 15, 11, 5, 2, 16, 3, 19, 12, 4, 10, 9, 13, 1,\r\n        7, 20, 9, 8, 13, 19, 6, 15, 14, 18, 5, 3, 2, 12, 11, 1, 10, 17, 4, 16,\r\n    ]\r\n\r\n    private static readonly dieFrameLength: number = 50;\r\n    private static readonly suspenseLength: number = 600;\r\n\r\n    private static readonly rollDieAudio = new Audio(\"./sounds/rollDie.wav\");\r\n    private static readonly roll20Audio = new Audio(\"./sounds/roll20.wav\");\r\n    private static readonly roll1Audio = new Audio(\"./sounds/roll1.wav\");\r\n    private static readonly rollStopAudio: HTMLAudioElement = new Audio(\"./sounds/rollStop.wav\");\r\n    private static readonly rollResultAudio = new Audio(\"./sounds/rollResult.wav\");\r\n\r\n    /**\r\n     * Creates a new instance of this object.\r\n     * @param props A series of properties to pass to construct this object.\r\n     */\r\n    public constructor(props: IAttackRollModalProps) {\r\n        super(props);\r\n        this.state = {\r\n            damageRoll: [],\r\n            dieFaces: [],\r\n            rollType: RollType.Regular,\r\n            isRolling: false,\r\n            finalDieValue: undefined\r\n        };\r\n\r\n        AttackRollModal.roll1Audio.volume = 0.1;\r\n        AttackRollModal.roll20Audio.volume = 0.25;\r\n        AttackRollModal.rollDieAudio.volume = 0.25;\r\n        AttackRollModal.rollResultAudio.volume = 0.1;\r\n        AttackRollModal.rollStopAudio.volume = 0.1;\r\n    }\r\n\r\n    public render() {\r\n        // SVG Generated with:\r\n        // https://codepen.io/wvr/pen/WrNgJp\r\n\r\n        const rollAdvantage     = () => this.HandleRollDie(2, RollType.Advantage);\r\n        const rollDisadvantage  = () => this.HandleRollDie(2, RollType.Disadvantage);\r\n        const rollRegular       = () => this.HandleRollDie(1, RollType.Regular);\r\n\r\n        return (\r\n            <StylizedModal\r\n                show={this.props.show}\r\n                onHide={this.props.onHide}\r\n                onEnterModal={undefined}\r\n                title={this.props.attackName}\r\n                isLoading={false}>\r\n                <div className=\"roll-window-image\">\r\n                    <img\r\n                        alt=\"Dice Rolling\"\r\n                        src=\"./images/Item_Shop/RollImage.png\"\r\n                    />\r\n                </div>\r\n                <hr className='white-hr' />\r\n                <div className=\"attack-results-container\">\r\n                    <h5>Attack</h5>\r\n                    <div className=\"attack-die-container\">\r\n                        {this.GetDiceDisplay()}\r\n                    </div>\r\n                    <div className=\"attack-die-total\">\r\n                        {this.GetTotalRollTextDisplay()}\r\n                    </div>\r\n                    <div className=\"roll-window-damage\">\r\n                        {this.GetDamageRollDisplay()}\r\n                    </div>\r\n                </div>\r\n                <div className=\"roll-window-buttons\">\r\n                    <button\r\n                        disabled={this.state.isRolling}\r\n                        className=\"roll-window-button negative-button\"\r\n                        onClick={rollDisadvantage.bind(this)}>\r\n                        With Disadvantage\r\n                    </button>\r\n                    <button\r\n                        disabled={this.state.isRolling}\r\n                        className=\"roll-window-button\"\r\n                        onClick={rollRegular.bind(this)}>\r\n                        Regular Roll\r\n                    </button>\r\n                    <button\r\n                        disabled={this.state.isRolling}\r\n                        className=\"roll-window-button positive-button\"\r\n                        onClick={rollAdvantage.bind(this)}>\r\n                        With Advantage\r\n                    </button>\r\n                </div>\r\n            </StylizedModal>\r\n        )\r\n    }\r\n\r\n    /**\r\n     * Gets a random number between 1 and the provided number.\r\n     * @param randomLimit The highest value to roll.\r\n     */\r\n    private GetRandomNumber(randomLimit: number): number {\r\n        return Math.ceil(Math.random() * (randomLimit));\r\n    }\r\n\r\n    /**\r\n     * Get a series of numbers to show for each die. The result will be a series of \r\n     * @param randomIndex The starting point in the random number array to use to represent the random numbers\r\n     * that flash on each die.\r\n     * @param dieIndex The 0-based index for this particular die. For example, if we are rolling two die, the\r\n     * first die's index will be '0', the second, '1'. This is used to stagger dice rolls.\r\n     * @param finalValue The final value to show on the die once it has finished rolling.\r\n     * @returns A series of dice \"frames\". Duplicate frames are added towards the end of the roll sequence to\r\n     * mimic the dice slowing to a halt.\r\n     */\r\n    private PopulateRollNumbers(randomIndex: number, dieIndex: number, finalValue: number): number[] {\r\n        let rollTimer: number[] = [];\r\n\r\n        let standardFastRolls: number = 10;\r\n        let standardMedmRolls: number = 8;\r\n        let standardSlowRolls: number = 2;\r\n        let standardSnailRolls: number = 1;\r\n\r\n        let extraDieRolls: number = 8 * dieIndex;\r\n\r\n        // This is used to offset the initial roll with a 'cascading' effect of rolls.\r\n        randomIndex = this.GetRandomRollSequence(rollTimer, extraDieRolls, 1, randomIndex);\r\n        randomIndex = this.GetRandomRollSequence(rollTimer, standardFastRolls, 1, randomIndex);\r\n        randomIndex = this.GetRandomRollSequence(rollTimer, standardMedmRolls, 2, randomIndex);\r\n        randomIndex = this.GetRandomRollSequence(rollTimer, standardSlowRolls, 6, randomIndex);\r\n        randomIndex = this.GetRandomRollSequence(rollTimer, standardSnailRolls, 10, randomIndex);\r\n\r\n        rollTimer.push(finalValue);\r\n\r\n        return rollTimer;\r\n    }\r\n\r\n    /**\r\n     * Gets a series of random numbers to flash on the screen while each die rolls.\r\n     * @param rollArray The existing list of roll frames. This is added to by this function. Passed by\r\n     * reference.\r\n     * @param numbersToShow A count of how many numbers should be shown while the dice is rolling.\r\n     * @param framesPerNumber The number of frames assocated with each number that is shown on the die.\r\n     * @param randomIndex This is an indexer used to point at a specific value in a list of pre-generated\r\n     * random numbers. This will be adjusted and returned as the result of this function.\r\n     * @returns The adjusted value for randomIndex. Basically, this should be passed in by-reference.\r\n     * However, typescript isn't great at boxing numbers and making those numbers immutable. It's easier to\r\n     * just return the newly adjusted randomIndex.\r\n     */\r\n    private GetRandomRollSequence(rollArray: number[], numbersToShow: number, framesPerNumber: number, randomIndex: number): number {\r\n        let randomNumberCount: number = AttackRollModal.randomD20Numbers.length - 1;\r\n\r\n        for (let i = 0; i < numbersToShow; i++) {\r\n            // Increment that index and ensure it doesn't run off the edge of our array.\r\n            randomIndex++;\r\n            randomIndex %= randomNumberCount;\r\n\r\n            let nextRandomNumber: number = AttackRollModal.randomD20Numbers[randomIndex];\r\n\r\n            for (let frameIndex: number = 0; frameIndex < framesPerNumber; frameIndex++) {\r\n                rollArray.push(nextRandomNumber);\r\n            }\r\n        }\r\n\r\n        return randomIndex;\r\n    }\r\n\r\n    /**\r\n     * Rolls the attack die. This incorporates a visual component, and will roll \"virtual\" dice on screen.\r\n     * @param dieCount The number of dice to roll.\r\n     */\r\n    private RollAttackDice(dieCount: number) {\r\n        let rolls: number[][] = [];\r\n        for (let i: number = 0; i < dieCount; i++) {\r\n            let value: number = this.GetRandomNumber(20);\r\n            let randomNumberIndex: number = this.GetRandomNumber(AttackRollModal.randomD20Numbers.length);\r\n            let rollFrames: number[] = this.PopulateRollNumbers(randomNumberIndex, i, value);\r\n\r\n            rolls.push(rollFrames);\r\n        }\r\n\r\n        let longestDieArray: number = rolls[dieCount - 1].length;\r\n        AttackRollModal.rollDieAudio.play();\r\n\r\n        for (let rollIndex = 0; rollIndex < longestDieArray; rollIndex++) {\r\n            setTimeout(() => {\r\n                let currentRolls: number[] = [];\r\n                for (let dieIndex = 0; dieIndex < rolls.length; dieIndex++) {\r\n                    let indexToGet = Math.min(rollIndex, rolls[dieIndex].length - 1);\r\n\r\n                    if (rollIndex === rolls[dieIndex].length - 1) {\r\n                        AttackRollModal.rollStopAudio.play();\r\n                    }\r\n\r\n                    currentRolls.push(rolls[dieIndex][indexToGet]);\r\n                }\r\n\r\n                this.setState({\r\n                    dieFaces: currentRolls\r\n                });\r\n\r\n                // This looks a little dumb, but it handles the final die roll effectively.\r\n                if (rollIndex === longestDieArray - 1) {\r\n                    this.FinalizeDieRoll();\r\n                }\r\n            }, AttackRollModal.dieFrameLength * rollIndex)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Rolls damage dice. This value appears after the attack dice have been rolled.\r\n     */\r\n    private RollDamageDice(): void {\r\n        let rolls: DamageRoll[] = this.props.attacks.map((attack) => {\r\n            let rolledNumbers: number[] = [];\r\n            for (let i = 0; i < attack.diceCount; i++) {\r\n                rolledNumbers.push(this.GetRandomNumber(attack.diceSize));\r\n            }\r\n\r\n            let roll: DamageRoll = {\r\n                damageType: attack.damageType,\r\n                rolledNumbers: rolledNumbers,\r\n                modifier: attack.modifier\r\n            };\r\n\r\n            return roll;\r\n        });\r\n\r\n        this.setState({\r\n            damageRoll: rolls\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles a user request to roll the attack dice.\r\n     * @param dieCount The number of dice to roll.\r\n     * @param rollType If this is a normal roll, with advantage, or with disadvantage.\r\n     */\r\n    private HandleRollDie(dieCount: number, rollType: RollType): void {\r\n        this.setState({\r\n            rollType: rollType,\r\n            isRolling: true,\r\n            finalDieValue: undefined,\r\n            damageRoll: []\r\n        })\r\n        this.RollAttackDice(dieCount);\r\n    }\r\n\r\n    /**\r\n     * Handles some of the stateful logic when our dice have finished rolling.\r\n     */\r\n    private FinalizeDieRoll(): void {\r\n        let diceValues = this.state.dieFaces;\r\n        let finalDie: number | undefined = undefined;\r\n\r\n        switch (this.state.rollType) {\r\n            case RollType.Disadvantage: {\r\n                if (diceValues.length > 0) {\r\n                    finalDie = diceValues.slice(0).sort((a, b) => a - b)[0];\r\n                }\r\n                break;\r\n            }\r\n            case RollType.Advantage: {\r\n                if (diceValues.length > 0) {\r\n                    finalDie = diceValues.slice(0).sort((a, b) => a - b).reverse()[0];\r\n                }\r\n                break;\r\n            }\r\n            case RollType.Regular: {\r\n                if (diceValues.length > 0) {\r\n                    finalDie = diceValues[0];\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        setTimeout(() => {\r\n            if (finalDie === 20) {\r\n                AttackRollModal.roll20Audio.play();\r\n            }\r\n            else if (finalDie === 1) {\r\n                AttackRollModal.roll1Audio.play();\r\n            }\r\n            else {\r\n                AttackRollModal.rollResultAudio.play();\r\n            }\r\n\r\n            this.setState({\r\n                finalDieValue: finalDie\r\n            });\r\n        }, AttackRollModal.suspenseLength);\r\n\r\n        setTimeout(() => {\r\n            AttackRollModal.rollStopAudio.play();\r\n            this.RollDamageDice();\r\n            this.setState({\r\n                isRolling: false\r\n            });\r\n        }, AttackRollModal.suspenseLength * 2);\r\n    }\r\n\r\n    /**\r\n     * Gets the final value to display for the last dice roll.\r\n     */\r\n    private GetTotalRollTextDisplay(): JSX.Element {\r\n        let finalDieText: string = \"\";\r\n\r\n        if (this.state.finalDieValue !== undefined) {\r\n            finalDieText = `${this.state.finalDieValue}`;\r\n        }\r\n\r\n        return (\r\n            <span>\r\n                {finalDieText}\r\n            </span>\r\n        )\r\n    }\r\n\r\n    /**\r\n     * Gets the attack dice visual component.\r\n     */\r\n    private GetDiceDisplay(): JSX.Element[] {\r\n        return this.state.dieFaces.map(dieFace => {\r\n            let dieColor: string = \"#891e2b\";\r\n\r\n            return (\r\n                <DTwenty\r\n                    dieFace={dieFace}\r\n                    dieColor={dieColor}\r\n                />\r\n            )\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Gets the damage roll text to display to the user.\r\n     */\r\n    private GetDamageRollDisplay(): JSX.Element[] {\r\n        return this.state.damageRoll.map((roll) => {\r\n            let rollStatement: string = \"\";\r\n\r\n            let isCrit: boolean = this.state.finalDieValue === 20;\r\n            let critModifier: string = isCrit ? \"2x\" : \"\";\r\n\r\n            let diceRollsMessage: string = roll.rolledNumbers.join(\" + \");\r\n            let rollModifierMessage: string = roll.modifier > 0 ? ` + ${roll.modifier}` : '';\r\n            let damageMessage: string = `${roll.damageType} damage`;\r\n\r\n            rollStatement = `${critModifier}${diceRollsMessage}${rollModifierMessage}`;\r\n\r\n            return (\r\n                <div\r\n                    className={`text-color-${roll.damageType.toLowerCase()}`}>\r\n                    {rollStatement} {damageMessage}\r\n                </div>\r\n            );\r\n        });\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface IMoneyAdjustModalProps {\r\n    /**\r\n     * The die face to show on the die currently.\r\n     */\r\n    dieFace: number;\r\n\r\n    /**\r\n     * The color of the die.\r\n     */\r\n    dieColor: string;\r\n}\r\n\r\n/**\r\n * Gets a visual representation of a D20 to show to the user.\r\n * @param props \r\n */\r\nexport function DTwenty (props: IMoneyAdjustModalProps) {\r\n    return (\r\n        <div className=\"attack-die\">\r\n            <div className=\"attack-die-value\">\r\n                {props.dieFace}\r\n            </div>\r\n            <svg\r\n                className=\"roll-window-attack-die\"\r\n                version=\"1.1\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"64\"\r\n                height=\"56\" >\r\n                <path fill={props.dieColor} d=\"M0 27.712812921102035L16 0L48 0L64 27.712812921102035L48 55.42562584220407L16 55.42562584220407Z\"></path>\r\n            </svg>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { PurchaseClick } from '../../Types/CardButtonCallbackTypes/PurchaseClick';\r\nimport { IItem } from '../../Interfaces/IItem';\r\n\r\nenum PurchaseButtonOption {\r\n    NotEnoughMoney = \"Not enough money!\",\r\n    CanPurchase = \"Purchase\",\r\n    Purchased = \"Purchased!\"\r\n}\r\n\r\ninterface IPurchaseButtonProps {\r\n    item: IItem;\r\n    cardIconSize: number;\r\n    callbackFunction: PurchaseClick;\r\n    availablePlayerCopper: number | undefined;\r\n}\r\n\r\nexport function PurchaseButton(props: IPurchaseButtonProps) {\r\n    const [buttonOption, setButtonOption] = useState(PurchaseButtonOption.CanPurchase);\r\n\r\n    useEffect(() => {\r\n        if (props.availablePlayerCopper && props.availablePlayerCopper < props.item.itemCopperCost) {\r\n            setButtonOption(PurchaseButtonOption.NotEnoughMoney);\r\n        }\r\n        else if (buttonOption !== PurchaseButtonOption.Purchased) { // Don't handle purchased events. This is taken care of in the button click callback.\r\n            setButtonOption(PurchaseButtonOption.CanPurchase);\r\n        }\r\n    }, [buttonOption, props.availablePlayerCopper, props.item.itemCopperCost]);\r\n\r\n    function HandleButtonClick(): void {\r\n        if (buttonOption === PurchaseButtonOption.CanPurchase) {\r\n            props.callbackFunction(props.item);\r\n\r\n            setButtonOption(PurchaseButtonOption.Purchased);\r\n\r\n            window.setTimeout(() => {\r\n                setButtonOption(PurchaseButtonOption.CanPurchase);\r\n            }, 2500);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <button\r\n            className=\"card-button\"\r\n            style={GetButtonStyle(buttonOption)}\r\n            onClick={HandleButtonClick}\r\n            disabled={buttonOption !== PurchaseButtonOption.CanPurchase}>\r\n            <img\r\n                alt=\"card purchase button\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Purchase.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                {buttonOption}\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n\r\nfunction GetButtonStyle(purchaseOption: PurchaseButtonOption): React.CSSProperties {\r\n    let properties: React.CSSProperties = {};\r\n    switch (purchaseOption) {\r\n        case PurchaseButtonOption.Purchased: {\r\n            properties = { background: \"#1e6f50\" }\r\n            break;\r\n        }\r\n        case PurchaseButtonOption.CanPurchase: {\r\n            properties = {};\r\n            break;\r\n        }\r\n        case PurchaseButtonOption.NotEnoughMoney: {\r\n            properties = { background: \"#891e2b\" };\r\n            break;\r\n        }\r\n        default: {\r\n            break;\r\n        }\r\n    }\r\n\r\n    return properties;\r\n}","import React from 'react';\r\nimport { IItem } from '../../Interfaces/IItem';\r\nimport { AttuneClick } from '../../Types/CardButtonCallbackTypes/AttuneClick';\r\nimport { UnattuneClick } from '../../Types/CardButtonCallbackTypes/UnattuneClick';\r\n\r\nenum AttuneButtonOption {\r\n    Attune = \"Attune\",\r\n    Unattune = \"Attuned!\",\r\n    SlotsFull = \"Full attunements!\"\r\n}\r\n\r\ninterface IAttuneButtonProps {\r\n    item: IItem;\r\n    cardIconSize: number;\r\n    availableAttunementSlots: number;\r\n    attuneCallback: AttuneClick;\r\n    unattuneCallback: UnattuneClick;\r\n}\r\n\r\nexport function AttuneButton(props: IAttuneButtonProps) {\r\n    let itemIsAttuned: boolean = props.item.adjustments.isAttuned;\r\n    let buttonOption: AttuneButtonOption = itemIsAttuned ? AttuneButtonOption.Unattune : AttuneButtonOption.Attune;\r\n\r\n    if (props.availableAttunementSlots <= 0 && !itemIsAttuned) {\r\n        buttonOption = AttuneButtonOption.SlotsFull;\r\n    }\r\n\r\n    let buttonDisabled = buttonOption === AttuneButtonOption.SlotsFull;\r\n\r\n    // Give attuned buttons a special color. Something that's obvious, but neutral.\r\n    let buttonColorClass: string = buttonOption === AttuneButtonOption.Unattune ? \"neutral-button\" : \"\";\r\n\r\n    return (\r\n        <button\r\n            onClick={() => HandleButtonPress(buttonOption, props.item, props.attuneCallback, props.unattuneCallback)}\r\n            className={`card-button ${buttonColorClass}`}\r\n            disabled={buttonDisabled}\r\n            >\r\n            <img\r\n                alt=\"attunement button icon\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Attune.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                {buttonOption}\r\n            </div>\r\n        </button>\r\n    );\r\n}\r\n\r\nfunction HandleButtonPress(\r\n    buttonOption: AttuneButtonOption,\r\n    item: IItem,\r\n    attuneCallback: AttuneClick,\r\n    unattuneCallback: UnattuneClick) {\r\n\r\n    switch (buttonOption) {\r\n        case AttuneButtonOption.Attune: {\r\n            attuneCallback(item);\r\n            break;\r\n        }\r\n        case AttuneButtonOption.Unattune: {\r\n            unattuneCallback(item);\r\n            break;\r\n        }\r\n        default: {\r\n            break;\r\n        }\r\n    }\r\n}\r\n","export enum CardInteractions {\r\n    Purchase = \"Purchase\",\r\n    Remove = \"Remove\",\r\n    Stage = \"Stage\",\r\n    Unstage = \"Unstage\",\r\n    Gather = \"Gather\",\r\n    Use = \"Use\",\r\n    Attune = \"Attune\"\r\n}\r\n","import React from 'react';\r\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap';\r\n\r\ninterface ICardIconProps {\r\n    iconSource: string;\r\n    tooltipTitle: string;\r\n    tooltipText: string;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport function CardIcon(props: ICardIconProps) {\r\n    return (\r\n        <OverlayTrigger\r\n            placement='top'\r\n            delay={{ show: 0, hide: 400 }}\r\n            overlay={\r\n                <Tooltip key=\"tooltip\" id=\"card-tooltip\">\r\n                    <span key=\"title\" style={{fontWeight: \"bold\"}}>\r\n                        {props.tooltipTitle}\r\n                    </span>\r\n                    <br />\r\n                    {props.tooltipText}\r\n                </Tooltip>\r\n            }>\r\n            <div key=\"icon\" className=\"card-icon\">\r\n                <img\r\n                    key=\"image\"\r\n                    alt=\"Card Icon\"\r\n                    src={props.iconSource}\r\n                    style={{\r\n                        width: `${props.width}px`,\r\n                        height: `${props.height}px`,\r\n                    }} />\r\n            </div>\r\n        </OverlayTrigger>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { Attack } from '../../Classes/Attack';\r\nimport { AttackClick } from '../../Types/CardButtonCallbackTypes/AttackClick';\r\n\r\ninterface IAttackButtonProps {\r\n    cardIconSize: number;\r\n    attackName: string;\r\n    attacks: Attack[];\r\n    callbackFunction: AttackClick;\r\n}\r\n\r\nexport function AttackButton(props: IAttackButtonProps) {\r\n    let attackIndicators: JSX.Element[] = props.attacks.map(roll => {\r\n        let indicators: JSX.Element[] = [];\r\n\r\n        for (let i = 0; i < roll.diceCount; i++) {\r\n            indicators.push(\r\n                <span className={`card-button-stat badge-color-${roll.damageType.toLowerCase()}`}>\r\n                    {roll.diceSize}\r\n                </span>\r\n            )\r\n        }\r\n\r\n        return (\r\n            <span>\r\n                {indicators}{`${roll.modifier > 0 ? `+${roll.modifier}` : ''}`}\r\n            </span>\r\n        );\r\n    });\r\n\r\n    return (\r\n        <button\r\n            className=\"card-button\"\r\n            onClick={() => { props.callbackFunction(props.attackName, props.attacks) }}>\r\n            <img\r\n                alt=\"Attack Button\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Attack.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                {props.attackName}\r\n            </div>\r\n            <div className=\"card-button-stats-container\">\r\n                {attackIndicators}\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { StageClick } from '../../Types/CardButtonCallbackTypes/StageClick';\r\nimport { IItem } from '../../Interfaces/IItem';\r\n\r\ninterface IAddButtonProps {\r\n    item: IItem;\r\n    cardIconSize: number;\r\n    callbackFunction: StageClick;\r\n}\r\n\r\nexport function StageButton(props: IAddButtonProps) {\r\n    return (\r\n        <button\r\n            className=\"card-button\"\r\n            onClick={() => { props.callbackFunction(props.item) }}>\r\n            <img\r\n                alt=\"Add Button\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Add.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                Stage Item\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { UnstageClick } from '../../Types/CardButtonCallbackTypes/UnstageClick';\r\nimport { IItem } from '../../Interfaces/IItem';\r\n\r\ninterface IUnstageButtonProps {\r\n    item: IItem;\r\n    cardIconSize: number;\r\n    callbackFunction: UnstageClick;\r\n}\r\n\r\nexport function UnstageButton(props: IUnstageButtonProps) {\r\n    return (\r\n        <button\r\n            className=\"card-button\"\r\n            onClick={() => { props.callbackFunction(props.item) }}>\r\n            <img\r\n                alt=\"Add Button\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Remove.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                Unstage Item\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { BagClick } from '../../Types/CardButtonCallbackTypes/BagClick';\r\nimport { IItem } from '../../Interfaces/IItem';\r\n\r\ninterface IBagButtonProps {\r\n    item: IItem;\r\n    cardIconSize: number;\r\n    callbackFunction: BagClick;\r\n}\r\n\r\nexport function BagButton(props: IBagButtonProps) {\r\n    return (\r\n        <button\r\n            className=\"card-button\"\r\n            onClick={() => { props.callbackFunction(props.item) }}>\r\n            <img\r\n                alt=\"Bag Button\"\r\n                className=\"card-button-icon\"\r\n                src='./images/Item_Shop/ItemCards/Icons/Button_Bag.png'\r\n                width={props.cardIconSize}\r\n                height={props.cardIconSize}\r\n                style={{\r\n                    left: `-${props.cardIconSize / 2}px`\r\n                }} />\r\n            <div className=\"card-button-name\">\r\n                Add To Bag\r\n            </div>\r\n        </button>\r\n    )\r\n}\r\n","import '../css/ItemCard.css';\r\n\r\nimport React from 'react';\r\nimport { Button } from 'react-bootstrap';\r\nimport { CardIcon } from './CardIcon';\r\nimport { AttackButton } from './CardButtons/AttackButton';\r\nimport { StageButton } from './CardButtons/StageButton';\r\nimport { UnstageButton } from './CardButtons/UnstageButton';\r\nimport { PurchaseButton } from './CardButtons/PurchaseButton';\r\nimport { AttuneButton } from './CardButtons/AttuneButton';\r\nimport { BagButton } from './CardButtons/BagButton';\r\nimport { IItem } from '../Interfaces/IItem';\r\nimport { ItemClick } from '../Types/CardButtonCallbackTypes/ItemClick';\r\nimport { AttackClick } from '../Types/CardButtonCallbackTypes/AttackClick';\r\nimport { PurchaseClick } from '../Types/CardButtonCallbackTypes/PurchaseClick';\r\nimport { AttuneClick } from '../Types/CardButtonCallbackTypes/AttuneClick';\r\nimport { BagClick } from '../Types/CardButtonCallbackTypes/BagClick';\r\nimport { StageClick } from '../Types/CardButtonCallbackTypes/StageClick';\r\nimport { UnstageClick } from '../Types/CardButtonCallbackTypes/UnstageClick';\r\nimport { CardInteractions } from '../Enums/CardInteractions';\r\nimport { IItemJson } from '../Interfaces/IItemJson';\r\nimport { IItemIsItemWeapon } from '../Classes/ItemWeapon';\r\nimport { IItemIsItemPotion } from '../Classes/ItemPotion';\r\nimport { CardIconMap } from '../Classes/CardIconMap';\r\nimport { IconTooltip } from '../Types/IconTooltip';\r\nimport { MoneyDisplay } from '../../CharacterInfo/React/MoneyDisplay';\r\n\r\ninterface IItemCardProps {\r\n    itemDetails: IItem;\r\n    onItemClick: ItemClick | undefined;\r\n    onAttackButton: AttackClick | undefined;\r\n    onPurchaseButton: PurchaseClick | undefined;\r\n    onStageButton: StageClick | undefined;\r\n    onUnstageButton: UnstageClick |undefined;\r\n    onAttuneButton: AttuneClick | undefined;\r\n    onUnattuneButton: AttuneClick | undefined;\r\n    onBagButton: BagClick | undefined;\r\n    cardInteractions: CardInteractions[];\r\n    showCardCost: boolean;\r\n    availablePlayerCopper: number | undefined;\r\n    availableAttunementSlots: number | undefined;\r\n}\r\n\r\ninterface IItemCardState {\r\n    titleFontSize: number\r\n}\r\n\r\nexport class ItemCard extends React.Component<IItemCardProps, IItemCardState> {\r\n    readonly cardWidth: number = 194;\r\n    readonly cardHeight: number = 256;\r\n    readonly cardDefaultMargin: number = 6;\r\n    \r\n    // DO NOT CHANGE. The card's icon size is 128. This gives us a scaling raito for everything else.\r\n    readonly cardRatio: number = this.cardHeight / 128;\r\n    \r\n    // Item area measurements.\r\n    readonly itemAreaDefaultOffset: number = 17;\r\n    readonly itemAreaDefaultSize: number = 64;\r\n    \r\n    // Title measurements.\r\n    readonly titleDefaultTopOffset: number = 6;\r\n    readonly titleDefaultFontSize: number = 12;\r\n    readonly titleWidth: number = this.cardWidth * 0.65;\r\n    readonly titleDefaultLeftOffset: number = 1;\r\n    \r\n    // Item description measurements.\r\n    readonly descAreaDefaultOffset: number = 82;\r\n    readonly descAreaDefaultSize: number = 44;\r\n\r\n    // Attack Icon measurements.\r\n    readonly attackIconDefaultSize: number = 16;\r\n\r\n    // Icon measurements.\r\n    readonly iconDefaultSize: number = 16;\r\n    readonly iconDefaultLeftOffset: number = 81;\r\n    readonly iconDefaultTopOffset: number = 17;\r\n\r\n    // MagicBonus measurements.\r\n    readonly magBonusDefualtTopOffset: number = 18;\r\n    readonly magBonusDefualtLeftOffset: number = 18;\r\n\r\n    // Coin measurements.\r\n    readonly coinDefaultSize: number = 16;\r\n    readonly coinDefaultLeftOffset: number = 1;\r\n    readonly coinDefaultTopOffset: number = 17;\r\n\r\n    constructor(props: IItemCardProps) {\r\n        super(props);\r\n        this.state = {\r\n            titleFontSize: this.titleDefaultFontSize\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets any additional content that should appear on the card. Includes attack buttons, etc.\r\n     */\r\n    private GetCardButtons(): JSX.Element[] {\r\n        let buttons: JSX.Element[] = [];\r\n        let itemDetails: IItemJson = this.props.itemDetails;\r\n\r\n        if (this.props.cardInteractions.some(interaction => interaction === \"Use\")) {\r\n            // This uses a type guard to enforce that itemDetails must be a specific type.\r\n            // https://medium.com/ovrsea/checking-the-type-of-an-object-in-typescript-the-type-guards-24d98d9119b0\r\n            if (IItemIsItemWeapon(itemDetails) && this.props.onAttackButton !== undefined) {\r\n                let attackButtons: JSX.Element[] = Object.entries(itemDetails.attacks).flatMap((attack) => {\r\n                    let name = attack[0];\r\n                    let attacks = attack[1];\r\n\r\n                    return (\r\n                        <AttackButton\r\n                            key={\"Attack \" + name}\r\n                            cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                            attackName={name}\r\n                            attacks={attacks}\r\n                            callbackFunction={this.props.onAttackButton as AttackClick}\r\n                        />\r\n                    );\r\n                })\r\n\r\n                buttons = buttons.concat(attackButtons);\r\n            }\r\n        }\r\n\r\n        if (this.props.cardInteractions.some(interaction => interaction === CardInteractions.Purchase)\r\n         && this.props.onPurchaseButton !== undefined) {\r\n            let purchaseButton: JSX.Element = (\r\n                <PurchaseButton\r\n                    key=\"Purchase\"\r\n                    item={this.props.itemDetails}\r\n                    cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                    callbackFunction={this.props.onPurchaseButton}\r\n                    availablePlayerCopper={this.props.availablePlayerCopper}\r\n                />\r\n            );\r\n\r\n            buttons = buttons.concat(purchaseButton);\r\n        }\r\n\r\n        if (this.props.cardInteractions.some(interaction => interaction === CardInteractions.Stage)\r\n         && this.props.onStageButton !== undefined) {\r\n             let addButton: JSX.Element = (\r\n                 <StageButton\r\n                    key=\"Stage\"\r\n                    item={this.props.itemDetails}\r\n                    cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                    callbackFunction={this.props.onStageButton}\r\n                 />\r\n             );\r\n\r\n            buttons = buttons.concat(addButton);\r\n        }\r\n\r\n        if (this.props.cardInteractions.some(interaction => interaction === CardInteractions.Unstage)\r\n            && this.props.onUnstageButton !== undefined) {\r\n            let unstageButton: JSX.Element = (\r\n                <UnstageButton\r\n                    key=\"Unstage\"\r\n                    item={this.props.itemDetails}\r\n                    cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                    callbackFunction={this.props.onUnstageButton}\r\n                />\r\n            );\r\n\r\n            buttons = buttons.concat(unstageButton);\r\n        }\r\n\r\n        if (this.props.cardInteractions.some(interaction => interaction === CardInteractions.Attune)\r\n            && this.props.onAttuneButton\r\n            && this.props.onUnattuneButton\r\n            && this.props.availableAttunementSlots !== undefined\r\n            && this.props.itemDetails.requiresAttunement) {\r\n            let attuneButton: JSX.Element = (\r\n                <AttuneButton\r\n                    key=\"Attune\"\r\n                    item={this.props.itemDetails}\r\n                    cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                    availableAttunementSlots={this.props.availableAttunementSlots}\r\n                    attuneCallback={this.props.onAttuneButton}\r\n                    unattuneCallback={this.props.onUnattuneButton}\r\n                />\r\n            );\r\n\r\n            buttons = buttons.concat(attuneButton);\r\n        }\r\n\r\n        if (this.props.onBagButton) {\r\n            let bagButton: JSX.Element = (\r\n                <BagButton\r\n                    key=\"Bag\"\r\n                    item={this.props.itemDetails}\r\n                    cardIconSize={this.iconDefaultSize * this.cardRatio}\r\n                    callbackFunction={this.props.onBagButton}\r\n                />\r\n            );\r\n\r\n            buttons = buttons.concat(bagButton);\r\n        }\r\n\r\n        return buttons;\r\n    }\r\n\r\n    private GetCardIcons(): JSX.Element[] {\r\n        let itemDetails: IItemJson = this.props.itemDetails;\r\n        let icons: JSX.Element[] = [];\r\n        let iconDimensions: number = this.iconDefaultSize * this.cardRatio;\r\n\r\n        if (itemDetails.requiresAttunement) {\r\n            icons.push(CardIcon({\r\n                iconSource: './images/Item_Shop/ItemCards/Icons/Attunement.png',\r\n                tooltipTitle: \"Attunement\",\r\n                tooltipText: 'This item requires attunement.',\r\n                width: (iconDimensions),\r\n                height: (iconDimensions),\r\n            }));\r\n        }\r\n\r\n        if (IItemIsItemPotion(itemDetails) && itemDetails.hasWithdrawalEffect) {\r\n            icons.push(CardIcon({\r\n                iconSource: './images/Item_Shop/ItemCards/Icons/Withdrawal.png',\r\n                tooltipTitle: \"Withdrawal\",\r\n                tooltipText: 'Using this potion will result in a withdrawal effect.',\r\n                width: (iconDimensions),\r\n                height: (iconDimensions),\r\n            }));\r\n        }\r\n        \r\n        else if (IItemIsItemWeapon(itemDetails)) {\r\n            itemDetails.properties.forEach(property => {\r\n                if (CardIconMap.CardIconWeaponsMap.has(property)) {\r\n                    let iconTooltip: IconTooltip = CardIconMap.CardIconWeaponsMap.get(property) as IconTooltip;\r\n\r\n                    icons.push(\r\n                        CardIcon({\r\n                            iconSource: iconTooltip.iconSource,\r\n                            tooltipTitle: property,\r\n                            tooltipText: iconTooltip.tooltipText,\r\n                            width: (iconDimensions),\r\n                            height: (iconDimensions),\r\n                        })\r\n                    );\r\n                }\r\n            });\r\n        }\r\n\r\n        return icons;\r\n    }\r\n\r\n    /**\r\n     * Handles when the component has mounted. This will cause the card to draw.\r\n     */\r\n    componentDidMount() {\r\n        this.LoadCard();\r\n    }\r\n\r\n    /**\r\n     * Loads all of the parts needed to render the card itself.\r\n     */\r\n    private LoadCard(): void {\r\n        let imagesToLoad: HTMLImageElement[] = [];\r\n        let iconImage = new Image();\r\n        iconImage.src = this.props.itemDetails.iconSource;\r\n        imagesToLoad.push(iconImage);\r\n\r\n        let loadedImagesPromises: Promise<void>[] = imagesToLoad.map(image => {\r\n            return new Promise<void>(resolve => {\r\n                image.onload = () => {\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n\r\n        Promise.all(loadedImagesPromises)\r\n            .then(resolved => {\r\n                this.SetTitleTextSize();\r\n            })\r\n            .catch(reason => {\r\n                console.error(\"Failed to load card images\" + reason);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Draws the title text for this card.\r\n     */\r\n    private SetTitleTextSize() {\r\n        let titleText: string = this.props.itemDetails.title;\r\n        let testDiv: HTMLDivElement = document.createElement(\"div\") as HTMLDivElement;\r\n        testDiv.innerText = titleText;\r\n        \r\n        let cardDiv = this.refs.card as HTMLDivElement;\r\n        testDiv.style.visibility = 'hidden';\r\n        cardDiv.insertAdjacentElement('afterbegin', testDiv);\r\n        let textWidth: number = testDiv.offsetWidth;\r\n        cardDiv.removeChild(testDiv);\r\n\r\n        /*\r\n         * Once we have the width of the text, now we need to determine if the text element needs to be\r\n         * resized or not.\r\n         *\r\n         * We can determine the following:\r\n         * 1:   If the text size is <= the max size of the title element, then do not resize.\r\n         * 2:   If the text size is > the max size of the title element, adjust the text size by some\r\n         *      percentage.\r\n         * \r\n         * We can determine the percentage by asserting the following steps:\r\n         * 1:   Get a percentage that the text width exceeds the max width.\r\n         * 2:   Multiple that percentage by our standard font size.\r\n         */\r\n\r\n        let fontSize: number = this.titleDefaultFontSize;\r\n        let fontRatio: number = this.titleWidth / textWidth;\r\n        let newFontSize: number = Math.min(fontSize, fontRatio * fontSize);\r\n\r\n        this.setState({\r\n            titleFontSize: newFontSize\r\n        });\r\n    }\r\n\r\n    private GetCardCost(): JSX.Element {\r\n        let element: JSX.Element = (<div></div>);\r\n        \r\n        if (this.props.showCardCost) {\r\n            element = (\r\n                <MoneyDisplay\r\n                    copperCount={this.props.itemDetails.itemCopperCost}\r\n                    hideEmptyCurrencies={true}\r\n                />\r\n            )\r\n        }\r\n\r\n        return element;\r\n    }\r\n\r\n    /**\r\n     * Renders an instance of this object.\r\n     */\r\n    render() {\r\n        let cardBonus: string = \"\";\r\n        let itemMagicBonus: number = this.props.itemDetails.adjustments.magicBonus;\r\n        if (itemMagicBonus > 0) {\r\n            cardBonus = `+${itemMagicBonus}`;\r\n        }\r\n\r\n        return (\r\n            <div className=\"card-display\">\r\n                <div\r\n                    className=\"item-card\"\r\n                    ref=\"card\"\r\n                    style={{\r\n                        margin: `${this.cardDefaultMargin * this.cardRatio}px`\r\n                    }}>\r\n                    <Button\r\n                        variant=\"link\"\r\n                        className=\"card-details-button\"\r\n                        onClick={() =>{\r\n                            if (this.props.onItemClick !== undefined) {\r\n                                this.props.onItemClick(this.props.itemDetails)\r\n                            }\r\n                        }}\r\n                        style={{\r\n                            width: `${this.cardWidth}px`,\r\n                            height: `${this.cardHeight}px`\r\n                        }}\r\n                    />\r\n                    <span\r\n                        ref=\"title\"\r\n                        className=\"card-title\"\r\n                        style={{\r\n                            fontSize: `${this.state.titleFontSize}px`,\r\n                            height: `${this.titleDefaultFontSize}px`,\r\n                            top: `${this.titleDefaultTopOffset * this.cardRatio}px`,\r\n                        }}>\r\n                        {this.props.itemDetails.title}\r\n                    </span>\r\n                    <div\r\n                        className=\"card-magic-bonus\"\r\n                        style={{\r\n                            top: `${this.magBonusDefualtTopOffset * this.cardRatio}px`,\r\n                            left: `${this.magBonusDefualtLeftOffset * this.cardRatio}px`,\r\n                        }}>\r\n                        {cardBonus}\r\n                    </div>\r\n                    <div\r\n                        className=\"card-icons\"\r\n                        style={{\r\n                            top: `${this.iconDefaultTopOffset * this.cardRatio}px`,\r\n                            left: `${this.iconDefaultLeftOffset * this.cardRatio}px`,\r\n                            maxWidth: `${this.iconDefaultSize * this.cardRatio}px`,\r\n                            height: `${this.iconDefaultSize * this.cardRatio * 4}px`\r\n                        }}>\r\n                        {this.GetCardIcons()}\r\n                    </div>\r\n                    <div\r\n                        className=\"card-info\"\r\n                        style={{\r\n                            top: `${this.descAreaDefaultOffset * this.cardRatio}px`,\r\n                            maxHeight: `${this.descAreaDefaultSize * this.cardRatio}px`,\r\n                            minHeight: `${this.descAreaDefaultSize * this.cardRatio}px`,\r\n                        }}>\r\n                        <div style={{ width: \"100%\" }}>\r\n                            {this.props.itemDetails.description}\r\n                        </div>\r\n                    </div>\r\n                    <img\r\n                        alt=\"card item\"\r\n                        className=\"card-item-image\"\r\n                        src={this.props.itemDetails.iconSource}\r\n                        height={this.itemAreaDefaultSize * this.cardRatio}\r\n                        width={this.itemAreaDefaultSize * this.cardRatio}\r\n                        style={{\r\n                            top: `${this.itemAreaDefaultOffset * this.cardRatio}px`,\r\n                            left: `${this.itemAreaDefaultOffset * this.cardRatio}px`,\r\n                            height: `${this.itemAreaDefaultSize * this.cardRatio}px`,\r\n                            width: `${this.itemAreaDefaultSize * this.cardRatio}px`,\r\n                        }}\r\n                    />\r\n                    <img\r\n                        alt=\"card back\"\r\n                        className=\"card-canvas\"\r\n                        src={this.props.itemDetails.GetCardbackSource()}\r\n                        width={this.cardWidth}\r\n                        height={this.cardHeight}\r\n                    />\r\n                </div>\r\n                <div className=\"card-cost-display\">\r\n                    {this.GetCardCost()}\r\n                </div>\r\n                <div className=\"card-actions\">\r\n                    {this.GetCardButtons()}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","export enum LoadingState {\r\n    Loading = \"Loading\",\r\n    Loaded = \"Loaded\",\r\n    Anonymous = \"Anonymous\",\r\n    NoCharacters = \"No Characters\"\r\n}\r\n","import React from 'react';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemType } from '../../ItemData/Enums/ItemType';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { AttackClick } from '../../ItemData/Types/CardButtonCallbackTypes/AttackClick';\r\nimport { ItemCard } from '../../ItemData/React/ItemCard';\r\nimport { CardInteractions } from '../../ItemData/Enums/CardInteractions';\r\nimport { AttuneClick } from '../../ItemData/Types/CardButtonCallbackTypes/AttuneClick';\r\nimport { UnattuneClick } from '../../ItemData/Types/CardButtonCallbackTypes/UnattuneClick';\r\n\r\ninterface IInventoryTabProps {\r\n    items: IItem[];\r\n    itemType: ItemType;\r\n    itemClick: ItemClick;\r\n    attackClick: AttackClick;\r\n    attuneClick: AttuneClick;\r\n    unattuneClick: UnattuneClick;\r\n    availableAttunementSlots: number;\r\n}\r\n\r\ninterface IInventoryTabState {\r\n}\r\n\r\nexport class InventoryTab extends React.Component<IInventoryTabProps, IInventoryTabState> {\r\n    public constructor(props: IInventoryTabProps) {\r\n        super(props);\r\n        this.state = {\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        let itemCards: JSX.Element[] = this.props.items.map(i => {\r\n            return (\r\n                <ItemCard\r\n                    itemDetails={i}\r\n                    onItemClick={this.props.itemClick}\r\n                    onAttackButton={this.props.attackClick}\r\n                    onPurchaseButton={undefined}\r\n                    onStageButton={undefined}\r\n                    onUnstageButton={undefined}\r\n                    onAttuneButton={this.props.attuneClick}\r\n                    onUnattuneButton={this.props.unattuneClick}\r\n                    onBagButton={undefined}\r\n                    cardInteractions={[\r\n                        CardInteractions.Use,\r\n                        CardInteractions.Remove,\r\n                        CardInteractions.Attune\r\n                    ]}\r\n                    showCardCost={false}\r\n                    availablePlayerCopper={undefined}\r\n                    availableAttunementSlots={this.props.availableAttunementSlots}\r\n                />\r\n            )\r\n        });\r\n\r\n        return (\r\n            <div className=\"inventory-tab\">\r\n                {itemCards}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import { LoadingState } from '../Enums/LoadingState';\r\nimport { useState, useEffect } from 'react';\r\nimport { UserDataAuth } from '../../FirebaseAuth/Classes/UserDataAuth';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\n\r\nexport function useLoadingState(loginState: LoginState) {\r\n    const [loadingState, setLoadingState] = useState(LoadingState.Loading);\r\n\r\n    useEffect(() => {\r\n        CheckForUserLogin().then(loadState => {\r\n            setLoadingState(loadState);\r\n        });\r\n\r\n    }, [loadingState, loginState]);\r\n\r\n    return loadingState;\r\n}\r\n\r\n/**\r\n * Check to see if the user has logged in successfully. This also checks to see if the user has any characters\r\n * available.\r\n */\r\nasync function CheckForUserLogin(): Promise<LoadingState> {\r\n    let loadingState: LoadingState = LoadingState.Anonymous;\r\n    let userHasAccess: boolean = await UserDataAuth.GetInstance().CheckForAccess();\r\n\r\n    if (userHasAccess) {\r\n        let staticCharData: PlayerCharacterData | undefined = undefined;\r\n        staticCharData = await CharacterStateManager.GetInstance().GetCharacter();\r\n\r\n        if (staticCharData === undefined) {\r\n            loadingState = LoadingState.NoCharacters;\r\n        }\r\n        else {\r\n            loadingState = LoadingState.Loaded;\r\n        }\r\n    }\r\n\r\n    return loadingState;\r\n}","import { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { LoadingState } from '../Enums/LoadingState';\r\nimport { useState, useEffect } from 'react';\r\n\r\n/**\r\n * \r\n * @param loadingState The loading state for this component. Note that this requires fetching the\r\n * 'LoadingState' using the 'useLoadingState' hook. This violates the DRY principle by calling GetCharacter()\r\n * a second time in this function. That said, this action should only re-fetch a static resource, and keeping\r\n * this hook separate form useLoadingState ensures that we have a singular flow of information, from getting\r\n * information about what state we're in to what character (if we have one) to show.\r\n */\r\nexport function useCharData(loadingState: LoadingState): PlayerCharacterData | undefined {\r\n    const [charData, setCharData] = useState<PlayerCharacterData | undefined>(undefined);\r\n\r\n    /**\r\n     * Attempt to load the character data. Do this only if we know that we're in a logged-in state, or if we\r\n     * have changed login states or character data.\r\n     */\r\n    useEffect(() => {\r\n        if (loadingState === LoadingState.Loaded || loadingState === LoadingState.NoCharacters) {\r\n            CharacterStateManager.GetInstance().GetCharacter().then(char => {\r\n                if (char) {\r\n                    setCharData(char);\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n        * A handler for when the character state manager has changed its character data.\r\n        * @param charData The character data that has been changed.\r\n        */\r\n        const characterStateManager_NotifyObservers = function (charData: PlayerCharacterData | undefined): void {\r\n            if (charData) {\r\n                setCharData(charData);\r\n            }\r\n        }\r\n\r\n        // Ensure that we are notified by the character state manager whenever there are changes to the active\r\n        // character.\r\n        CharacterStateManager.GetInstance().AddObserver(characterStateManager_NotifyObservers);\r\n\r\n        return () => {\r\n            CharacterStateManager.GetInstance().RemoveObserver(characterStateManager_NotifyObservers);\r\n        }\r\n    }, [loadingState, charData]);\r\n\r\n    // /**\r\n    // * A handler for when the character state manager has changed its character data.\r\n    // * @param charData The character data that has been changed.\r\n    // */\r\n    // const characterStateManager_NotifyObservers = function (charData: PlayerCharacterData | undefined): void {\r\n    //     if (charData) {\r\n    //         setCharData(charData);\r\n    //     }\r\n    // }\r\n\r\n    // // Ensure that we are notified by the character state manager whenever there are changes to the active\r\n    // // character.\r\n    // CharacterStateManager.GetInstance().AddObserver(characterStateManager_NotifyObservers);\r\n\r\n    return charData;\r\n}\r\n","import '../Inventory.css';\r\n\r\nimport React, { useState, useEffect, ChangeEvent } from 'react';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemSource } from '../../ItemData/Classes/ItemSource';\r\nimport { ItemDetailsModal } from '../../ItemData/React/ItemDetailsModal';\r\nimport { AttackRollModal } from '../../ItemData/React/AttackRollModal';\r\nimport { ItemWondrous } from '../../ItemData/Classes/ItemWondrous';\r\nimport { Attack } from '../../ItemData/Classes/Attack';\r\nimport { ItemType } from '../../ItemData/Enums/ItemType';\r\nimport { InventoryTab } from './InventoryTab';\r\nimport { Tabs, Tab } from 'react-bootstrap';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\nimport { LoadingState } from '../../Utilities/Enums/LoadingState';\r\nimport { useLoadingState } from '../../Utilities/Hooks/useLoadingState';\r\nimport { useCharData } from '../../Utilities/Hooks/useCharData';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { AttackClick } from '../../ItemData/Types/CardButtonCallbackTypes/AttackClick';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { AttuneClick } from '../../ItemData/Types/CardButtonCallbackTypes/AttuneClick';\r\nimport { UnattuneClick } from '../../ItemData/Types/CardButtonCallbackTypes/UnattuneClick';\r\nimport { DnDConstants } from '../../Utilities/Classes/DndConstants';\r\n\r\nexport interface IInventoryProps {\r\n    loginState: LoginState;\r\n}\r\n\r\nexport function Inventory(props: IInventoryProps) {\r\n    /**\r\n     * A series of items that will be rendered by this class. This should come entirely from the loaded\r\n     * character data.\r\n     */\r\n    const [items, setItems] = useState<IItem[]>([]);\r\n\r\n    /**\r\n     * A boolean value informing the item details window when to be visible.\r\n     */\r\n    const [showItemDetails, setShowItemDetails] = useState(false);\r\n\r\n    /**\r\n     * A boolean value indicating what to use as the item to display in the item details window.\r\n     */\r\n    const [focusedItem, setFocusedItem] = useState<IItem>(new ItemWondrous());\r\n\r\n    /**\r\n     * A boolean value informing the attack window when to be visible.\r\n     */\r\n    const [showAttackWindow, setShowAttackWindow] = useState(false);\r\n\r\n    /**\r\n     * The attack name that will be displayed in the attack window.\r\n     */\r\n    const [attackName, setAttackName] = useState(\"\");\r\n\r\n    /**\r\n     * A series of attacks to get damage values for whem the attack window is open. Note that these are not\r\n     * separate actions, but separate damage values.\r\n     */\r\n    const [attacks, setAttacks] = useState<Attack[]>([]);\r\n\r\n    /**\r\n     * The active tab name. Required for the bootstrap component.\r\n     */\r\n    const [activeTab, setActiveTab] = useState(ItemType.Weapon.toString());\r\n\r\n    /**\r\n     * The item notes that are currently being edited for an item. Will be saved once a user closes a modal.\r\n     */\r\n    const [updatedItemNotes, setUpdatedItemNotes] = useState<string | undefined>(undefined);\r\n\r\n    const loadingState = useLoadingState(props.loginState);\r\n    const charData = useCharData(loadingState);\r\n\r\n    /**\r\n     * Gets the user's items from a common source. Only adds items that have a discrete value. Only runs when\r\n     * the user's character data updates.\r\n     */\r\n    useEffect(() => {\r\n        let newItems: IItem[] = [];\r\n\r\n        if (charData) {\r\n            charData.Items.forEach(item => {\r\n                let foundItem: IItem | undefined = ItemSource.GetItem(item);\r\n\r\n                if (foundItem) {\r\n                    newItems.push(foundItem);\r\n                }\r\n            });\r\n        }\r\n\r\n        setItems(newItems);\r\n    }, [charData]);\r\n\r\n    function HandleHideDetails() {\r\n        setShowItemDetails(false);\r\n        if (charData && updatedItemNotes && focusedItem.adjustments.notes !== updatedItemNotes) {\r\n            // focusedItem is a reference, so we can just update it here and re-submit this char data to be\r\n            // updated on the server.\r\n            focusedItem.adjustments.notes = updatedItemNotes;\r\n            CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n        }\r\n\r\n        // Ensure that these go back to being 'undefined'. We don't want to set the item notes for everything\r\n        // that the user opens.\r\n        setUpdatedItemNotes(undefined);\r\n    }\r\n    \r\n    function HandleHideAttack() {\r\n        setShowAttackWindow(false);\r\n    }\r\n\r\n    function HandleTabSelection(key: string): void {\r\n        setActiveTab(key);\r\n    }\r\n\r\n    function HandleShowDetails(item: IItem): void {\r\n        setFocusedItem(item);\r\n        setShowItemDetails(true);\r\n    }\r\n\r\n    function HandleAttackClick(attackName: string, attackRolls: Attack[]): void {\r\n        setAttackName(attackName);\r\n        setAttacks(attackRolls);\r\n        setShowAttackWindow(true);\r\n    }\r\n\r\n    function HandleAttuneClick(item: IItem): void {\r\n        let itemAlreadyAttuned = item.adjustments.isAttuned;\r\n\r\n        if (charData && !itemAlreadyAttuned) {\r\n            // Good newts! This is a reference to the item from the character inventory, so just add this\r\n            // modification and update the remote!\r\n            item.adjustments.isAttuned = true;\r\n            CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n        }\r\n    }\r\n\r\n    function HandleUnattuneClick(item: IItem): void {\r\n        let itemIsAttuned = item.adjustments.isAttuned;\r\n\r\n        if (charData && itemIsAttuned) {\r\n            // Good newts! This is a reference to the item from the character inventory, so just remove this\r\n            // modification and update the remote!\r\n            item.adjustments.isAttuned = false;\r\n            CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n        }\r\n    }\r\n\r\n    function HandleUpdateItemNotes(event: ChangeEvent<HTMLTextAreaElement>) {\r\n        if (event && event.target && event.target.value) {\r\n            setUpdatedItemNotes(event.target.value);\r\n        }\r\n    }\r\n\r\n    function HandleRemoveClick(item: IItem): void {\r\n        setShowItemDetails(false);\r\n\r\n        if (charData) {\r\n            // First, freshen up those items! Otherwise, when we use the JSON stringify to compare, we will\r\n            // get a slew of other, nonsense stuff related to things are not in ItemKey.\r\n            let itemAsFreshKey = DnDConstants.GetItemAsFreshItemKey(item);\r\n            let charDataFreshItems = DnDConstants.GetItemsAsFreshKeys(charData.Items);\r\n\r\n            // This is a little verbose, but it makes debugging easier!\r\n            let jsonStringToCompare = JSON.stringify(itemAsFreshKey);\r\n            let itemsAsString: string[] = charDataFreshItems.map(i => JSON.stringify(i));\r\n\r\n            let itemToRemove = itemsAsString.findIndex(i => i === jsonStringToCompare);\r\n\r\n            if (itemToRemove > -1) {\r\n                charData.Items.splice(itemToRemove, 1);\r\n                CharacterStateManager.GetInstance().UploadCharacterData(charData);\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"inventory-container\">\r\n            <LoadingPlaceholder\r\n                showSpinner={loadingState === LoadingState.Loading}\r\n                role=\"Inventory Loading Status\">\r\n                <ItemDetailsModal\r\n                    show={showItemDetails}\r\n                    hideModal={HandleHideDetails}\r\n                    itemDetails={focusedItem}\r\n                    removeCallback={HandleRemoveClick}\r\n                    handleUpdatedItemNotes={HandleUpdateItemNotes}\r\n                />\r\n                <AttackRollModal\r\n                    show={showAttackWindow}\r\n                    attackName={attackName}\r\n                    attacks={attacks}\r\n                    onHide={HandleHideAttack}\r\n                />\r\n                <div className='inventory-tabs-container'>\r\n                    <Tabs\r\n                        id=\"Inventory Tabs\"\r\n                        activeKey={activeTab.toString()}\r\n                        onSelect={HandleTabSelection}\r\n                    >\r\n                        {GetInventoryTabs(items, HandleShowDetails, HandleAttackClick, HandleAttuneClick, HandleUnattuneClick)}\r\n                    </Tabs>\r\n                </div>\r\n            </LoadingPlaceholder>\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * Gets a tabbed component for each item type that will exist in the inventory.\r\n * @param items The entire series of items for the current character.\r\n * @param handleItemClick Handles when a user clicks for an item display.\r\n * @param handleAttackClick Handles when a user clicks an attack button for an item.\r\n */\r\nfunction GetInventoryTabs(items: IItem[], handleItemClick: ItemClick, handleAttackClick: AttackClick, handleAttuneClick: AttuneClick, handleUnattuneClick: UnattuneClick): JSX.Element[] {\r\n    let itemTabs: JSX.Element[] = Object.values(ItemType).map(itemType => {\r\n        let filteredItems: IItem[] = items.filter(item => item.type === itemType);\r\n        let remainingAttunements: number = DnDConstants.GetRemainingAttunementSlots(items);\r\n\r\n        // https://stackoverflow.com/questions/8900732/sort-objects-in-an-array-alphabetically-on-one-property-of-the-array\r\n        let sortedItems: IItem[] = filteredItems.sort((a, b) => {\r\n            let upperA = a.title;\r\n            let upperB = b.title;\r\n            let retVal = 0;\r\n\r\n            if (upperA > upperB) {\r\n                retVal = 1;\r\n            }\r\n            else {\r\n                retVal = -1;\r\n            }\r\n\r\n            return retVal;\r\n        });\r\n\r\n        return (\r\n            <Tab eventKey={itemType.toString()}\r\n                title={\r\n                    <div>\r\n                        <img\r\n                            alt=\"inventory tab icon\"\r\n                            className=\"inventory-tab-icon\"\r\n                            src={`./images/Inventory/Tab_${itemType}.png`}/>\r\n                        <span>{`${itemType} (${sortedItems.length})`}</span>\r\n                    </div>\r\n                }>\r\n                <InventoryTab\r\n                    items={sortedItems}\r\n                    itemType={itemType}\r\n                    itemClick={handleItemClick}\r\n                    attackClick={handleAttackClick}\r\n                    attuneClick={handleAttuneClick}\r\n                    unattuneClick={handleUnattuneClick}\r\n                    availableAttunementSlots={remainingAttunements}\r\n                />\r\n            </Tab>\r\n        )\r\n    });\r\n\r\n    return itemTabs;\r\n}\r\n","import React from 'react';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharacterImageCanvas } from '../../CharacterImage/React/CharacterImageCanvas';\r\n\r\n/**\r\n * The input properties for this component.\r\n * @param currentCharacterData Data regarding the current character. This may be undefined, meaning that no\r\n * character has been selected.\r\n */\r\nexport interface ICurrentCharacterStatusProps {\r\n    currentCharacterData: PlayerCharacterData | undefined;\r\n}\r\n\r\n/**\r\n * A display to render some information about the current user. For use in the character manager.\r\n * @param props \r\n */\r\nexport function CurrentCharacterStatus(props: ICurrentCharacterStatusProps) {\r\n    let name: string = \"\";\r\n    let images: string[] = [];\r\n    let borderColor: string = \"\";\r\n\r\n    if (props.currentCharacterData !== undefined) {\r\n        name = props.currentCharacterData.Name;\r\n        images = props.currentCharacterData.CharLayout.GetImages();\r\n        borderColor = props.currentCharacterData.BorderColor;\r\n    }\r\n\r\n    return (\r\n        <div className=\"character-status\">\r\n            <div className=\"character-selector-name\">\r\n                <h6>You are currently playing as . . . </h6>\r\n                <h1>{name}</h1>\r\n            </div>\r\n            <CharacterImageCanvas\r\n                charScaleFactor={4}\r\n                showLoadingSpinner={false}\r\n                imagesToRender={images}\r\n                borderColor={borderColor}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { SelectedCharacterCallback } from '../Types/SelectedCharacterCallback';\r\nimport { CharacterImageCanvas } from '../../CharacterImage/React/CharacterImageCanvas';\r\n\r\n/**\r\n * The input properties for this component.\r\n * @param characterData The character data that is represented by this button.\r\n * @param characterSelectedCallback A callback for a higher component when this button is selected.\r\n */\r\nexport interface ICharacterSelectionButtonProps {\r\n    characterData: PlayerCharacterData;\r\n    characterSelectedCallback: SelectedCharacterCallback;\r\n}\r\n\r\n/**\r\n * A button used to represent a character selection. This is displayed alongside other character selection\r\n * buttons.\r\n * @param props The input properties for this component.\r\n */\r\nexport function CharacterSelectionButton(props: ICharacterSelectionButtonProps) {\r\n    return (\r\n        <div className=\"character-selector-container\">\r\n            <button\r\n                className=\"character-selection-button\"\r\n                onClick={() => props.characterSelectedCallback(props.characterData)}>\r\n                <CharacterImageCanvas\r\n                    charScaleFactor={2}\r\n                    showLoadingSpinner={false}\r\n                    imagesToRender={props.characterData.CharLayout.GetImages()}\r\n                    borderColor={props.characterData.BorderColor}\r\n                    />\r\n            </button>\r\n            <span className=\"character-selection-name\">\r\n                {props.characterData.Name}\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react';\r\n\r\n/**\r\n * The input properties for this component.\r\n * @param onClick A callback for when this button is clicked.\r\n */\r\nexport interface INewCharacterButtonProps {\r\n    onClick: () => void;\r\n}\r\n\r\n/**\r\n * A button used to allow a user to create a new character. Generally only provides a callback to a higher-\r\n * level component.\r\n * @param props \r\n */\r\nexport function NewCharacterButton(props: INewCharacterButtonProps) {\r\n    return (\r\n        <div className=\"character-selector-container\">\r\n            <button className=\"new-character-button\" onClick={props.onClick}>\r\n                +\r\n            </button>\r\n            <span className=\"character-selection-name\">\r\n                New Character\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharacterSelectionButton } from './CharacterSelectionButton';\r\nimport { SelectedCharacterCallback } from '../Types/SelectedCharacterCallback';\r\nimport { NewCharacterButton } from './NewCharacterButton';\r\nimport { Spinner } from 'react-bootstrap';\r\n\r\n/**\r\n * The input properties for this component.\r\n * @param allCharacterData A list of all character data for this user.\r\n * @param characterSelectedCallback A callback for when the character is selected.\r\n * @param newCharacterButtonCallback A callback for when the new character button is selected.\r\n * @param isLoading If true, render this component as though it is loading.\r\n */\r\nexport interface ICharacterSelectorProps {\r\n    allCharacterData: PlayerCharacterData[];\r\n    characterSelectedCallback: SelectedCharacterCallback;\r\n    newCharacterButtonCallback: () => void;\r\n    isLoading: boolean;\r\n}\r\n\r\n/**\r\n * A container for a series of buttons that are used to manage character state, including existing and new\r\n * character buttons.\r\n * @param props The input properties for this component.\r\n */\r\nexport function CharacterSelector(props: ICharacterSelectorProps) {\r\n    let showSpinner: boolean = props.isLoading;\r\n    let showNoCharactersMessage: boolean = props.allCharacterData.length === 0 && !props.isLoading;\r\n\r\n    let characterButtons: JSX.Element[] = props.allCharacterData.map(charData => {\r\n        return (\r\n            <CharacterSelectionButton\r\n                characterSelectedCallback={props.characterSelectedCallback}\r\n                characterData={charData}\r\n            />\r\n        )\r\n    })\r\n\r\n    return (\r\n        <div className=\"character-selector\">\r\n            <h2>\r\n                Characters:\r\n            </h2>\r\n            <h4 style={{ visibility: showNoCharactersMessage ? 'visible' : 'hidden' }}>\r\n                You don't have any characters yet! You should make one.\r\n            </h4>\r\n            <div className=\"character-selector-buttons\">\r\n                <Spinner\r\n                    animation=\"border\"\r\n                    role=\"character button status\"\r\n                    style={{ visibility: showSpinner ? 'visible' : 'hidden' }}\r\n                />\r\n                {characterButtons}\r\n                <NewCharacterButton\r\n                    onClick={props.newCharacterButtonCallback}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, { ChangeEvent, FormEvent } from 'react';\r\nimport { Spinner } from 'react-bootstrap';\r\nimport { BodyType } from '../../CharacterImage/Enums/BodyType';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharImageLayout } from '../../CharacterImage/Classes/CharImageLayout';\r\nimport { PlayerInventoryService } from '../../FirebaseAuth/Classes/PlayerInventoryService';\r\nimport { CharacterImageMap } from '../../CharacterImage/Classes/CharacterImageMap';\r\nimport { StylizedModal } from '../../Utilities/React/StylizedModal';\r\n\r\n/**\r\n * The input properties for this component.\r\n * @param show If true, make this component visible and centered on-screen.\r\n * @param existingCharacterNames A list of existing character names. This is strictly only the names for\r\n * characters that have been created. This is to ensure a duplicate character is not created.\r\n * @param onHideModal A callback for when the user requests that the modal is closed.\r\n * @param onFormSubmission A callback for when the form has been submitted.\r\n */\r\nexport interface INewCharacterFormProps {\r\n    show: boolean;\r\n    existingCharacterNames: string[];\r\n    onHideModal: () => void;\r\n    onFormSubmission: () => void;\r\n}\r\n\r\n/**\r\n * A class used to maintain the state for this component.\r\n * @param isCreating If true, render this component as though it is creating a new character.\r\n * @param inputIsValid If false, prevent form submission and display validation errors.\r\n * @param validationErrors A list of errors regarding character name validation.\r\n */\r\nexport interface INewCharacterFormState {\r\n    isCreating: boolean;\r\n    inputIsValid: boolean;\r\n    validationErrors: string[];\r\n}\r\n\r\n/**\r\n * A form contained within a modal. Used to provide a user with the means to create a new character.\r\n */\r\nexport class NewCharacterForm extends React.Component<INewCharacterFormProps, INewCharacterFormState> {\r\n    private currentNewCharName: string;\r\n    private currentBodyType: BodyType;\r\n\r\n    /**\r\n     * Creates a new instance of this object.\r\n     * @param props The input properties for this component.\r\n     */\r\n    public constructor(props: INewCharacterFormProps) {\r\n        super(props);\r\n\r\n        this.currentNewCharName = \"\";\r\n        this.currentBodyType = BodyType.AverageSizedFeminine;\r\n\r\n        this.state = {\r\n            isCreating: false,\r\n            inputIsValid: false,\r\n            validationErrors: []\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Handles when the user inputs data to the character name field.\r\n     * @param event The event arguments when the name field is changed.\r\n     */\r\n    private handleCharNameInput(event: ChangeEvent<HTMLInputElement>): void {\r\n        let input = event.target?.value;\r\n        if (input) {\r\n            this.currentNewCharName = input;\r\n        }\r\n\r\n        this.validateInput();\r\n    }\r\n\r\n    /**\r\n     * Handles when the user inputs data to the body type field.\r\n     * @param event The event arguments when the body type field is changed.\r\n     */\r\n    private handleBodyTypeChange(event: ChangeEvent<HTMLSelectElement>): void {\r\n        let input = event.target?.value;\r\n        if (input) {\r\n            this.currentBodyType = input as BodyType;\r\n        }\r\n        \r\n        this.validateInput();\r\n    }\r\n\r\n    /**\r\n     * Validates the form's input. Will prevent submission if validation indicates errors.\r\n     */\r\n    private validateInput() {\r\n        let validCharNameRegex: RegExp = /^[A-Z0-9_ -]+$/i;\r\n        let inputValid: boolean = true;\r\n        let validationErrors: string[] = [];\r\n\r\n        if (!this.currentNewCharName.match(validCharNameRegex)) {\r\n            inputValid = false;\r\n            validationErrors.push(\"Character names can only contain alphanumerics, underscores, and hyphens.\")\r\n        }\r\n\r\n        if (this.props.existingCharacterNames.some(existingName => this.currentNewCharName === existingName)) {\r\n            inputValid = false;\r\n            validationErrors.push(`${this.currentNewCharName} already exists!`);\r\n        }\r\n\r\n        this.setState({\r\n            inputIsValid: inputValid,\r\n            validationErrors: validationErrors\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles the form's submission event. This creates a new character and informs watchers to proceed with\r\n     * their next events.\r\n     * @param event The event data concerning the submission.\r\n     */\r\n    private handleCreateCharacter(event: FormEvent<HTMLFormElement>) {\r\n        event.preventDefault();\r\n        this.setState({\r\n            isCreating: true\r\n        });\r\n\r\n        let charDefaults: CharImageLayout | undefined = CharacterImageMap.DefaultBodyParts.get(this.currentBodyType);\r\n        let startingCharBits: CharImageLayout;\r\n\r\n        if (charDefaults !== undefined) {\r\n            startingCharBits = charDefaults;\r\n        }\r\n        else {\r\n            startingCharBits = new CharImageLayout(new Map(), this.currentBodyType);\r\n        }\r\n\r\n        let newCharData: PlayerCharacterData = new PlayerCharacterData(\r\n            this.currentNewCharName,\r\n            0,\r\n            [],\r\n            startingCharBits,\r\n            \"\"\r\n        );\r\n\r\n        PlayerInventoryService.CreateCharacterData(newCharData).then(() => {\r\n            this.setState({\r\n                isCreating: false\r\n            });\r\n            this.props.onFormSubmission();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Renders the component.\r\n     */\r\n    public render() {\r\n        let formBodyOptions: JSX.Element[] = Object.values(BodyType).map(bt => {\r\n            return (\r\n                <option>\r\n                    {bt.toString()}\r\n                </option>\r\n            )\r\n        });\r\n\r\n        let creatingMessage: boolean = this.state.isCreating;\r\n\r\n        return (\r\n            <StylizedModal\r\n                show={this.props.show}\r\n                onHide={this.props.onHideModal}\r\n                title=\"New Character Deets\"\r\n                isLoading={false}\r\n                onEnterModal={undefined}>\r\n                <div className=\"new-character-form-errors\">\r\n                    {\r\n                        this.state.validationErrors.map(errormessage => (<span>{errormessage}</span>))\r\n                    }\r\n                </div>\r\n                <form className=\"new-character-form\" onSubmit={this.handleCreateCharacter.bind(this)}>\r\n                    <br />\r\n                    <span className=\"new-character-form-title\">\r\n                        Character Name:\r\n                    </span>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"characterName\"\r\n                        className=\"new-character-form-field new-character-form-name\"\r\n                        onChange={this.handleCharNameInput.bind(this)}\r\n                    />\r\n                    <br />\r\n                    <br />\r\n                    <span className=\"new-character-form-title\">\r\n                        Body Type:\r\n                    </span>\r\n                    <select\r\n                        id=\"new character body type\"\r\n                        className=\"new-character-form-field new-character-form-body-type\"\r\n                        onChange={this.handleBodyTypeChange.bind(this)}\r\n                    >\r\n                        {formBodyOptions}\r\n                    </select>\r\n                    <br />\r\n                    <br />\r\n                    <input\r\n                        disabled={!this.state.inputIsValid || this.state.isCreating}\r\n                        className=\"submit-new-character-button\"\r\n                        type=\"submit\"\r\n                        value=\"Create New Character\"\r\n                    />\r\n                </form>\r\n                <div style={{ visibility: creatingMessage ? 'visible' : 'hidden' }}>\r\n                    <Spinner\r\n                        animation=\"border\"\r\n                        role=\"character button status\"\r\n                    />\r\n                    <span>Creating {this.currentNewCharName} . . .</span>\r\n                </div>\r\n            </StylizedModal>\r\n        )\r\n    }\r\n}\r\n","import '../CharacterManager.css';\r\n\r\nimport React from 'react';\r\nimport { CurrentCharacterStatus } from './CurrentCharacterStatus';\r\nimport { PlayerInventoryService } from '../../FirebaseAuth/Classes/PlayerInventoryService';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { CharacterSelector } from './CharacterSelector';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { NewCharacterForm } from './NewCharacterForm';\r\n\r\n/**\r\n * The input properties for this component.\r\n */\r\nexport interface ICharacterManagerProps {\r\n}\r\n\r\n/**\r\n * The state managed by this component.\r\n * @param currentCharacterData The data for the current character. This will be taken from the\r\n * CharacterStateManager class.\r\n * @param allCharactersData The data aggregate for all characters. This will include the currently-selected\r\n * character.\r\n * @param isLoading If true, this component is still loading and hasn't yet finished getting info from the\r\n * database.\r\n * @param showNewCharForm If true, show the new character for for a user to create a new character.\r\n */\r\nexport interface ICharacterManagerState {\r\n    currentCharacterData: PlayerCharacterData | undefined;\r\n    allCharactersData: PlayerCharacterData[];\r\n    isLoading: boolean;\r\n    showNewCharForm: boolean;\r\n}\r\n\r\n/**\r\n * A high-level component used to show all available characters for a user, with the ability for\r\n * the user to switch between characters.\r\n */\r\nexport class CharacterManager extends React.Component<ICharacterManagerProps, ICharacterManagerState> {\r\n    /**\r\n     * Handles a new character button press. Shows the new character form.\r\n     */\r\n    private handleNewCharButtonClick(): void {\r\n        this.setState({\r\n            showNewCharForm: true\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles when a user chooses to hide the new character form.\r\n     */\r\n    private handleHideModal(): void {\r\n        this.setState({\r\n            showNewCharForm: false\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles when the user selects the 'submit' button for the new character form. Note that\r\n     * this doesn't handle creating the character, this only handles the resulting behavior. This is primarily\r\n     * because we need to prevent the default form submission behavior of the character sheet. Following this,\r\n     * it makes sense to keep the continguous functional behavior in one place, the form logic.\r\n     */\r\n    private handleSubmitNewCharForm(): void {\r\n        this.setState({\r\n            showNewCharForm: false\r\n        });\r\n        this.UpdateCharacterData();\r\n    }\r\n\r\n    /**\r\n     * Creates a new instances of this component.\r\n     * @param props The input parameters for this component.\r\n     */\r\n    public constructor(props: ICharacterManagerProps) {\r\n        super(props);\r\n        this.state = {\r\n            currentCharacterData: undefined,\r\n            allCharactersData: [],\r\n            isLoading: true,\r\n            showNewCharForm: false\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Renders this object in the visual display.\r\n     */\r\n    public render() {\r\n        let allCharacterNames: string[] = this.state.allCharactersData.map(acn => acn.Name);\r\n\r\n        return (\r\n            <div className=\"character-manager\">\r\n                <NewCharacterForm\r\n                    existingCharacterNames={allCharacterNames}\r\n                    show={this.state.showNewCharForm}\r\n                    onHideModal={this.handleHideModal.bind(this)}\r\n                    onFormSubmission={this.handleSubmitNewCharForm.bind(this)}\r\n                />\r\n                <CurrentCharacterStatus\r\n                    currentCharacterData={this.state.currentCharacterData}\r\n                />\r\n                <CharacterSelector\r\n                    newCharacterButtonCallback={this.handleNewCharButtonClick.bind(this)}\r\n                    characterSelectedCallback={this.handleCharacterSelected.bind(this)}\r\n                    allCharacterData={this.state.allCharactersData}\r\n                    isLoading={this.state.isLoading}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    /**\r\n     * Handles when the component has successfully mounted.\r\n     */\r\n    public componentDidMount() {\r\n        this.UpdateCharacterData();\r\n    }\r\n\r\n    /**\r\n     * Handles when a character button is selected.\r\n     * @param charData The character data for the character that was just selected.\r\n     */\r\n    private handleCharacterSelected(charData: PlayerCharacterData): void {\r\n        PlayerInventoryService.SetCurrentCharacter(charData.Name);\r\n        this.UpdateCharacterData();\r\n    }\r\n\r\n    /**\r\n     * Updates the character data visible in this component. Gets information from database to show this\r\n     * user's characters.\r\n     */\r\n    private UpdateCharacterData(): void {\r\n        PlayerInventoryService.FetchAllCharacters().then(characterData => {\r\n            let currentCharacter: PlayerCharacterData | undefined = undefined;\r\n            let characterName: string | null = PlayerInventoryService.GetCurrentCharacterName();\r\n\r\n            if (characterData) {\r\n                currentCharacter = characterData.find(c => c.Name === characterName);\r\n            }\r\n\r\n            this.setState({\r\n                currentCharacterData: currentCharacter,\r\n                allCharactersData: characterData,\r\n                isLoading: false\r\n            });\r\n\r\n            // Modify our existing singleton that tracks our current character selection.\r\n            CharacterStateManager.GetInstance().ChangeCharacter(currentCharacter);\r\n        });\r\n    }\r\n}\r\n","import React, { ChangeEvent } from 'react';\r\nimport { MoneyDisplay } from './MoneyDisplay';\r\nimport { MoneyAdjustCallback } from '../Types/MoneyAdjustCallback';\r\nimport { StylizedModal } from '../../Utilities/React/StylizedModal';\r\n\r\ninterface IMoneyAdjustModalProps {\r\n    show: boolean;\r\n    hideModal: () => void;\r\n    playerCopper: number;\r\n    moneyAdjustCallback: MoneyAdjustCallback;\r\n    showAsProcessing: boolean;\r\n}\r\n\r\ninterface IMoneyAdjustModalState {\r\n    copperAdjustment: number;\r\n}\r\n\r\nexport class MoneyAdjustModal extends React.Component<IMoneyAdjustModalProps, IMoneyAdjustModalState> {\r\n    public constructor(props: IMoneyAdjustModalProps) {\r\n        super(props);\r\n        this.state = {\r\n            copperAdjustment: 0\r\n        };\r\n    }\r\n\r\n    private HandleCopperSubmit(event: React.FormEvent<HTMLFormElement>) {\r\n        event.preventDefault();\r\n        let adjustedCopper: number = this.props.playerCopper + this.state.copperAdjustment;\r\n        this.props.moneyAdjustCallback(adjustedCopper);\r\n\r\n        this.setState({\r\n            copperAdjustment: 0\r\n        });\r\n    }\r\n\r\n    private HandleCopperInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event.target?.value;\r\n\r\n        // https://stackoverflow.com/questions/23437476/in-typescript-how-to-check-if-a-string-is-numeric\r\n        if (input) {\r\n            let inputAsNumber: number = Number(input);\r\n            if (!isNaN(inputAsNumber)) {\r\n                this.setState({\r\n                    copperAdjustment: inputAsNumber\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let adjustedCopper: number = this.props.playerCopper + this.state.copperAdjustment;\r\n\r\n        return (\r\n            <StylizedModal\r\n                show={this.props.show}\r\n                onHide={this.props.hideModal}\r\n                title=\"Money Adjustment\"\r\n                isLoading={this.props.showAsProcessing}\r\n                onEnterModal={undefined}>\r\n                <div className=\"money-adjustment-container\">\r\n                    <MoneyDisplay\r\n                        copperCount={adjustedCopper}\r\n                        hideEmptyCurrencies={false}\r\n                    />\r\n                    <form\r\n                        className=\"money-adjustment-form\"\r\n                        onSubmit={this.HandleCopperSubmit.bind(this)}>\r\n                        <label>Money Changes (in copper, positive or negative)</label>\r\n                        <input\r\n                            type=\"number\"\r\n                            id=\"copperAdjustment\"\r\n                            name=\"copperAdjustment\"\r\n                            min={-this.props.playerCopper}\r\n                            onChange={this.HandleCopperInput.bind(this)} />\r\n                        <input\r\n                            type=\"submit\"\r\n                            value=\"Adjust that money\"\r\n                        />\r\n                    </form>\r\n                </div>\r\n            </StylizedModal>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { IItemKey } from '../../ItemData/Interfaces/IItemKey';\r\nimport { DnDConstants } from '../../Utilities/Classes/DndConstants';\r\nimport { Tooltip, OverlayTrigger } from 'react-bootstrap';\r\nimport { ItemSource } from '../../ItemData/Classes/ItemSource';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\n\r\ninterface IAttunementCountProps {\r\n    charData: PlayerCharacterData | undefined;\r\n}\r\n\r\nexport function AttunementCount(props: IAttunementCountProps) {\r\n    let items: IItemKey[] = props.charData?.Items ?? [];\r\n\r\n    let attunedItemKeys: IItemKey[] = DnDConstants.GetAttunedItems(items);\r\n    let attunedItems: IItem[] = attunedItemKeys.map(i => ItemSource.GetItem(i)).filter(i => i !== undefined) as IItem[];\r\n    let itemTitles: string[] = attunedItems.map(i => i.title);\r\n    let itemTitlesDisplay: string = itemTitles.join(\", \");\r\n\r\n    return (\r\n        <OverlayTrigger\r\n            placement='bottom'\r\n            delay={{ show: 0, hide: 400 }}\r\n            overlay={\r\n                <Tooltip id=\"Attuned Items List\">\r\n                    <span style={{fontWeight: \"bold\"}}>\r\n                        Remaining Attunement Slots\r\n                    </span>\r\n                    <br />\r\n                    <br />\r\n                    <span style={{ fontWeight: \"bold\" }}>\r\n                        Attuned Items:\r\n                    </span>\r\n                    <br />\r\n                    {itemTitlesDisplay}\r\n                </Tooltip>\r\n            }>\r\n            <div className=\"character-info-attunement\">\r\n\r\n                <img\r\n                    alt=\"attunement icon\"\r\n                    className=\"char-display-attunement-icon\"\r\n                    src='./images/Item_Shop/ItemCards/Icons/Button_Attune.png'\r\n                />\r\n                {DnDConstants.GetRemainingAttunementSlots(items)}\r\n            </div>\r\n        </OverlayTrigger>\r\n    )\r\n}\r\n","import '../CharacterInfo.css';\r\n\r\nimport React from 'react';\r\nimport { LoadingState } from '../../Utilities/Enums/LoadingState';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\nimport { MoneyAdjustModal } from './MoneyAdjustModal';\r\nimport { MoneyDisplay } from './MoneyDisplay';\r\nimport { useState } from 'react';\r\nimport { useLoadingState } from '../../Utilities/Hooks/useLoadingState';\r\nimport { useCharData } from '../../Utilities/Hooks/useCharData';\r\nimport { MoneyAdjustCallback } from '../Types/MoneyAdjustCallback';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\nimport { AttunementCount } from './AttunementCount';\r\n\r\ninterface ICharacterInfoDisplayProps {\r\n    loginState: LoginState;\r\n}\r\n\r\nexport function CharacterInfoDisplay(props: ICharacterInfoDisplayProps) {\r\n    const [showMoneyAdjustModal, setShowMoneyAdjustModal] = useState(false);\r\n    const [showMoneyAdjustModalProcessing, setShowMoneyAdjustModalProcessing] = useState(false);\r\n    const loadingState = useLoadingState(props.loginState);\r\n    const charData = useCharData(loadingState);\r\n\r\n    /**\r\n     * Handler for when the user requests that the money display modal be shown via a callback.\r\n     */\r\n    const handleShowMoneyAdjust = function () {\r\n        setShowMoneyAdjustModal(true);\r\n    };\r\n\r\n    /**\r\n     * Handler for when the user requests that the modal be closed via a callback.\r\n     */\r\n    const handleHideMoneyAdjust = function () {\r\n        setShowMoneyAdjustModal(false);\r\n    }\r\n\r\n    /**\r\n     * Handler for when the user requests that the character money be adjusted by some amount.\r\n     * @param newCopperTotal The new copper total to modify for the character.\r\n     */\r\n    const handleAdjustCopper: MoneyAdjustCallback = function (newCopperTotal: number) {\r\n        if (charData) {\r\n            charData.Copper = newCopperTotal;\r\n\r\n            setShowMoneyAdjustModalProcessing(true);\r\n\r\n            CharacterStateManager.GetInstance().UploadCharacterData(charData).then(() => {\r\n                setShowMoneyAdjustModalProcessing(false);\r\n                setShowMoneyAdjustModal(false);\r\n            });\r\n        }\r\n    }\r\n\r\n    // Set the default content that will be shown. Note that this is overridden in the event that the user\r\n    // either is not logged in, or does not have any characters.\r\n    let content: JSX.Element = (\r\n        <div className=\"character-info-content\">\r\n            <LoadingPlaceholder\r\n                showSpinner={loadingState === LoadingState.Loading}\r\n                role=\"Character info status\">\r\n                <AttunementCount charData={charData} />\r\n                <MoneyAdjustModal\r\n                    show={showMoneyAdjustModal}\r\n                    hideModal={handleHideMoneyAdjust}\r\n                    playerCopper={charData?.Copper ?? 0}\r\n                    showAsProcessing={showMoneyAdjustModalProcessing}\r\n                    moneyAdjustCallback={handleAdjustCopper}\r\n                />\r\n                <span className=\"character-info-name\">\r\n                    {charData?.Name ?? \"\"}\r\n                </span>\r\n                <MoneyDisplay\r\n                    copperCount={charData?.Copper ?? 0}\r\n                    hideEmptyCurrencies={false}\r\n                />\r\n                <button\r\n                    className=\"character-money-add\"\r\n                    onClick={handleShowMoneyAdjust}>\r\n                    +\r\n                    </button>\r\n            </LoadingPlaceholder>\r\n        </div>\r\n    );\r\n\r\n    // Override the default content if the user either doesn't have any characters or is not logged in.\r\n    switch (loadingState) {\r\n        case LoadingState.NoCharacters:\r\n            content = GetNoCharsContent();\r\n            break;\r\n        case LoadingState.Anonymous:\r\n            content = GetAnonContent();\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n\r\n    // Render the element.\r\n    return (\r\n        <div className=\"character-info-container\">\r\n            {content}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetAnonContent(): JSX.Element {\r\n    return (\r\n        <div>\r\n            Logged Out\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction GetNoCharsContent(): JSX.Element {\r\n    return (\r\n        <div>\r\n            No Characters\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { CarpetMap } from './CarpetMap';\r\nimport { ItemCard } from '../../ItemData/React/ItemCard';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { PurchaseClick } from '../../ItemData/Types/CardButtonCallbackTypes/PurchaseClick';\r\nimport { CardInteractions } from '../../ItemData/Enums/CardInteractions';\r\n\r\n/**\r\n * @description An interface used to represent the properties required to display this class.\r\n * @param itemDetails The list of items that will be represented on this carpet.\r\n * @param onItemClick The function that will be called-back to when an item is clicked on.\r\n * @param rugBorderSource The source image location for the rug border.\r\n */\r\ninterface IBazaarCarpetProps {\r\n    carpetMap: CarpetMap;\r\n    onItemClick: ItemClick;\r\n    onPurchaseClick: PurchaseClick;\r\n    availablePlayerCopper: number | undefined;\r\n}\r\n\r\ninterface IBazaarCarpetState {\r\n}\r\n\r\n/**\r\n * @description Returns an instance of this component, BazaarCarpet.\r\n * @param props The list of properties needed to render this item.\r\n */\r\nexport class BazaarCarpet extends React.Component<IBazaarCarpetProps, IBazaarCarpetState>\r\n{\r\n    /**\r\n     * @description Gets the shop items as ShopItem elements.\r\n     * @param itemDetails The list of item details to represent the items on this carpet.\r\n     * @param onItemClick The click event-handler for items.\r\n     * @see ShopItem\r\n     */\r\n    private getShopItems() {\r\n        return this.props.carpetMap.items.map((item) => {\r\n            return (\r\n                <ItemCard\r\n                    itemDetails={item}\r\n                    onItemClick={this.props.onItemClick}\r\n                    onAttackButton={undefined}\r\n                    onPurchaseButton={this.props.onPurchaseClick}\r\n                    onAttuneButton={undefined}\r\n                    onUnattuneButton={undefined}\r\n                    onStageButton={undefined}\r\n                    onUnstageButton={undefined}\r\n                    onBagButton={undefined}\r\n                    cardInteractions={[CardInteractions.Purchase]}\r\n                    showCardCost={true}\r\n                    availablePlayerCopper={this.props.availablePlayerCopper}\r\n                    availableAttunementSlots={undefined}\r\n                />\r\n            );\r\n        });\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className='shop-section'>\r\n                <h2 className='pixel-font' style={{ fontSize: 18 }}>{this.props.carpetMap.rugName}</h2>\r\n                <div\r\n                    className='shop-rug'\r\n                    style={{ borderImageSource: `${this.props.carpetMap.rugBorderSource}` }}>\r\n                    {this.getShopItems()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { CarpetBorder } from '../Enums/CarpetBorder';\r\n\r\n/**\r\n * @description A class used to represent a 'carpet'. A carpet is a section of an item shop, where\r\n * similar items are grouped together.\r\n */\r\nexport class CarpetMap {\r\n    /**\r\n     * @description The name to display above the rug.\r\n     */\r\n    rugName: string = \"\";\r\n\r\n    /**\r\n     * @description The items that are contained within the rug.\r\n     */\r\n    items: IItem[] = [];\r\n\r\n    /**\r\n     * @description The border source image to display around the rug. The syntax for this should be:\r\n     * \"url(/images/Item_Shop/Items/Rugs/purplerug.png)\"\r\n     * \r\n     * where the root folder is the public folder.\r\n     */\r\n    rugBorderSource: string = \"\";\r\n\r\n    /**\r\n     * Creates a new instance of this object.\r\n     * @param borderSource The location of the border image to use for this carpet.\r\n     * @param rugName The name to display above the carpet.\r\n     * @param items The items that will be displayed on this carpet.\r\n     */\r\n    public constructor(borderSource: CarpetBorder, rugName: string, items: IItem[])\r\n    {\r\n        this.rugName = rugName;\r\n        this.rugBorderSource = borderSource;\r\n        this.items = items;\r\n    }\r\n}\r\n","import '../ItemShop.css';\r\nimport React from 'react';\r\n\r\nimport { IItem } from \"../../ItemData/Interfaces/IItem\";\r\nimport { BazaarCarpet } from './BazaarCarpet';\r\nimport { ItemWondrous } from '../../ItemData/Classes/ItemWondrous';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { ItemDetailsModal } from '../../ItemData/React/ItemDetailsModal';\r\nimport { PurchaseClick } from '../../ItemData/Types/CardButtonCallbackTypes/PurchaseClick';\r\nimport { CarpetMap } from './CarpetMap';\r\nimport { CarpetBorder } from '../Enums/CarpetBorder';\r\nimport { ItemType } from '../../ItemData/Enums/ItemType';\r\nimport { GroupItemsByType } from '../../ItemData/Classes/ItemUtilityFunctions';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { ItemShopData } from '../Types/ItemShopData';\r\n\r\n/**\r\n * @description\r\n * Describes the properties that are passed into this class.\r\n */\r\ninterface IItemShopProps {\r\n    shopData: ItemShopData;\r\n    charData: PlayerCharacterData | undefined;\r\n};\r\n\r\n/**\r\n * @description Describes the state that is maintained by this object.\r\n * @param showItemDialog A boolean value to describe whether the item dialog (modal) is displayed at any\r\n * given point.\r\n * @param itemDetails A set of details that describe the currently selected item. This is used to populate\r\n * the modal that appears.\r\n */\r\ninterface IItemShopState {\r\n    showItemDialog: boolean;\r\n    itemDetails: IItem;\r\n};\r\n\r\n/**\r\n * @description\r\n * Represents an item shop! This is a full-screen application that is used to 'browse' some digital items.\r\n */\r\nexport class ItemShop extends React.Component<IItemShopProps, IItemShopState> {\r\n    /**\r\n     * @description Creates a new instance of @see ItemShop .\r\n     * @param props The properties required to instantiate this class.\r\n     */\r\n    constructor(props: IItemShopProps) {\r\n        super(props);\r\n        this.state = {\r\n            showItemDialog: false,\r\n            itemDetails: new ItemWondrous(),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @description Handles an item click event.\r\n     * @param item The item details that are provided as a result of the click event (this is a set of\r\n     * properties that represent the item that was clicked).\r\n     */\r\n    onItemClick(item: IItem) {\r\n        this.setState({\r\n            itemDetails: item,\r\n            showItemDialog: true\r\n        });\r\n    }\r\n\r\n    onItemDialogClose() {\r\n        this.setState({\r\n            showItemDialog: false\r\n        });\r\n    }\r\n\r\n    private async HandleItemPurchase(item: IItem): Promise<void> {\r\n        if (this.props.charData) {\r\n            if (this.props.charData.Copper >= item.itemCopperCost) {\r\n                this.props.charData.Copper -= item.itemCopperCost;\r\n                this.props.charData.Items.push(item);\r\n\r\n                await CharacterStateManager.GetInstance().UploadCharacterData(this.props.charData);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description Gets a list of bazaar carpets for display.\r\n     * @param onItemClick The click event-handler for item clicks.\r\n     */\r\n    getBazaarCarpets(onItemClick: ItemClick, onItemPurchase: PurchaseClick): JSX.Element[] {\r\n        let carpetMaps: JSX.Element[] = [];\r\n        let organizedItems: Map<ItemType, IItem[]>;\r\n        organizedItems = GroupItemsByType(this.props.shopData.Items);\r\n\r\n        // Convert the array into something we can run map() on.\r\n        let mappedKeys: ItemType[] = Array.from(organizedItems.keys());\r\n\r\n        mappedKeys.forEach(itemType => {\r\n            let items: IItem[] | undefined = organizedItems.get(itemType);\r\n\r\n            if (items && items.length > 0) {\r\n                // We intentionally organized these by item type. Assume that if we grab just the first item's\r\n                // carpet value, that applies to the rest.\r\n                let carpetType: CarpetBorder = items[0].GetCarpetType();\r\n\r\n                carpetMaps.push(\r\n                    <BazaarCarpet\r\n                        onPurchaseClick={onItemPurchase}\r\n                        carpetMap={new CarpetMap(carpetType, itemType, items)}\r\n                        onItemClick={onItemClick}\r\n                        availablePlayerCopper={this.props.charData?.Copper}\r\n                    />\r\n                );\r\n            }\r\n        });\r\n\r\n        return carpetMaps;\r\n    }\r\n\r\n    /**\r\n     * @description Renders an instance of this class.\r\n     */\r\n    render() {\r\n        return (\r\n            <div className=\"ItemShop\">\r\n                <h1>{this.props.shopData.Name}</h1>\r\n                <div className='shopkeeper-area'>\r\n                    <img src='./images/Item_Shop/brazier-lit.gif' alt=\"animated left brazier\" />\r\n                    <img src='./images/Item_Shop/shopkeeper.gif' alt=\"shopkeeper\" />\r\n                    <img src='./images/Item_Shop/brazier-lit.gif' alt=\"animated left brazier\" />\r\n                </div>\r\n                <div className='bazaar-area'>\r\n                    {this.getBazaarCarpets(this.onItemClick.bind(this), this.HandleItemPurchase.bind(this))}\r\n                </div>\r\n                <ItemDetailsModal\r\n                    show={this.state.showItemDialog}\r\n                    hideModal={this.onItemDialogClose.bind(this)}\r\n                    itemDetails={this.state.itemDetails}\r\n                    removeCallback={undefined}\r\n                    handleUpdatedItemNotes={undefined}\r\n                    />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import { IItem } from \"../Interfaces/IItem\";\r\nimport { ItemType } from \"../Enums/ItemType\";\r\n\r\nexport function GroupItemsByType(items: IItem[]): Map<ItemType, IItem[]> {\r\n    let organizedItems: Map<ItemType, IItem[]> = new Map();\r\n    Object.values(ItemType).forEach(itemType => {\r\n        let filteredItems: IItem[] = items.filter(item => item.type === itemType);\r\n        if (filteredItems.length > 0) {\r\n            organizedItems.set(itemType, filteredItems);\r\n        }\r\n    });\r\n\r\n    return organizedItems;\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { ItemShopData } from '../Types/ItemShopData';\r\nimport { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\nimport { ItemShop } from '../../Shops/React/ItemShop';\r\nimport { useCharData } from '../../Utilities/Hooks/useCharData';\r\nimport { useLoadingState } from '../../Utilities/Hooks/useLoadingState';\r\nimport { LoadingState } from '../../Utilities/Enums/LoadingState';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\n\r\ninterface IShopProps {\r\n    loginState: LoginState;\r\n}\r\n\r\nexport function Shop(props: IShopProps) {\r\n    const [shopInfo, setShopInfo] = useState<ItemShopData | undefined>(undefined);\r\n    const location = useLocation();\r\n    const loadingState = useLoadingState(props.loginState);\r\n    const charData = useCharData(loadingState);\r\n\r\n    /**\r\n     * Runs only when the URL has changed. Updates the rendered store for this page.\r\n     */\r\n    useEffect(() => {\r\n        let shopRegex: RegExp = /\\/shop\\/([-_A-Z0-9]+)/i;\r\n        let shopMatch: RegExpExecArray | null = shopRegex.exec(location.pathname);\r\n        let shopId: string | undefined = undefined;\r\n\r\n        if (shopMatch && shopMatch[1]) {\r\n            shopId = shopMatch[1];\r\n            GameRoomService.GetShopByShopId(shopId).then(shop => {\r\n                setShopInfo(shop);\r\n            });\r\n        }\r\n    }, [location.pathname])\r\n\r\n    return (\r\n        <LoadingPlaceholder showSpinner={loadingState === LoadingState.Loading} role=\"Shop Loading Status\">\r\n            <div className=\"shop-page\">\r\n                {GetShop(shopInfo, charData)}\r\n            </div>\r\n        </LoadingPlaceholder>\r\n    );\r\n}\r\n\r\nfunction GetShop(shopData: ItemShopData | undefined, charData: PlayerCharacterData | undefined): JSX.Element {\r\n    let element: JSX.Element;\r\n    element = (\r\n        <div>\r\n        </div>\r\n    );\r\n\r\n    if (shopData) {\r\n        element = (\r\n            <ItemShop\r\n                shopData={shopData}\r\n                charData={charData}\r\n            />\r\n        );\r\n    }\r\n\r\n    return element;\r\n}\r\n\r\n// http://localhost:3000/#/shop/NfyJ92g0JmXl5Ffru0oo\r\n","export enum ChestState {\r\n    ChestFalling = \"ChestFalling\",\r\n    ChestReadyToOpen = \"ChestReadyToOpen\",\r\n    ChestOpening = \"ChestOpening\"\r\n}\r\n","import React from 'react';\r\nimport { ChestState } from '../Enums/ChestState';\r\nimport { ChestClick } from '../Types/ChestClick';\r\n\r\nexport interface IChestButtonProps {\r\n    state: ChestState;\r\n    onClick: ChestClick;\r\n}\r\n\r\nexport function ChestButton(props: IChestButtonProps) {\r\n    let chestImage: string = GetChestImage(props.state);\r\n    let chestCanClick: boolean = props.state === ChestState.ChestReadyToOpen;\r\n\r\n    return (\r\n        <button\r\n            className={`chest-button`}\r\n            disabled={!chestCanClick}\r\n            onClick={props.onClick}>\r\n            <img src={chestImage} />\r\n        </button>\r\n    )\r\n}\r\n\r\nfunction GetChestImage(chestState: ChestState): string {\r\n    switch (chestState) {\r\n        case ChestState.ChestFalling: return \"./images/Chests/WoodenStaticChest.png\";\r\n        case ChestState.ChestReadyToOpen: return \"./images/Chests/WoodenBouncingChest.gif\";\r\n        case ChestState.ChestOpening: return \"./images/Chests/WoodenOpeningChest.gif\";\r\n        default: return \"./images/Chests/WoodenStaticChest.png\";\r\n    }\r\n}\r\n","import React, { useState } from 'react';\r\nimport { AddCopperClick } from '../Types/AddCopperClick';\r\nimport { MoneyDisplay } from '../../CharacterInfo/React/MoneyDisplay';\r\n\r\nexport interface IAddCopperSlider {\r\n    availableCopper: number;\r\n    handleAddCopper: AddCopperClick;\r\n}\r\n\r\nexport function AddCopperSlider(props: IAddCopperSlider) {\r\n    const [copperToTake, setCopperToTake] = useState(0);\r\n\r\n    function HandleSetCopperToTake(rangeElement: React.ChangeEvent<HTMLInputElement>) {\r\n        if (rangeElement && rangeElement.target && rangeElement.target.valueAsNumber) {\r\n            setCopperToTake(rangeElement.target.valueAsNumber);\r\n        }\r\n    }\r\n\r\n    function HandleClickTakeCopper() {\r\n        props.handleAddCopper(copperToTake);\r\n        setCopperToTake(0);\r\n    }\r\n\r\n    return (\r\n        <div className=\"add-copper-slider\">\r\n            <button onClick={HandleClickTakeCopper}>\r\n                Take:\r\n                <MoneyDisplay\r\n                copperCount={copperToTake}\r\n                hideEmptyCurrencies={false}\r\n                />\r\n            </button>\r\n            <input\r\n                type=\"range\"\r\n                name=\"copper to take\"\r\n                min={0} max={props.availableCopper}\r\n                onChange={HandleSetCopperToTake}/>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { ItemCard } from '../../ItemData/React/ItemCard';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { MoneyDisplay } from '../../CharacterInfo/React/MoneyDisplay';\r\nimport { ChestState } from '../Enums/ChestState';\r\nimport { AddCopperClick } from '../Types/AddCopperClick';\r\nimport { BagClick } from '../../ItemData/Types/CardButtonCallbackTypes/BagClick';\r\nimport { AddCopperSlider } from './AddCopperSlider';\r\n\r\nexport interface IChestContentsProps {\r\n    items: IItem[];\r\n    copperCount: number;\r\n    charData: PlayerCharacterData | undefined;\r\n    handleItemClick: ItemClick;\r\n    handleBagClick: BagClick;\r\n    handleAddCopper: AddCopperClick;\r\n    state: ChestState;\r\n}\r\n\r\nconst _delayBetweenCards: number = 750;\r\nconst _delayBetweenAddingMoney: number = 250;\r\n\r\nexport function ChestContents(props: IChestContentsProps) {\r\n    const [currentCopperCount, setCurrentCopperCount] = useState(0);\r\n    const [incrementingCopper, setIncrementingCopper] = useState(false);\r\n    const [enableSlider, setEnableSlider] = useState(false);\r\n    \r\n    let secondsToAddCopper: number = Math.min(Math.log(props.copperCount), 2.0);\r\n    let msToAddCopper: number = Math.floor(secondsToAddCopper * 1000);\r\n    let numberOfIncrements: number = Math.floor(msToAddCopper /_delayBetweenAddingMoney);\r\n    let copperToIncrement: number = Math.floor(props.copperCount / numberOfIncrements);\r\n\r\n    ChestItemStatics.ChestItemAppearAudio.volume = 0.1;\r\n    ChestItemStatics.ChestCoinAudio.volume = 0.1;\r\n\r\n    // Handle immediately displaying some things once this component has loaded. Only once though!\r\n    useEffect(() => {\r\n        for(let i: number = 0; i < props.items.length; i++) {\r\n            let soundDelay = _delayBetweenCards * i;\r\n            setTimeout(() => ChestItemStatics.ChestItemAppearAudio.play(), soundDelay);\r\n        }\r\n\r\n        // Don't start adding money until we've finished display ALL THE CARDS!\r\n        let timeToAddMoolah = props.items.length * _delayBetweenCards;\r\n        let timeToEnableSlider = timeToAddMoolah + msToAddCopper + _delayBetweenCards;\r\n        setTimeout(() => setIncrementingCopper(true), timeToAddMoolah);\r\n        setTimeout(() => setEnableSlider(true), timeToEnableSlider);\r\n    }, []);\r\n\r\n    // Increment that copper real slow-like. It adds drama!\r\n    useEffect(() => {\r\n        if (currentCopperCount < props.copperCount && incrementingCopper) {\r\n            let newCopperCount = Math.min(props.copperCount, currentCopperCount + copperToIncrement);\r\n            setTimeout(() => {\r\n                setCurrentCopperCount(newCopperCount)\r\n                ChestItemStatics.ChestCoinAudio.play();\r\n            }, _delayBetweenAddingMoney);\r\n        }\r\n    }, [currentCopperCount, incrementingCopper]);\r\n\r\n    // This is a little funny, I don't particularly like it. If we've already enabled the slider, and\r\n    // we now have a different copper value coming from our props, that means that the copper count has\r\n    // changed and we need to reflect that. If we don't include this if, then we statically set the copper\r\n    // count as soon as this component mounts, which we don't want.\r\n    useEffect(() => {\r\n        if (enableSlider) {\r\n            setCurrentCopperCount(props.copperCount);\r\n        }\r\n    }, [props.copperCount]);\r\n\r\n\r\n    let slider: JSX.Element = (<div/>);\r\n    if (enableSlider) {\r\n        slider = (\r\n            <AddCopperSlider\r\n                availableCopper={props.copperCount}\r\n                handleAddCopper={props.handleAddCopper}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"chest-contents\">\r\n            <div className=\"chest-items\">\r\n                {GetItemCards(props.items, props.handleItemClick, props.handleBagClick)}\r\n            </div>\r\n            <MoneyDisplay\r\n                copperCount={currentCopperCount}\r\n                hideEmptyCurrencies={true}\r\n            />\r\n            {slider}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nfunction GetItemCards(items: IItem[], handleItemClick: ItemClick, handleBagClick: BagClick): JSX.Element[] {\r\n    let itemElements: JSX.Element[] = [];\r\n\r\n    items.forEach((item, index) => {\r\n        let animationDelay = _delayBetweenCards * index;\r\n\r\n        itemElements.push(\r\n            <div className=\"fadingCardContainer\"\r\n                style={{\r\n                    animationDelay: `${animationDelay}ms`\r\n                }}>\r\n                <ItemCard\r\n                    key={index + item.title}\r\n\r\n                    itemDetails={item}\r\n                    onItemClick={handleItemClick}\r\n                    onAttackButton={undefined}\r\n                    onPurchaseButton={undefined}\r\n                    onStageButton={undefined}\r\n                    onUnstageButton={undefined}\r\n                    onAttuneButton={undefined}\r\n                    onUnattuneButton={undefined}\r\n                    onBagButton={handleBagClick}\r\n                    cardInteractions={[]}\r\n                    showCardCost={false}\r\n                    availablePlayerCopper={undefined}\r\n                    availableAttunementSlots={undefined}\r\n                />\r\n            </div>\r\n        );\r\n    });\r\n\r\n    return itemElements;\r\n}\r\n\r\nclass ChestItemStatics {\r\n    public static readonly ChestItemAppearAudio = new Audio(\"./sounds/chestItemAppear.wav\");\r\n    public static readonly ChestCoinAudio = new Audio(\"./sounds/chestCoin.wav\");\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { ChestData } from '../Types/ChestData';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { ChestState } from '../Enums/ChestState';\r\nimport { ChestButton } from './ChestButton';\r\nimport { ChestContents } from './ChestContents';\r\nimport { ItemDetailsModal } from '../../ItemData/React/ItemDetailsModal';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemWondrous } from '../../ItemData/Classes/ItemWondrous';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\nimport { CharacterStateManager } from '../../FirebaseAuth/Classes/CharacterStateManager';\r\nimport { BagClick } from '../../ItemData/Types/CardButtonCallbackTypes/BagClick';\r\nimport { DnDConstants } from '../../Utilities/Classes/DndConstants';\r\nimport { Toast } from 'react-bootstrap';\r\nimport { AddCopperClick } from '../Types/AddCopperClick';\r\n\r\nexport interface IChestDisplayProps {\r\n    chestData: ChestData;\r\n    charData: PlayerCharacterData | undefined;\r\n}\r\n\r\nexport function ChestDisplay(props: IChestDisplayProps) {\r\n    const [chestState, setChestState] = useState(ChestState.ChestFalling);\r\n    const [showDetailsModal, setShowDetailsModal] = useState(false);\r\n    const [focusedItem, setFocusedItem] = useState<IItem>(new ItemWondrous());\r\n    const [availableItems, setAvailableItems] = useState<IItem[]>(props.chestData.Items);\r\n    const [availableCoppper, setAvailableCopper] = useState(props.chestData.CopperInChest);\r\n    const [toastText, setToastText] = useState<string | undefined>(undefined);\r\n    const [showToast, setShowToast] = useState(false);\r\n\r\n    ChestDisplayStatics.FallingChestAudio.volume = 0.1;\r\n    ChestDisplayStatics.LandedChestAudio.volume = 0.1;\r\n    ChestDisplayStatics.OpeningChestAudio.volume = 0.1;\r\n    ChestDisplayStatics.ChestBagItemAudio.volume = 0.1;\r\n    \r\n    // The chest should be \"falling\" once in the room. Set it to land and be clickable after a set amount of\r\n    // time.\r\n    useEffect(() => {\r\n        ChestDisplayStatics.FallingChestAudio.play();\r\n        setTimeout(() => {\r\n            setChestState(ChestState.ChestReadyToOpen)\r\n            ChestDisplayStatics.LandedChestAudio.play();\r\n        }, 1500);\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (toastText) {\r\n            // display the toast.\r\n            HandleShowToast();\r\n        }\r\n    }, [toastText]);\r\n\r\n    function HandleShowToast(): void {\r\n        setShowToast(true);\r\n    }\r\n\r\n    function HandleHideToast(): void {\r\n        setShowToast(false);\r\n        setToastText(undefined);\r\n    }\r\n\r\n    function HandleChestClick(): void {\r\n        setChestState(ChestState.ChestOpening);\r\n        ChestDisplayStatics.OpeningChestAudio.play();\r\n    };\r\n\r\n    function HandleHideModal(): void {\r\n        setShowDetailsModal(false);\r\n    }\r\n\r\n    function HandleItemClick(item: IItem): void {\r\n        setFocusedItem(item);\r\n        setShowDetailsModal(true);\r\n    }\r\n\r\n    function HandleBagItem(item: IItem): void {\r\n        let cData = props.charData;\r\n        if (cData) {\r\n            // Go ahead and add the item first.\r\n            cData.Items.push(item);\r\n            CharacterStateManager.GetInstance().UploadCharacterData(cData);\r\n            ChestDisplayStatics.ChestBagItemAudio.play();\r\n            setToastText(item.title + \" added to the bag!\");\r\n\r\n            // First, freshen up those items! Otherwise, when we use the JSON stringify to compare, we will\r\n            // get a slew of other, nonsense stuff related to things are not in ItemKey.\r\n            let itemAsFreshKey = DnDConstants.GetItemAsFreshItemKey(item);\r\n            let availableItemsAsFreshKeys = DnDConstants.GetItemsAsFreshKeys(availableItems);\r\n\r\n            // This is a little verbose, but it makes debugging easier!\r\n            let jsonOfItemToRemove: string = JSON.stringify(itemAsFreshKey);\r\n            let allItemsAsJson: string[] = availableItemsAsFreshKeys.map(i => JSON.stringify(i));\r\n\r\n            let itemToRemove = allItemsAsJson.findIndex(i => i === jsonOfItemToRemove);\r\n\r\n            if (itemToRemove > -1) {\r\n                availableItems.splice(itemToRemove, 1);\r\n\r\n                // Force a re-render!\r\n                setAvailableItems(availableItems);\r\n            }\r\n        }\r\n        else {\r\n            setToastText(\"Log in to add items!\");\r\n        }\r\n    }\r\n\r\n    function HandleAddCopper(copperToAdd: number): void {\r\n        let cData = props.charData;\r\n\r\n        if (cData) {\r\n            let newAvailableCopper = Math.max(availableCoppper - copperToAdd, 0);\r\n            ChestDisplayStatics.ChestBagItemAudio.play();\r\n            setToastText(`Added ${copperToAdd} copper to the bag!`);\r\n\r\n            cData.Copper += copperToAdd;\r\n            CharacterStateManager.GetInstance().UploadCharacterData(cData);\r\n\r\n            setAvailableCopper(newAvailableCopper);\r\n        }\r\n        else {\r\n            setToastText(\"Log in to add copper!\");\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"chest-display\">\r\n            <ItemDetailsModal\r\n                show={showDetailsModal}\r\n                hideModal={HandleHideModal}\r\n                removeCallback={undefined}\r\n                handleUpdatedItemNotes={undefined}\r\n                itemDetails={focusedItem}\r\n            />\r\n            {GetChestContents(\r\n                chestState,\r\n                availableCoppper,\r\n                availableItems,\r\n                props.charData,\r\n                HandleItemClick,\r\n                HandleBagItem,\r\n                HandleAddCopper)}\r\n            <ChestButton\r\n                state={chestState}\r\n                onClick={HandleChestClick}\r\n            />\r\n            <div className=\"chest-toast-container\">\r\n                <Toast onClose={HandleHideToast} show={showToast} delay={3000} autohide>\r\n                    <Toast.Body>{toastText}</Toast.Body>\r\n                </Toast>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetChestContents(\r\n    chestState: ChestState,\r\n    copper: number,\r\n    items: IItem[],\r\n    charData: PlayerCharacterData | undefined,\r\n    handleItemClick: ItemClick,\r\n    handleBagClick: BagClick,\r\n    handleAddCopper: AddCopperClick): JSX.Element {\r\n\r\n    let contents = (<div />);\r\n    if (chestState === ChestState.ChestOpening) {\r\n        contents = (\r\n            <ChestContents\r\n                items={items}\r\n                copperCount={copper}\r\n                charData={charData}\r\n                handleItemClick={handleItemClick}\r\n                handleBagClick={handleBagClick}\r\n                handleAddCopper={handleAddCopper}\r\n                state={chestState}\r\n            />\r\n        )\r\n    }\r\n\r\n    return contents;\r\n}\r\n\r\nclass ChestDisplayStatics {\r\n    public static readonly FallingChestAudio = new Audio(\"./sounds/chestFalling.wav\");\r\n    public static readonly LandedChestAudio = new Audio(\"./sounds/chestLand.wav\");\r\n    public static readonly OpeningChestAudio = new Audio(\"./sounds/chestOpening.wav\");\r\n    public static readonly ChestBagItemAudio = new Audio(\"./sounds/chestBagItem.wav\");\r\n} \r\n","import \"../ChestDisplay.css\"\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ChestData } from '../Types/ChestData';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\nimport { useCharData } from '../../Utilities/Hooks/useCharData';\r\nimport { useLoadingState } from '../../Utilities/Hooks/useLoadingState';\r\nimport { LoadingState } from '../../Utilities/Enums/LoadingState';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\nimport { PlayerCharacterData } from '../../FirebaseAuth/Types/PlayerCharacterData';\r\nimport { ChestDisplay } from './ChestDisplay';\r\n\r\nexport interface IChestPageProps {\r\n    loginState: LoginState;\r\n}\r\n\r\nexport function ChestPage(props: IChestPageProps) {\r\n    const [chestInfo, setChestInfo] = useState<ChestData | undefined>(undefined);\r\n    const loadingState = useLoadingState(props.loginState);\r\n    const location = useLocation();\r\n    const charData = useCharData(loadingState);\r\n\r\n    /**\r\n     * Runs only when the URL has changed. Updates the rendered store for this page.\r\n     */\r\n    useEffect(() => {\r\n        let chestRegex: RegExp = /\\/chest\\/([-_A-Z0-9]+)/i;\r\n        let chestMatch: RegExpExecArray | null = chestRegex.exec(location.pathname);\r\n        let chestId: string | undefined = undefined;\r\n\r\n        if (chestMatch && chestMatch[1]) {\r\n            chestId = chestMatch[1];\r\n            GameRoomService.GetChestByChestId(chestId).then(chest => {\r\n                setChestInfo(chest);\r\n            });\r\n        }\r\n    }, [location.pathname])\r\n\r\n    return (\r\n        <LoadingPlaceholder showSpinner={loadingState === LoadingState.Loading} role=\"Chest Loading Status\">\r\n            <div className=\"chest-page\">\r\n                {GetChest(chestInfo, charData)}\r\n            </div>\r\n        </LoadingPlaceholder>\r\n    );\r\n}\r\n\r\nfunction GetChest(chestData: ChestData | undefined, charData: PlayerCharacterData | undefined): JSX.Element {\r\n    let element: JSX.Element;\r\n    element = (\r\n        <div>\r\n        </div>\r\n    );\r\n\r\n    if (chestData) {\r\n        element = (\r\n            <ChestDisplay\r\n                chestData={chestData}\r\n                charData={charData}\r\n            />\r\n        );\r\n    }\r\n\r\n    return element;\r\n}\r\n","import '../css/ItemFilter.css';\r\n\r\nimport React, { ChangeEvent, useState } from 'react';\r\nimport { ItemSource } from '../../ItemData/Classes/ItemSource';\r\nimport { ItemCard } from '../../ItemData/React/ItemCard';\r\nimport { StageClick } from '../../ItemData/Types/CardButtonCallbackTypes/StageClick';\r\nimport { CardInteractions } from '../../ItemData/Enums/CardInteractions';\r\nimport { ItemClick } from '../../ItemData/Types/CardButtonCallbackTypes/ItemClick';\r\n\r\ninterface IItemFilterProps {\r\n    onItemStaged: StageClick;\r\n    onItemClick: ItemClick;\r\n}\r\n\r\nexport function ItemFilter(props: IItemFilterProps) {\r\n    const [searchKeywords, setSearchKeywords] = useState<string[]>([]);\r\n\r\n    function HandleSearchInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event?.target.value;\r\n\r\n        // if (input) will not trigger if input is an empty string.\r\n        if (input !== undefined && input !== null) {\r\n            let keywords: string[] = input.split(' ');\r\n            setSearchKeywords(keywords);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"item-filter-container item-staging-container\">\r\n            <h5 className=\"item-staging-title\">Available Items</h5>\r\n            <div className=\"item-filter-search\">\r\n                <input\r\n                    placeholder=\"Search Items\"\r\n                    type=\"text\"\r\n                    className='item-filter'\r\n                    name=\"item filter\"\r\n                    onInput={HandleSearchInput} />\r\n            </div>\r\n            <div className=\"card-staging\">\r\n                {GetCards(searchKeywords, props.onItemStaged, props.onItemClick)}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetCards(keywords: string[], handleStageItem: StageClick, onItemClick: ItemClick): JSX.Element[] {\r\n    let items = ItemSource.SearchItems(keywords);\r\n    return items.map(i => {\r\n        return (\r\n            <ItemCard\r\n                key={i.title}\r\n                itemDetails={i}\r\n                onItemClick={onItemClick}\r\n                onAttackButton={undefined}\r\n                onPurchaseButton={undefined}\r\n                onStageButton={handleStageItem}\r\n                onUnstageButton={undefined}\r\n                onAttuneButton={undefined}\r\n                onUnattuneButton={undefined}\r\n                onBagButton={undefined}\r\n                cardInteractions={[CardInteractions.Stage]}\r\n                showCardCost={true}\r\n                availablePlayerCopper={undefined}\r\n                availableAttunementSlots={undefined}\r\n            />\r\n        );\r\n    });\r\n}\r\n","import \"../css/StagedItemsDisplay.css\";\r\n\r\nimport React from 'react';\r\nimport { UnstageClick } from '../../ItemData/Types/CardButtonCallbackTypes/UnstageClick';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemCard } from '../../ItemData/React/ItemCard';\r\nimport { CardInteractions } from '../../ItemData/Enums/CardInteractions';\r\nimport { ItemClick } from \"../../ItemData/Types/CardButtonCallbackTypes/ItemClick\";\r\n\r\nexport interface IStagedItemsDisplayProps {\r\n    stagedItems: IItem[];\r\n    onItemUnstaged: UnstageClick;\r\n    onItemClick: ItemClick;\r\n}\r\n\r\nexport function StagedItemsDisplay(props: IStagedItemsDisplayProps) {\r\n    return (\r\n        <div className=\"staged-items-display item-staging-container\">\r\n            <h5 className=\"item-staging-title\">Staged Items</h5>\r\n            <div className=\"card-staging\">\r\n                {GetCards(props.stagedItems, props.onItemUnstaged, props.onItemClick)}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetCards(items: IItem[], handleUnstageItem: UnstageClick, onItemClick: ItemClick): JSX.Element[] {\r\n    return items.map(i => {\r\n        return (\r\n            <ItemCard\r\n                itemDetails={i}\r\n                onItemClick={onItemClick}\r\n                onAttackButton={undefined}\r\n                onPurchaseButton={undefined}\r\n                onStageButton={undefined}\r\n                onUnstageButton={handleUnstageItem}\r\n                onAttuneButton={undefined}\r\n                onUnattuneButton={undefined}\r\n                onBagButton={undefined}\r\n                cardInteractions={[CardInteractions.Unstage]}\r\n                showCardCost={true}\r\n                availablePlayerCopper={undefined}\r\n                availableAttunementSlots={undefined}\r\n            />\r\n        );\r\n    });\r\n}\r\n","import '../css/ItemContainerCreator.css';\r\n\r\nimport React, { useState } from 'react';\r\nimport { ItemFilter } from './ItemFilter';\r\nimport { StagedItemsDisplay } from './StagedItemsDisplay';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { DnDConstants } from '../../Utilities/Classes/DndConstants';\r\nimport { ItemDetailsModal } from '../../ItemData/React/ItemDetailsModal';\r\nimport { ItemWondrous } from '../../ItemData/Classes/ItemWondrous';\r\nimport { HandleStagedItemsUpdated } from '../Types/HandleStagedItemsUpdated';\r\n\r\nexport interface IItemContainerCreatorProps {\r\n    handleStagedItemsUpdated: HandleStagedItemsUpdated;\r\n}\r\n\r\nexport function ItemContainerCreator(props: IItemContainerCreatorProps) {\r\n    const [stagedItems, setStagedItems] = useState<IItem[]>([]);\r\n    const [showItemDetails, setShowItemDetails] = useState(false);\r\n    const [focusedItem, setFocusedItem] = useState<IItem>(new ItemWondrous());\r\n\r\n    function HandleHideDetails() {\r\n        setShowItemDetails(false);\r\n    }\r\n\r\n    function HandleShowDetails(item: IItem) {\r\n        setFocusedItem(item);\r\n        setShowItemDetails(true);\r\n    }\r\n\r\n    function HandleStageItem(item: IItem): void {\r\n        let copyOfStagedItems: IItem[] = stagedItems.slice();\r\n        copyOfStagedItems.push(item);\r\n\r\n        setStagedItems(copyOfStagedItems);\r\n        props.handleStagedItemsUpdated(copyOfStagedItems);\r\n    }\r\n\r\n    function HandleUnstageItem(item: IItem): void {\r\n        // First, freshen up those items! Otherwise, when we use the JSON stringify to compare, we will\r\n        // get a slew of other, nonsense stuff related to things are not in ItemKey.\r\n        let itemAsFreshKey = DnDConstants.GetItemAsFreshItemKey(item);\r\n        let stagedFreshItems = DnDConstants.GetItemsAsFreshKeys(stagedItems);\r\n\r\n        // This is a little verbose, but it makes debugging easier!\r\n        let jsonStringToCompare = JSON.stringify(itemAsFreshKey);\r\n        let itemsAsString: string[] = stagedFreshItems.map(i => JSON.stringify(i));\r\n\r\n        let itemToRemove = itemsAsString.findIndex(i => i === jsonStringToCompare);\r\n\r\n        if (itemToRemove > -1) {\r\n            let copyOfStagedItems: IItem[] = stagedItems.slice();\r\n            copyOfStagedItems.splice(itemToRemove, 1);\r\n            setStagedItems(copyOfStagedItems);\r\n            props.handleStagedItemsUpdated(copyOfStagedItems);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"item-container-creator\">\r\n            <ItemDetailsModal\r\n                show={showItemDetails}\r\n                hideModal={HandleHideDetails}\r\n                itemDetails={focusedItem}\r\n                removeCallback={undefined}\r\n                handleUpdatedItemNotes={undefined}\r\n            />\r\n            <ItemFilter\r\n                onItemStaged={HandleStageItem}\r\n                onItemClick={HandleShowDetails}\r\n            />\r\n            <StagedItemsDisplay\r\n                stagedItems={stagedItems}\r\n                onItemUnstaged={HandleUnstageItem}\r\n                onItemClick={HandleShowDetails}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","import '../css/ContainerManager.css';\r\n\r\nimport React, { useState, ChangeEvent, FormEvent } from 'react';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemContainerCreator } from './ItemContainerCreator';\r\nimport { ShopKeepers } from '../../Shops/Types/ShopKeepers';\r\nimport { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\nimport { ItemShopData } from '../../Shops/Types/ItemShopData';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\n\r\nexport interface IShopCreatorProps {\r\n}\r\n\r\nexport function ShopCreator(props: IShopCreatorProps) {\r\n    const [stagedItems, setStagedItems] = useState<IItem[]>([]);\r\n    const [shopTitle, setShopTitle] = useState(\"\");\r\n    const [shopkeeper, setShopkeeper] = useState(ShopKeepers.Indigo);\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    const [canCreateShop, setCanCreateShop] = useState(false);\r\n    const [creatingShop, setCreatingShop] = useState(false);\r\n    const [shopLink, setShopLink] = useState(\"\");\r\n\r\n    function HandleStagedItemsChanged(items: IItem[]): void {\r\n        setStagedItems(items);\r\n    }\r\n\r\n    function HandleShopNameChange(event: ChangeEvent<HTMLInputElement>): void {\r\n        let input = event?.target.value;\r\n\r\n        // if (input) will not trigger if input is an empty string.\r\n        if (input !== undefined && input !== null) {\r\n            if (!/^[\\w \\-!~.,]*$/.test(input)) {\r\n                setErrorMessage(\"Shop names may only use alphanumerics, spaces, and the following: [-!~.,]\");\r\n                setCanCreateShop(false);\r\n            }\r\n            else {\r\n                setErrorMessage(\"\");\r\n                setCanCreateShop(true);\r\n            }\r\n\r\n            setShopTitle(input);\r\n        }\r\n    }\r\n\r\n    function HandleShopkeeperChange(event: ChangeEvent<HTMLSelectElement>): void {\r\n        let input = event?.target.value;\r\n\r\n        // if (input) will not trigger if input is an empty string.\r\n        if (input !== undefined && input !== null) {\r\n            if (input as ShopKeepers) {\r\n                setShopkeeper(input as ShopKeepers);\r\n            }\r\n        }\r\n    }\r\n\r\n    function HandleSubmitShop(event: FormEvent<HTMLFormElement>) {\r\n        event.preventDefault();\r\n        setCreatingShop(true);\r\n\r\n        let shopData: ItemShopData = {\r\n            ID: \"undefined\",\r\n            Name: shopTitle,\r\n            ShopKeeper: shopkeeper,\r\n            Items: stagedItems\r\n        };\r\n\r\n        GameRoomService.CreateShop(shopData)\r\n            .then(shopResponse => {\r\n                if (shopResponse && shopResponse.ID) {\r\n                    let hostName: string = window.location.host;\r\n                    let shopUrl: string = `http://${hostName}/#/shop/${shopResponse.ID}`;\r\n                    setShopLink(shopUrl);\r\n                }\r\n                setCreatingShop(false);\r\n            })\r\n            .catch(reason => {\r\n                console.error(reason);\r\n                setErrorMessage(\"There was a problem making that shop. Check for error messages and try again.\");\r\n                setCreatingShop(false);\r\n            });\r\n    }\r\n\r\n    return (\r\n        <div className=\"container-manager\">\r\n            <form\r\n                className=\"container-manager-form\"\r\n                onSubmit={HandleSubmitShop}\r\n            >\r\n                <h1>Shop</h1>\r\n                <span className=\"container-manager-error-message\">{errorMessage}</span>\r\n                <h5 className=\"shop-form-title\">Shop Name</h5>\r\n                <input\r\n                    className=\"container-manager-field\"\r\n                    type=\"text\"\r\n                    name=\"Shop Name\"\r\n                    onInput={HandleShopNameChange}\r\n                />\r\n                <br /><br />\r\n                <h5 className=\"shop-form-title\">Shopkeeper</h5>\r\n                <select\r\n                    className=\"container-manager-field\"\r\n                    id=\"shopkeepers\"\r\n                    name=\"shopkeepers\"\r\n                    value={ShopKeepers.Indigo}\r\n                    onChange={HandleShopkeeperChange}\r\n                >\r\n                    {GetShopkeeperOptions()}\r\n                </select>\r\n                <br /><br />\r\n                <LoadingPlaceholder\r\n                    showSpinner={creatingShop}\r\n                    role=\"Creating Shop Status\">\r\n                    <input\r\n                        className=\"container-manager-field\"\r\n                        type=\"submit\"\r\n                        value=\"Create Shop\"\r\n                        disabled={!canCreateShop}\r\n                    />\r\n                </LoadingPlaceholder>\r\n                <div\r\n                    className=\"container-manager-link\"\r\n                    style={{ visibility: shopLink === \"\" ? \"hidden\" : \"visible\" }}>\r\n                    <span>Successfully created a shop! </span>\r\n                    <a href={shopLink}>Here's the link.</a>\r\n                </div>\r\n            </form>\r\n            <ItemContainerCreator\r\n                handleStagedItemsUpdated={HandleStagedItemsChanged}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetShopkeeperOptions(): JSX.Element[] {\r\n    let shopKeepers: ShopKeepers[] = Object.values(ShopKeepers);\r\n    let options: JSX.Element[] = shopKeepers.map(o => {\r\n        return (\r\n            <option key={o} value={o}>{o}</option>\r\n        );\r\n    });\r\n\r\n    return options;\r\n}\r\n","import '../css/ContainerManager.css';\r\n\r\nimport React, { useState, ChangeEvent, FormEvent } from 'react';\r\nimport { IItem } from '../../ItemData/Interfaces/IItem';\r\nimport { ItemContainerCreator } from './ItemContainerCreator';\r\nimport { ChestTypes } from '../../Chests/Enums/ChestTypes';\r\nimport { GameRoomService } from '../../FirebaseAuth/Classes/GameRoomService';\r\nimport { ChestData } from '../../Chests/Types/ChestData';\r\nimport { LoadingPlaceholder } from '../../Utilities/React/LoadingPlaceholder';\r\n\r\nexport interface IChestCreatorProps {\r\n}\r\n\r\nexport function ChestCreator(props: IChestCreatorProps) {\r\n    const [stagedItems, setStagedItems] = useState<IItem[]>([]);\r\n    const [ChestTitle, setChestTitle] = useState(\"\");\r\n    const [ChestType, setChestType] = useState(ChestTypes.Wooden);\r\n    const [copperInChest, setCopperInChest] = useState(0);\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    const [canCreateChest, setCanCreateChest] = useState(false);\r\n    const [creatingChest, setCreatingChest] = useState(false);\r\n    const [ChestLink, setChestLink] = useState(\"\");\r\n\r\n    function HandleStagedItemsChanged(items: IItem[]): void {\r\n        setStagedItems(items);\r\n    }\r\n\r\n    function HandleChestNameChange(event: ChangeEvent<HTMLInputElement>): void {\r\n        let input = event?.target.value;\r\n\r\n        // if (input) will not trigger if input is an empty string.\r\n        if (input !== undefined && input !== null) {\r\n            if (!/^[\\w \\-!~.,]*$/.test(input)) {\r\n                setErrorMessage(\"Chest names may only use alphanumerics, spaces, and the following: [-!~.,]\");\r\n                setCanCreateChest(false);\r\n            }\r\n            else {\r\n                setErrorMessage(\"\");\r\n                setCanCreateChest(true);\r\n            }\r\n\r\n            setChestTitle(input);\r\n        }\r\n    }\r\n\r\n    function HandleChestTypeChange(event: ChangeEvent<HTMLSelectElement>): void {\r\n        let input = event?.target.value;\r\n\r\n        // if (input) will not trigger if input is an empty string.\r\n        if (input !== undefined && input !== null) {\r\n            if (input as ChestTypes) {\r\n                setChestType(input as ChestTypes);\r\n            }\r\n        }\r\n    }\r\n\r\n    function HandleCopperInput(event: ChangeEvent<HTMLInputElement>) {\r\n        let input = event.target?.value;\r\n\r\n        // https://stackoverflow.com/questions/23437476/in-typescript-how-to-check-if-a-string-is-numeric\r\n        if(input) {\r\n            let inputAsNumber: number = Number(input);\r\n            if (!isNaN(inputAsNumber)) {\r\n                setCopperInChest(inputAsNumber);\r\n            }\r\n        }\r\n    }\r\n\r\n    function HandleSubmitChest(event: FormEvent<HTMLFormElement>) {\r\n        event.preventDefault();\r\n        setCreatingChest(true);\r\n\r\n        let ChestData: ChestData = {\r\n            ID: \"undefined\",\r\n            Name: ChestTitle,\r\n            CopperInChest: copperInChest,\r\n            ChestType: ChestType,\r\n            Items: stagedItems\r\n        };\r\n\r\n        GameRoomService.CreateChest(ChestData)\r\n            .then(ChestResponse => {\r\n                if (ChestResponse && ChestResponse.ID) {\r\n                    let hostName: string = window.location.host;\r\n                    let ChestUrl: string = `http://${hostName}/#/chest/${ChestResponse.ID}`;\r\n                    setChestLink(ChestUrl);\r\n                }\r\n                setCreatingChest(false);\r\n            })\r\n            .catch(reason => {\r\n                console.error(reason);\r\n                setErrorMessage(\"There was a problem making that Chest. Check for error messages and try again.\");\r\n                setCreatingChest(false);\r\n            });\r\n    }\r\n\r\n    return (\r\n        <div className=\"container-manager\">\r\n            <form\r\n                className=\"container-manager-form\"\r\n                onSubmit={HandleSubmitChest}\r\n            >\r\n                <h1>Chest</h1>\r\n                <span className=\"container-manager-error-message\">{errorMessage}</span>\r\n                <h5 className=\"Chest-form-title\">Chest Name</h5>\r\n                <input\r\n                    className=\"container-manager-field\"\r\n                    type=\"text\"\r\n                    name=\"Chest Name\"\r\n                    onInput={HandleChestNameChange}\r\n                />\r\n                <br /><br />\r\n                <h5 className=\"Chest-form-title\">ChestType</h5>\r\n                <select\r\n                    className=\"container-manager-field\"\r\n                    id=\"ChestTypes\"\r\n                    name=\"ChestTypes\"\r\n                    value={ChestTypes.Wooden}\r\n                    onChange={HandleChestTypeChange}\r\n                >\r\n                    {GetChestTypeOptions()}\r\n                </select>\r\n                <br /><br />\r\n                <h5 className=\"Chest-form-title\">Copper</h5>\r\n                <input\r\n                    type=\"number\"\r\n                    id=\"containerCreatorMoney\"\r\n                    name=\"containerCreatorMoney\"\r\n                    className=\"container-manager-money\"\r\n                    onChange={HandleCopperInput}\r\n                />\r\n                <br /><br />\r\n                <LoadingPlaceholder\r\n                    showSpinner={creatingChest}\r\n                    role=\"Creating Chest Status\">\r\n                    <input\r\n                        className=\"container-manager-field\"\r\n                        type=\"submit\"\r\n                        value=\"Create Chest\"\r\n                        disabled={!canCreateChest}\r\n                    />\r\n                </LoadingPlaceholder>\r\n                <div\r\n                    className=\"container-manager-link\"\r\n                    style={{ visibility: ChestLink === \"\" ? \"hidden\" : \"visible\" }}>\r\n                    <span>Successfully created a Chest! </span>\r\n                    <a href={ChestLink}>Here's the link.</a>\r\n                </div>\r\n            </form>\r\n            <ItemContainerCreator\r\n                handleStagedItemsUpdated={HandleStagedItemsChanged}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction GetChestTypeOptions(): JSX.Element[] {\r\n    let ChestType: ChestTypes[] = Object.values(ChestTypes);\r\n    let options: JSX.Element[] = ChestType.map(o => {\r\n        return (\r\n            <option key={o} value={o}>{o}</option>\r\n        );\r\n    });\r\n\r\n    return options;\r\n}\r\n","import '../LandingSpace.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\nimport React from 'react';\r\nimport {\r\n    HashRouter as Router,\r\n    Switch,\r\n    Route\r\n} from \"react-router-dom\";\r\nimport { LoginPage } from '../../LoginPage/React/LoginPage';\r\nimport { ProtectedRoute } from './ProtectedRoute';\r\nimport { CharacterImage } from '../../CharacterImage/React/CharacterImage';\r\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\r\nimport { Inventory } from '../../Inventory/React/Inventory';\r\nimport { CharacterManager } from '../../CharacterManager/React/CharacterManager';\r\nimport { CharacterInfoDisplay } from '../../CharacterInfo/React/CharacterInfoDisplay';\r\nimport { LoginState } from '../../LoginPage/Enums/LoginState';\r\nimport { Shop } from '../../Shops/React/ShopPage';\r\nimport { ChestPage } from '../../Chests/React/ChestPage';\r\nimport { ShopCreator } from '../../ItemContainerManagement/React/ShopCreator';\r\nimport { ChestCreator } from '../../ItemContainerManagement/React/ChestCreator';\r\n\r\nexport interface ILandingSpaceProps {\r\n}\r\n\r\nexport interface ILandingSpaceState {\r\n    loginState: LoginState;\r\n}\r\n\r\n// Use the hash router instead of a browser router so that refreshes and direct-links to pages work.\r\n//https://stackoverflow.com/questions/27928372/react-router-urls-dont-work-when-refreshing-or-writing-manually\r\nexport class LandingSpace extends React.Component<ILandingSpaceProps, ILandingSpaceState> {\r\n    public constructor(props: ILandingSpaceProps) {\r\n        super(props);\r\n        this.state = {\r\n            loginState: LoginState.Login\r\n        };\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"landing-space\">\r\n                <div className=\"page-nav\">\r\n                    <Navbar expand=\"lg\" variant=\"dark\">\r\n                        <Navbar.Brand style={{ color: \"white\" }} href=\"/\">LantsPants.com</Navbar.Brand>\r\n                        <Navbar.Toggle aria-controls=\"basic-pagebar-nav\" />\r\n                        <Navbar.Collapse>\r\n                            <Nav defaultActiveKey=\"/\">\r\n                                <Nav.Link\r\n                                    href=\"/#/character_creator\"\r\n                                    eventKey=\"character_creator\"\r\n                                    >\r\n                                    Character Creator\r\n                                </Nav.Link>\r\n                                <NavDropdown\r\n                                    title=\"Player Tools\"\r\n                                    id=\"Player Tools Dropdown\"\r\n                                    >\r\n                                    <NavDropdown.Item\r\n                                        href=\"/#/inventory\"\r\n                                        eventKey=\"inventory\">\r\n                                        Inventory\r\n                                    </NavDropdown.Item>\r\n                                    <NavDropdown.Item\r\n                                        href=\"/#/characterManager\"\r\n                                        eventKey=\"characterManager\">\r\n                                        Characters\r\n                                    </NavDropdown.Item>\r\n                                </NavDropdown>\r\n                                <NavDropdown\r\n                                    title=\"DM Tools\"\r\n                                    id=\"DM Tools Dropdown\"\r\n                                    >\r\n                                    <NavDropdown.Item\r\n                                        href=\"/#/shopCreator\"\r\n                                        eventKey=\"shopCreator\">\r\n                                        Shop Creator\r\n                                    </NavDropdown.Item>\r\n                                    <NavDropdown.Item\r\n                                        href=\"/#/chestCreator\"\r\n                                        eventKey=\"chestCreator\">\r\n                                        Chest Creator\r\n                                    </NavDropdown.Item>\r\n                                </NavDropdown>\r\n                            </Nav>\r\n                            <CharacterInfoDisplay\r\n                                loginState={this.state.loginState}\r\n                            />\r\n                        </Navbar.Collapse>\r\n                    </Navbar>\r\n                </div>\r\n                <div className=\"page-content\">\r\n                    <Router>\r\n                        <Switch>\r\n                            <Route exact path=\"/\" children={<LoginPage onLogin={this.HandleLoginStateChange.bind(this)}/>} />\r\n                            <Route exact path=\"/login\" children={<LoginPage onLogin={this.HandleLoginStateChange.bind(this)}/>} />\r\n                            <Route exact path=\"/character_creator\" children={<CharacterImage />} />\r\n                            <Route path=\"/shop\" children={<Shop loginState={this.state.loginState} />} />\r\n                            <Route path=\"/chest\" children={<ChestPage loginState={this.state.loginState} />} />\r\n                            <ProtectedRoute path=\"/inventory\" children={<Inventory loginState={this.state.loginState}/>} />\r\n                            <ProtectedRoute path=\"/characterManager\" children={<CharacterManager />} />\r\n                            <ProtectedRoute path=\"/shopCreator\" children={<ShopCreator />} />\r\n                            <ProtectedRoute path=\"/chestCreator\" children={<ChestCreator />} />\r\n                        </Switch>\r\n                    </Router>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    private HandleLoginStateChange(loginState: LoginState) {\r\n        this.setState({\r\n            loginState: loginState\r\n        });\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { LandingSpace } from './Routing/React/LandingSpace';\r\n\r\nReactDOM.render(<LandingSpace />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}